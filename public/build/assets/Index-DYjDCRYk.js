import{r as d,j as e,S as P}from"./app-BIIu6Vfg.js";import{M as D}from"./MainLayout-DFIOg-IX.js";import{J as p,a as N,F,x as U,h as $,i as T,z as A,m as L}from"./index-CFCF1YSN.js";import"./x-D5uUfODk.js";import"./createLucideIcon-BEFA6UwU.js";import"./triangle-alert-BcT2QLL-.js";import"./check-DHyijvq1.js";function B({roles:c,permissions:o}){const[u,f]=d.useState("roles"),[n,g]=d.useState(null),[v,x]=d.useState(!1),[w,m]=d.useState(!1),[a,b]=d.useState(null),[t,r]=d.useState({name:"",slug:"",description:"",permissions:[]}),C=()=>{console.log("Creating role:",t),x(!1),r({name:"",slug:"",description:"",permissions:[]})},k=s=>{b(s),r({name:s.name,slug:s.slug,description:s.description,permissions:s.permissions.map(l=>l.id)}),m(!0)},R=()=>{console.log("Updating role:",a==null?void 0:a.id,t),m(!1),b(null),r({name:"",slug:"",description:"",permissions:[]})},S=s=>{confirm(`Are you sure you want to delete the role "${s.name}"?`)&&console.log("Deleting role:",s.id)},j=s=>{r(l=>({...l,permissions:l.permissions.includes(s)?l.permissions.filter(i=>i!==s):[...l.permissions,s]}))},y=s=>{const l=s.permissions.filter(i=>i.slug.includes("admin")||i.slug.includes("delete")||i.slug.includes("manage")).length;return l>5?"high":l>2?"medium":"low"},E=s=>{switch(s){case"high":return"text-red-600 bg-red-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},h=({isOpen:s,onClose:l,title:i,children:M})=>s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:i}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",children:e.jsx(L,{className:"h-6 w-6"})})]}),M]})}):null;return e.jsxs(D,{children:[e.jsx(P,{title:"Role Management"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx(p,{className:"mr-3 text-blue-600"}),"Role & Permission Management"]}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Configure roles and permissions to control user access across the platform"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-lg bg-blue-500",children:e.jsx(N,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Roles"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:c.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-lg bg-green-500",children:e.jsx(p,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Permissions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:o.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-lg bg-purple-500",children:e.jsx(F,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:c.reduce((s,l)=>s+(l.users_count||0),0)})]})]})})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"roles",label:"Roles",icon:N},{id:"permissions",label:"Permissions",icon:p}].map(s=>e.jsxs("button",{onClick:()=>f(s.id),className:`flex items-center py-2 px-1 border-b-2 font-medium text-sm ${u===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(s.icon,{className:"mr-2 h-4 w-4"}),s.label]},s.id))})}),u==="roles"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"System Roles"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage roles and their associated permissions"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Create Role"]})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:c.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${E(y(s))}`,children:y(s).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.permissions.length," permissions â€¢ ",s.users_count||0," users"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>g(s),className:"p-2 text-gray-400 hover:text-gray-600",title:"View Details",children:e.jsx($,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>k(s),className:"p-2 text-gray-400 hover:text-gray-600",title:"Edit Role",children:e.jsx(T,{className:"h-4 w-4"})}),s.slug!=="super-admin"&&e.jsx("button",{onClick:()=>S(s),className:"p-2 text-gray-400 hover:text-red-600",title:"Delete Role",children:e.jsx(A,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.permissions.slice(0,5).map(l=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:l.name},l.id)),s.permissions.length>5&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",s.permissions.length-5," more"]})]})})]},s.id))})})]}),u==="permissions"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"System Permissions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View all available permissions in the system"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-gray-500 font-mono bg-gray-100 px-2 py-1 rounded",children:s.slug}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Used by ",c.filter(l=>l.permissions.some(i=>i.id===s.id)).length," role(s)"]})]})]},s.id))})})]}),e.jsx(h,{isOpen:v,onClose:()=>x(!1),title:"Create New Role",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Name"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>r(l=>({...l,name:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter role name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Slug"}),e.jsx("input",{type:"text",value:t.slug,onChange:s=>r(l=>({...l,slug:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"role-slug"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:s=>r(l=>({...l,description:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Describe the role's purpose"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permissions"}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg p-3",children:e.jsx("div",{className:"space-y-2",children:o.map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.permissions.includes(s.id),onChange:()=>j(s.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.description})]})]},s.id))})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:C,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Role"})]})]})}),e.jsx(h,{isOpen:w,onClose:()=>m(!1),title:`Edit Role: ${a==null?void 0:a.name}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Name"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>r(l=>({...l,name:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Slug"}),e.jsx("input",{type:"text",value:t.slug,onChange:s=>r(l=>({...l,slug:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:(a==null?void 0:a.slug)==="super-admin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:s=>r(l=>({...l,description:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permissions"}),e.jsx("div",{className:"max-h-60 overflow-y-auto border border-gray-200 rounded-lg p-3",children:e.jsx("div",{className:"space-y-2",children:o.map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.permissions.includes(s.id),onChange:()=>j(s.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:(a==null?void 0:a.slug)==="super-admin"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.description})]})]},s.id))})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:R,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update Role"})]})]})}),n&&e.jsx(h,{isOpen:!!n,onClose:()=>g(null),title:`Role Details: ${n.name}`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-600",children:n.description})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["Permissions (",n.permissions.length,")"]}),e.jsx("div",{className:"mt-2 space-y-2",children:n.permissions.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.description})]}),e.jsx("span",{className:"text-xs text-gray-500 font-mono bg-white px-2 py-1 rounded",children:s.slug})]},s.id))})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Close"})})]})})]})})]})}export{B as default};
