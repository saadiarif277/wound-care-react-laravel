import{r as i,j as e,S as R}from"./app-b7vnQlZc.js";import{M as k}from"./MainLayout-CSlV7Py7.js";import{F as g,a as p,b as u,c as F,d as j,e as U,f as D,g as $,h as M,i as T,j as E}from"./index-DpA9ZXCS.js";import"./x-CdJq2FK8.js";import"./createLucideIcon-BGsZVnCF.js";import"./triangle-alert-CLRk3LfA.js";import"./check-KIJGV9m7.js";function J({users:N,userRoles:b,accessRequests:y,accessStats:l,roleDistribution:v,recentActivity:x,securityAlerts:m}){const[t,f]=i.useState("overview"),[c,w]=i.useState(""),[d,S]=i.useState("all"),[I,C]=i.useState(null),_=N.filter(s=>{const a=s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase()),n=d==="all"||s.role.name===d;return a&&n}),o=s=>{switch(s){case"active":return"text-green-600 bg-green-50";case"inactive":return"text-red-600 bg-red-50";case"pending":return"text-yellow-600 bg-yellow-50";default:return"text-gray-600 bg-gray-50"}},A=s=>{switch(s){case"high":return"text-red-600 bg-red-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},r=({title:s,value:a,icon:n,color:L,subtitle:h})=>e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-lg ${L}`,children:e.jsx(n,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:a}),h&&e.jsx("p",{className:"text-xs text-gray-500",children:h})]})]})});return e.jsxs(k,{children:[e.jsx(R,{title:"Access Control"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx(g,{className:"mr-3 text-blue-600"}),"System Access Control"]}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Monitor and manage user access, roles, and security across the platform"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(r,{title:"Total Users",value:l.total_users,icon:p,color:"bg-blue-500",subtitle:`${l.active_users} active`}),e.jsx(r,{title:"Pending Requests",value:l.pending_requests,icon:u,color:"bg-yellow-500",subtitle:"Awaiting approval"}),e.jsx(r,{title:"Recent Approvals",value:l.recent_approvals,icon:F,color:"bg-green-500",subtitle:"Last 7 days"}),e.jsx(r,{title:"Security Alerts",value:m.filter(s=>s.status==="active").length,icon:j,color:"bg-red-500",subtitle:"Active alerts"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:U},{id:"users",label:"User Management",icon:p},{id:"requests",label:"Access Requests",icon:u},{id:"security",label:"Security Monitor",icon:g}].map(s=>e.jsxs("button",{onClick:()=>f(s.id),className:`flex items-center py-2 px-1 border-b-2 font-medium text-sm ${t===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(s.icon,{className:"mr-2 h-4 w-4"}),s.label]},s.id))})}),t==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Role Distribution"}),e.jsx("div",{className:"space-y-4",children:v.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-500 mr-3"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.role})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[s.active_count,"/",s.count]}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s.percentage,"%"]})]})]},a))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(D,{className:"mr-2"}),"Recent Activity"]}),e.jsx("div",{className:"space-y-3",children:x.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-3 ${s.risk_level==="high"?"bg-red-500":s.risk_level==="medium"?"bg-yellow-500":"bg-green-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-900",children:s.description}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.user," • ",s.ip_address]})]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.timestamp).toLocaleTimeString()})]},s.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 lg:col-span-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(j,{className:"mr-2"}),"Security Alerts"]}),e.jsx("div",{className:"space-y-3",children:m.map(s=>e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${s.severity==="high"?"border-red-500 bg-red-50":s.severity==="medium"?"border-yellow-500 bg-yellow-50":"border-blue-500 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="active"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:s.status}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.timestamp).toLocaleString()})]})]})},s.id))})]})]}),t==="users"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage user roles and access permissions"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:c,onChange:s=>w(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("select",{value:d,onChange:s=>S(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Roles"}),b.map(s=>e.jsx("option",{value:s.name,children:s.display_name},s.id))]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium text-sm",children:s.name.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:s.role.display_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${o(s.is_active?"active":"inactive")}`,children:s.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.last_login?new Date(s.last_login).toLocaleDateString():"Never"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>C(s),className:"text-blue-600 hover:text-blue-900",children:e.jsx(M,{className:"h-4 w-4"})}),e.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:e.jsx(T,{className:"h-4 w-4"})}),e.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:e.jsx(E,{className:"h-4 w-4"})})]})})]},s.id))})]})})]}),t==="requests"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Access Requests"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Review and approve user access requests"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:y.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:[s.first_name," ",s.last_name]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Requesting: ",e.jsx("span",{className:"font-medium",children:s.requested_role})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${o(s.status)}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleDateString()}),s.status==="pending"&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:"Approve"}),e.jsx("button",{className:"px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700",children:"Deny"})]})]})]})},s.id))})})]}),t==="security"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Login Success Rate"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:"98.5%"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Last 30 days"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Failed Attempts"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:"12"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Last 24 hours"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Role Changes"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:"3"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Last 7 days"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Security Event Log"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Detailed security events and access patterns"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-3",children:x.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium mr-3 ${A(s.risk_level)}`,children:s.risk_level.toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.description}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.user," • ",s.ip_address," • ",s.type]})]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(s.timestamp).toLocaleString()})]},s.id))})})]})]})]})})]})}export{J as default};
