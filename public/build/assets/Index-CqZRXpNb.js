import{r as a,j as e,S as g,x as c}from"./app-taSqzBVs.js";import{M as y}from"./MainLayout-Dw1zk4VW.js";import{K as z,A as N,B as H,a as v,b as J,g as Q,f as W,L as X,w as Y,h as o,c as f,x as w,M as b,d as Z}from"./index-BQkVVL-M.js";import{a as x}from"./api-D-Fi0ivM.js";import"./x-tQL0mm7-.js";import"./createLucideIcon-CJpMkWaB.js";import"./triangle-alert-BOyfSih_.js";import"./check-B1Sfkp9P.js";function ce(){const[r,_]=a.useState("overview"),[S,p]=a.useState(!0),[j,u]=a.useState(null),[n,R]=a.useState(""),[k,C]=a.useState([]),[A,F]=a.useState([]),[P,M]=a.useState([]),[T,E]=a.useState([]),[i,$]=a.useState({total_commissions:0,pending_commissions:0,paid_commissions:0,active_reps:0,pending_approvals:0,monthly_growth:0,avg_commission_per_order:0,top_performers:[]}),D=async()=>{p(!0),u(null);try{switch(r){case"overview":await L();break;case"commissions":const s=await x.commission.getRecords({search:n});C(s.data);break;case"payouts":const t=await x.commission.getPayouts({search:n});F(t.data);break;case"reps":const K=await x.salesReps.getAll({search:n});M(K.data);break;case"approvals":const V=await x.salesReps.getSubRepApprovals({search:n});E(V.data);break}}catch(s){u(s instanceof Error?s.message:"Failed to fetch data"),console.error("Error fetching sales data:",s)}finally{p(!1)}},L=async()=>{try{const s=await x.salesReps.getAnalytics();$(s)}catch(s){console.error("Error fetching analytics:",s)}};a.useEffect(()=>{D()},[r,n]);const O=[{id:"overview",label:"Overview",icon:z,count:null},{id:"commissions",label:"Commission Tracking",icon:N,count:i.pending_commissions},{id:"payouts",label:"Payout Management",icon:H,count:null},{id:"reps",label:"Sales Rep Management",icon:v,count:i.active_reps},{id:"approvals",label:"Sub-Rep Approvals",icon:J,count:i.pending_approvals}],m=s=>{const t="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(s.toLowerCase()){case"approved":case"completed":case"paid":case"active":return`${t} bg-green-100 text-green-800`;case"pending":case"processing":return`${t} bg-yellow-100 text-yellow-800`;case"rejected":case"failed":case"disputed":case"inactive":return`${t} bg-red-100 text-red-800`;default:return`${t} bg-gray-100 text-gray-800`}},l=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),d=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),h=s=>`${(s*100).toFixed(1)}%`,U=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Sales & Commission Overview"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(N,{className:"h-8 w-8 text-green-600"})}),e.jsx("div",{className:"ml-5",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Total Commissions"}),e.jsx("dd",{className:"text-2xl font-semibold text-gray-900",children:l(i.total_commissions)})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(W,{className:"h-8 w-8 text-yellow-600"})}),e.jsx("div",{className:"ml-5",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Pending Commissions"}),e.jsx("dd",{className:"text-2xl font-semibold text-gray-900",children:l(i.pending_commissions)})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(v,{className:"h-8 w-8 text-blue-600"})}),e.jsx("div",{className:"ml-5",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Active Sales Reps"}),e.jsx("dd",{className:"text-2xl font-semibold text-gray-900",children:i.active_reps})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(X,{className:"h-8 w-8 text-purple-600"})}),e.jsx("div",{className:"ml-5",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Monthly Growth"}),e.jsxs("dd",{className:"text-2xl font-semibold text-gray-900",children:[i.monthly_growth>=0?"+":"",i.monthly_growth.toFixed(1),"%"]})]})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Top Performers This Month"})}),e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sales Rep"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Commissions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Orders"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.top_performers.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.rep_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:l(s.total_commissions)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.order_count})]},t))})]})})]})]}),q=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Commission Records"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"disputed",children:"Disputed"})]}),e.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"Export"]})]})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order / Rep"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rate"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.order_number}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.rep_name," (",s.rep_type,")"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:l(s.commission_amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:h(s.commission_rate)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:l(s.order_total)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:m(s.status),children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d(s.order_date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(c,{href:`/admin/commissions/${s.id}`,className:"text-blue-600 hover:text-blue-900",children:e.jsx(o,{className:"w-4 h-4"})}),s.status==="pending"&&e.jsx("button",{className:"text-green-600 hover:text-green-900",children:e.jsx(f,{className:"w-4 h-4"})})]})})]},s.id))})]})})})]}),B=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Payout Management"}),e.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),"Process Payouts"]})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:A.map(s=>e.jsx("li",{className:"px-6 py-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:s.rep_name}),e.jsx("span",{className:m(s.status),children:s.status})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Period: ",d(s.period_start)," - ",d(s.period_end)]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[e.jsx("span",{children:l(s.total_amount)}),e.jsxs("span",{children:[s.commission_count," commissions"]}),e.jsx("span",{children:s.payment_method}),s.reference_number&&e.jsxs("span",{children:["Ref: ",s.reference_number]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(c,{href:`/admin/payouts/${s.id}`,className:"text-blue-600 hover:text-blue-900",children:e.jsx(o,{className:"w-4 h-4"})}),e.jsx("button",{className:"text-yellow-600 hover:text-yellow-900",children:e.jsx(b,{className:"w-4 h-4"})})]})]})},s.id))})})]}),I=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Sales Representatives"}),e.jsxs(c,{href:"/admin/sales-reps/create",className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),"Add Sales Rep"]})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:P.map(s=>e.jsx("li",{className:"px-6 py-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("span",{className:m(s.status),children:s.status})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[s.email," • ",s.territory]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Rate: ",h(s.commission_rate)]}),e.jsxs("span",{children:["Sales: ",l(s.total_sales)]}),e.jsxs("span",{children:["Commissions: ",l(s.total_commissions)]}),s.last_order_date&&e.jsxs("span",{children:["Last order: ",d(s.last_order_date)]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(c,{href:`/admin/sales-reps/${s.id}`,className:"text-blue-600 hover:text-blue-900",children:e.jsx(o,{className:"w-4 h-4"})}),e.jsx(c,{href:`/admin/sales-reps/${s.id}/edit`,className:"text-yellow-600 hover:text-yellow-900",children:e.jsx(b,{className:"w-4 h-4"})})]})]})},s.id))})})]}),G=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Sub-Rep Approval Requests"}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:T.map(s=>e.jsx("li",{className:"px-6 py-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:s.sub_rep_name}),e.jsx("span",{className:m(s.status),children:s.status})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Primary Rep: ",s.primary_rep_name," • Customer: ",s.customer_name]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Requested Rate: ",h(s.requested_commission_rate)]}),e.jsxs("span",{children:["Territory: ",s.territory]}),e.jsxs("span",{children:["Submitted: ",d(s.submitted_date)]}),s.reviewer_name&&e.jsxs("span",{children:["Reviewed by: ",s.reviewer_name]})]}),s.notes&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Notes: ",s.notes]})]}),e.jsxs("div",{className:"flex space-x-2",children:[s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"text-green-600 hover:text-green-900 p-1",children:e.jsx(f,{className:"w-4 h-4",title:"Approve"})}),e.jsx("button",{className:"text-red-600 hover:text-red-900 p-1",children:e.jsx(Z,{className:"w-4 h-4",title:"Reject"})})]}),e.jsx(c,{href:`/admin/sub-rep-approvals/${s.id}`,className:"text-blue-600 hover:text-blue-900 p-1",children:e.jsx(o,{className:"w-4 h-4",title:"View Details"})})]})]})},s.id))})})]});return S?e.jsxs(y,{children:[e.jsx(g,{title:"Sales Management"}),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading sales data..."})]})})]}):e.jsxs(y,{children:[e.jsx(g,{title:"Sales Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Sales Management"}),e.jsx("p",{className:"text-gray-500",children:"Manage commissions, payouts, sales reps, and approvals"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:n,onChange:s=>R(s.target.value),placeholder:"Search...",className:"w-64 pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:O.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>_(s.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${r===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(t,{className:"w-4 h-4"}),s.label,s.count!==null&&s.count>0&&e.jsx("span",{className:"bg-red-100 text-red-600 py-0.5 px-2.5 rounded-full text-xs",children:s.count})]},s.id)})})}),j&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"text-red-700",children:[e.jsx("p",{className:"font-medium",children:"Error loading data"}),e.jsx("p",{className:"text-sm",children:j})]})}),e.jsxs("div",{className:"min-h-96",children:[r==="overview"&&U(),r==="commissions"&&q(),r==="payouts"&&B(),r==="reps"&&I(),r==="approvals"&&G()]})]})]})}export{ce as default};
