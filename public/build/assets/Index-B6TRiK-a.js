import{r as l,j as e,S as k,x as o}from"./app-CkbwHOkf.js";import{M as b}from"./MainLayout-DIjIBnGe.js";import{i as D,Z as O,ac as P,F as A,b as E,a as $,B as T,f as L,a2 as M}from"./index-R2fUhcwH.js";import{a as R}from"./api-CXAezOed.js";import"./glass-theme-CCnqi7lL.js";import"./x-CCCTsVjU.js";import"./createLucideIcon-HYdXrwBu.js";import"./triangle-alert-D2zL4pqG.js";import"./check-DXIgFk-v.js";const K=()=>{const[d,j]=l.useState([]),[y,m]=l.useState(!0),[p,u]=l.useState(null),[r,h]=l.useState({search:"",status:"",date_from:"",date_to:"",sales_rep_id:""}),[a,f]=l.useState({current_page:1,last_page:1,per_page:15,total:0}),N=[{value:"",label:"All Statuses"},{value:"pending_admin_approval",label:"Pending Admin Approval"},{value:"pending_documents",label:"Pending Documents"},{value:"approved",label:"Approved"},{value:"processing",label:"Processing"},{value:"shipped",label:"Shipped"},{value:"delivered",label:"Delivered"},{value:"rejected",label:"Rejected"},{value:"cancelled",label:"Cancelled"}],n=async(t=1)=>{m(!0),u(null);try{const s={...r,page:t},c=Object.fromEntries(Object.entries(s).filter(([U,x])=>x!==""&&x!==null&&x!==void 0)),g=await R.orders.getAll(c);j(g.data),f(g.pagination)}catch(s){u(s instanceof Error?s.message:"Failed to fetch orders"),console.error("Error fetching orders:",s)}finally{m(!1)}};l.useEffect(()=>{n()},[r]);const i=(t,s)=>{h(c=>({...c,[t]:s}))},v=t=>{t.preventDefault(),n(1)},w=()=>{h({search:"",status:"",date_from:"",date_to:"",sales_rep_id:""})},_=t=>{const s="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium max-w-full truncate";switch(t){case"approved":return`${s} bg-green-100 text-green-800`;case"pending_admin_approval":case"pending_documents":return`${s} bg-yellow-100 text-yellow-800`;case"processing":return`${s} bg-blue-100 text-blue-800`;case"shipped":return`${s} bg-purple-100 text-purple-800`;case"delivered":return`${s} bg-green-100 text-green-800`;case"rejected":case"cancelled":return`${s} bg-red-100 text-red-800`;default:return`${s} bg-gray-100 text-gray-800`}},S=t=>{switch(t){case"approved":return"Approved";case"pending_admin_approval":return"Pending";case"pending_documents":return"Docs Pending";case"processing":return"Processing";case"shipped":return"Shipped";case"delivered":return"Delivered";case"rejected":return"Rejected";case"cancelled":return"Cancelled";default:return t.replace("_"," ").toUpperCase()}},F=t=>t==null?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),C=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return p?e.jsx(b,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-lg mb-4",children:"Error loading orders"}),e.jsx("div",{className:"text-gray-600 mb-4",children:p}),e.jsx("button",{onClick:()=>n(),className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Try Again"})]})})}):e.jsxs(b,{children:[e.jsx(k,{title:"Order Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Order Management"}),e.jsx("p",{className:"text-gray-500",children:"View and manage all wound care product orders"})]}),e.jsx(o,{href:"/orders/create",children:e.jsxs("button",{className:"flex items-center gap-1 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:[e.jsx(D,{className:"h-4 w-4"}),"Create New Order"]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:e.jsx("form",{onSubmit:v,className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:r.search,onChange:t=>i("search",t.target.value),placeholder:"Order number, patient, facility...",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("select",{value:r.status,onChange:t=>i("status",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:N.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:r.date_from,onChange:t=>i("date_from",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:r.date_to,onChange:t=>i("date_to",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsxs("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center",children:[e.jsx(P,{className:"mr-2"}),"Filter"]}),e.jsx("button",{type:"button",onClick:w,className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600",children:"Clear"})]})]})})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total Orders"}),e.jsx(A,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:a.total})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Completed"}),e.jsx(E,{className:"h-4 w-4 text-green-500"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600 mt-2",children:d.filter(t=>t.status==="approved").length})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Pending"}),e.jsx($,{className:"h-4 w-4 text-amber-500"})]}),e.jsx("p",{className:"text-2xl font-bold text-amber-600 mt-2",children:d.filter(t=>t.status==="pending_admin_approval"||t.status==="pending_documents").length})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total Revenue"}),e.jsx(T,{className:"h-4 w-4 text-gray-400"})]}),e.jsxs("p",{className:"text-2xl font-bold mt-2",children:["$",d.reduce((t,s)=>t+(s.total_amount||0),0).toFixed(2)]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Orders (",a.total,")"]})}),y?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading orders..."})]}):d.length===0?e.jsx("div",{className:"p-12 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No orders found matching your criteria."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Facility"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.order_number}),e.jsx("div",{className:"text-sm text-gray-500",children:t.organization_name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.patient_fhir_id||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.facility_name})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-[120px]",children:e.jsx("span",{className:_(t.status),children:S(t.status)})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C(t.order_date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.items_count}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F(t.total_amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(o,{href:`/orders/${t.id}`,className:"text-blue-600 hover:text-blue-900",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx(o,{href:`/orders/${t.id}/edit`,className:"text-green-600 hover:text-green-900",children:e.jsx(M,{className:"w-4 h-4"})})]})})]},t.id))})]})}),a.last_page>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing page ",a.current_page," of ",a.last_page]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>n(a.current_page-1),disabled:a.current_page<=1,className:"px-3 py-1 border border-gray-300 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),e.jsx("button",{onClick:()=>n(a.current_page+1),disabled:a.current_page>=a.last_page,className:"px-3 py-1 border border-gray-300 rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]})]})]})]})]})};export{K as default};
