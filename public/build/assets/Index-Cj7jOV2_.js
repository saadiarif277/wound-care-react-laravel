import{r as l,j as e,S as C,A as P}from"./app-CkbwHOkf.js";import{M as I}from"./MainLayout-DIjIBnGe.js";import{g as O,F as A,B as D,A as F}from"./index-R2fUhcwH.js";import{f as x}from"./utils-J8bI0sT-.js";import{T as N}from"./TextInput-DU2OTVVJ.js";import{S as j}from"./SelectInput-CK_pJtvf.js";import{D as T}from"./DateInput-BDaDOVBn.js";import{T as k}from"./TextAreaInput-DyW4hQCW.js";import{L as R}from"./LoadingButton-BcELUJpL.js";import{C as b}from"./card-mI4OQcp1.js";import"./glass-theme-CCnqi7lL.js";import"./x-CCCTsVjU.js";import"./createLucideIcon-HYdXrwBu.js";import"./triangle-alert-D2zL4pqG.js";import"./check-DXIgFk-v.js";import"./clsx-B-dksMZM.js";import"./loader-circle-CzGXBM_P.js";function Z({providers:o,flash:c}){var v;const[n,f]=l.useState(""),[u,p]=l.useState([]),[i,m]=l.useState(""),[_,h]=l.useState(!1),[S,y]=l.useState(!1),[a,d]=l.useState({amount:"",payment_method:"check",reference_number:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),g=o.find(t=>t.id===parseInt(n)),s=u.find(t=>t.id===parseInt(i));l.useEffect(()=>{n?(h(!0),fetch(`/api/providers/${n}/outstanding-orders`).then(t=>t.json()).then(t=>{p(t.orders),m(""),h(!1)}).catch(t=>{console.error("Error fetching orders:",t),h(!1)})):(p([]),m(""))},[n]),l.useEffect(()=>{s&&d(t=>({...t,amount:s.outstanding_balance.toFixed(2)}))},[i]);const w=t=>{if(t.preventDefault(),!n||!i||!a.amount){alert("Please select a provider, order, and enter an amount");return}y(!0),P.post("/admin/payments",{provider_id:n,order_id:i,amount:parseFloat(a.amount),payment_method:a.payment_method,reference_number:a.reference_number,payment_date:a.payment_date,notes:a.notes},{onSuccess:()=>{d({amount:"",payment_method:"check",reference_number:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),f(""),m(""),p([])},onFinish:()=>{y(!1)}})};return e.jsxs(I,{children:[e.jsx(C,{title:"Record Payment"}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Record Payment"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Record payments from providers to reduce their outstanding balances"})]}),c.success&&e.jsxs("div",{className:"mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg flex items-center",children:[e.jsx(O,{className:"w-5 h-5 mr-2"}),c.success]}),c.error&&e.jsx("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:c.error}),(!o||o.length===0)&&e.jsxs("div",{className:"mb-6 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:"No providers available"}),e.jsx("p",{className:"text-sm mt-1",children:"There are currently no providers in the system or no providers with outstanding balances."})]}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsx(b,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(A,{className:"w-5 h-5 mr-2"}),"Select Provider"]}),e.jsxs(j,{label:"Provider",value:n,onChange:t=>f(t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select a provider..."}),o&&o.length>0?o.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.email]},t.id)):e.jsx("option",{value:"",disabled:!0,children:"No providers found"})]}),g&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["NPI: ",g.npi_number||"N/A"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Organization: ",((v=g.current_organization)==null?void 0:v.name)||"N/A"]})]})]})}),n&&e.jsx(b,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(D,{className:"w-5 h-5 mr-2"}),"Select Order"]}),_?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading orders..."}):u.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No outstanding orders found for this provider"}):e.jsxs(e.Fragment,{children:[e.jsxs(j,{label:"Order",value:i,onChange:t=>m(t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select an order..."}),u.map(t=>e.jsxs("option",{value:t.id,children:["Order #",t.order_number," - ",x(t.outstanding_balance)," outstanding"]},t.id))]}),s&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Amount:"}),e.jsx("span",{className:"font-semibold",children:x(s.total_amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Paid Amount:"}),e.jsx("span",{className:"font-semibold",children:x(s.paid_amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Outstanding Balance:"}),e.jsx("span",{className:"font-semibold text-red-600",children:x(s.outstanding_balance)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.payment_status==="paid"?"bg-green-100 text-green-700":s.payment_status==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:s.payment_status.toUpperCase()})]})]})]})]})}),i&&e.jsx(b,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(F,{className:"w-5 h-5 mr-2"}),"Payment Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(N,{label:"Payment Amount",type:"number",step:"0.01",min:"0.01",max:s==null?void 0:s.outstanding_balance,value:a.amount,onChange:t=>d(r=>({...r,amount:t.target.value})),required:!0,placeholder:"0.00"}),e.jsxs(j,{label:"Payment Method",value:a.payment_method,onChange:t=>d(r=>({...r,payment_method:t.target.value})),required:!0,children:[e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"wire",children:"Wire Transfer"}),e.jsx("option",{value:"ach",children:"ACH"}),e.jsx("option",{value:"credit_card",children:"Credit Card"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx(N,{label:"Reference Number",value:a.reference_number,onChange:t=>d(r=>({...r,reference_number:t.target.value})),placeholder:"Check # or Transaction ID"}),e.jsx(T,{label:"Payment Date",value:a.payment_date,onChange:t=>d(r=>({...r,payment_date:t})),required:!0})]}),e.jsx("div",{className:"mt-4",children:e.jsx(k,{label:"Notes (Optional)",value:a.notes,onChange:t=>d(r=>({...r,notes:t})),rows:3,placeholder:"Any additional notes about this payment..."})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(R,{type:"submit",loading:S,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Record Payment"})})]})})]})]})]})}export{Z as default};
