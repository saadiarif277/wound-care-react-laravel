import{j as e,u as L,A as j,r as f,c as ee,S as se,R as te}from"./app-CkbwHOkf.js";import{C as O,M as re}from"./MainLayout-DIjIBnGe.js";import{c as r,t as $}from"./glass-theme-CCnqi7lL.js";import{p as ae}from"./parseISO-DymfX_hn.js";import{i as ie,f as le}from"./format-Clb3rDl_.js";import{C as V}from"./clock-BCNbb55_.js";import{C as B}from"./circle-alert-D5RtSiPV.js";import{S as I}from"./send-Cwgt1rCK.js";import{P as T}from"./package-C3D73aJ6.js";import{C as D}from"./circle-check-big-BZwOB0cM.js";import{C as H}from"./calendar-CU3MSIjO.js";import{E as R}from"./eye-2c1yoxJs.js";import{P as ne}from"./phone-Cep3yv4K.js";import{F as U}from"./file-text-3MfHY30h.js";import{S as ce}from"./shield-DtxW4kzs.js";import{T as oe}from"./trending-up-Cr1DgAyN.js";import{I as de}from"./info-BO4HO_Ur.js";import{T as z}from"./triangle-alert-D2zL4pqG.js";import{T as q}from"./timer-B00LwCj_.js";import{D as X}from"./dollar-sign-BlJ6QvEN.js";import{C as xe}from"./chevron-up-CAFyUi5R.js";import{C as me}from"./chevron-down-BQSbFUOw.js";import{L as pe,D as ge,C as he,a as ue,b as be,P as fe,c as ye,B as je,A as ve,p as we,d as Ne,e as ke,i as _e}from"./index-Bd4AEgkZ.js";import{M as $e,V as Ce}from"./volume-2-BgFXkjpA.js";import{c as E}from"./createLucideIcon-HYdXrwBu.js";import{L as Se}from"./layers-BB96VZPZ.js";import{S as Ae}from"./search-B4qCXP-m.js";import{F as De}from"./filter-CvtIixAT.js";import{U as Ee}from"./user-CeKBNj6z.js";import{B as Me}from"./building-2-By7SiNBb.js";import{A as Re}from"./activity-Dw7iipAt.js";import{T as G}from"./truck-Bx0mry60.js";import{C as Ve}from"./chevron-right-BB6IVksD.js";import"./x-CCCTsVjU.js";import"./check-DXIgFk-v.js";import"./index-R2fUhcwH.js";import"./en-US-DhQ_UAps.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=E("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=E("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=E("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=E("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=E("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),Oe=(a,l="USD",n)=>{const b=typeof a=="string"?parseFloat(a):a;return isNaN(b)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:l,minimumFractionDigits:2,maximumFractionDigits:2,...n}).format(b)},Q=(a,l="MMM d, yyyy h:mm a")=>{if(!a)return"N/A";try{const n=typeof a=="string"?ae(a):a;return ie(n)?le(n,l):"Invalid date"}catch{return"Invalid date"}},Be=({episode:a,theme:l})=>{const n=$[l],g=(()=>{const i=[];return i.push({id:"created",type:"episode_created",date:a.created_at,description:"Episode created"}),a.verification_date&&i.push({id:"verified",type:"ivr_completed",date:a.verification_date,description:"IVR verification completed"}),a.last_order_date&&i.push({id:"last-order",type:"order_created",date:a.last_order_date,description:"Most recent order placed"}),a.recent_activities&&a.recent_activities.forEach((c,d)=>{i.push({id:`activity-${d}`,type:c.type,date:c.date,description:c.description})}),i.sort((c,d)=>new Date(d.date).getTime()-new Date(c.date).getTime())})(),p=i=>({episode_created:H,ivr_sent:I,ivr_completed:D,order_created:T,order_shipped:I,status_changed:B})[i]||V,s=i=>({episode_created:l==="dark"?"bg-blue-500":"bg-blue-600",ivr_sent:l==="dark"?"bg-yellow-500":"bg-yellow-600",ivr_completed:l==="dark"?"bg-green-500":"bg-green-600",order_created:l==="dark"?"bg-purple-500":"bg-purple-600",order_shipped:l==="dark"?"bg-indigo-500":"bg-indigo-600",status_changed:l==="dark"?"bg-orange-500":"bg-orange-600"})[i]||(l==="dark"?"bg-gray-500":"bg-gray-600");return g.length===0?e.jsxs("div",{className:r("text-center py-4",n.text.secondary),children:[e.jsx(V,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No timeline events yet"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:r("text-sm font-medium mb-3",n.text.primary),children:"Episode Timeline"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:r("absolute left-4 top-0 bottom-0 w-0.5",l==="dark"?"bg-white/10":"bg-gray-200")}),e.jsx("div",{className:"space-y-3",children:g.map((i,c)=>{const d=p(i.type),k=c===g.length-1;return e.jsxs("div",{className:"relative flex items-start",children:[e.jsx("div",{className:r("relative z-10 w-8 h-8 rounded-full flex items-center justify-center",s(i.type),"shadow-lg"),children:e.jsx(d,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:"ml-4 flex-1",children:e.jsxs("div",{className:r("p-3 rounded-lg",l==="dark"?"bg-white/5":"bg-gray-50"),children:[e.jsx("p",{className:r("text-sm font-medium",n.text.primary),children:i.description}),e.jsx("p",{className:r("text-xs mt-1",n.text.secondary),children:Q(i.date)})]})}),k&&e.jsx("div",{className:r("absolute left-4 top-8 bottom-0 w-0.5 bg-gradient-to-b",l==="dark"?"from-white/10 to-transparent":"from-gray-200 to-transparent")})]},i.id)})})]}),a.expiration_date&&e.jsxs("div",{className:r("mt-4 p-3 rounded-lg flex items-start space-x-2",l==="dark"?"bg-yellow-500/20":"bg-yellow-50"),children:[e.jsx(B,{className:r("w-4 h-4 mt-0.5",l==="dark"?"text-yellow-400":"text-yellow-600")}),e.jsxs("div",{children:[e.jsxs("p",{className:r("text-sm font-medium",l==="dark"?"text-yellow-400":"text-yellow-600"),children:["IVR Expires: ",Q(a.expiration_date)]}),new Date(a.expiration_date)<new Date&&e.jsx("p",{className:r("text-xs mt-1",l==="dark"?"text-yellow-300":"text-yellow-700"),children:"This episode requires re-verification"})]})]})]})},qe=({episodeId:a,status:l,onViewDetails:n,onRefresh:b})=>{let g="dark";try{g=L().theme}catch{}const p=()=>{j.post(`/api/episodes/${a}/send-ivr`,{},{onSuccess:()=>{b&&b()}})},s=()=>{j.visit(`/episodes/${a}/contact`)},i=()=>{j.post(`/api/episodes/${a}/generate-documents`,{},{onSuccess:()=>{b&&b()}})},d=(()=>{const o=[{id:"view",label:"View Details",icon:R,onClick:n,variant:"primary",show:!0}];return(l==="expired"||l==="expiring-soon")&&o.push({id:"send-ivr",label:"Send IVR",icon:I,onClick:p,variant:"warning",show:!0}),l==="action-required"&&o.push({id:"resolve",label:"Resolve",icon:D,onClick:n,variant:"danger",show:!0}),o.push({id:"contact",label:"Contact",icon:ne,onClick:s,variant:"secondary",show:!0},{id:"documents",label:"Documents",icon:U,onClick:i,variant:"secondary",show:["active","completed"].includes(l)}),o.filter(u=>u.show)})(),k=o=>{const u={primary:r("bg-gradient-to-r from-blue-500 to-blue-600 text-white","hover:from-blue-600 hover:to-blue-700","focus:ring-2 focus:ring-blue-500/50"),secondary:r(g==="dark"?"bg-white/10 text-white hover:bg-white/20":"bg-gray-100 text-gray-700 hover:bg-gray-200","focus:ring-2",g==="dark"?"focus:ring-white/30":"focus:ring-gray-300"),warning:r("bg-gradient-to-r from-yellow-500 to-orange-500 text-white","hover:from-yellow-600 hover:to-orange-600","focus:ring-2 focus:ring-yellow-500/50"),danger:r("bg-gradient-to-r from-red-500 to-red-600 text-white","hover:from-red-600 hover:to-red-700","focus:ring-2 focus:ring-red-500/50")};return u[o]||u.secondary};return e.jsx("div",{className:"flex items-center space-x-2",children:d.map(o=>{const u=o.icon;return e.jsxs("button",{onClick:o.onClick,className:r("flex items-center space-x-1.5 px-3 py-2 rounded-lg","text-sm font-medium transition-all duration-200","transform hover:scale-105 active:scale-95",k(o.variant)),title:o.label,children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:o.label})]},o.id)})})};function Ue({episodeId:a,className:l}){var w,_,N;const[n,b]=f.useState(null),[g,p]=f.useState(!0),[s,i]=f.useState(null);let c="dark",d=$.dark;try{c=L().theme,d=$[c]}catch{}f.useEffect(()=>{k()},[a]);const k=async()=>{try{p(!0);const x=await ee.get(`/api/episodes/${a}/mac-validation`);b(x.data.data)}catch(x){i("Unable to fetch MAC validation data"),console.error("MAC validation error:",x)}finally{p(!1)}},o=x=>{const m={low:c==="dark"?"text-green-400":"text-green-600",medium:c==="dark"?"text-yellow-400":"text-yellow-600",high:c==="dark"?"text-orange-400":"text-orange-600",critical:c==="dark"?"text-red-400":"text-red-600"};return m[x]||m.medium},u=x=>{const m={low:c==="dark"?"bg-green-500/20":"bg-green-100",medium:c==="dark"?"bg-yellow-500/20":"bg-yellow-100",high:c==="dark"?"bg-orange-500/20":"bg-orange-100",critical:c==="dark"?"bg-red-500/20":"bg-red-100"};return m[x]||m.medium},C=x=>{switch(x){case"covered":return D;case"conditional":return z;case"not_covered":return O;case"requires_prior_auth":return U;default:return de}};if(g)return e.jsx("div",{className:r("p-4 rounded-lg animate-pulse",c==="dark"?"bg-white/5":"bg-gray-100",l),children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"})]})});if(s||!n)return null;const S=C(n.coverage_status);return e.jsxs("div",{className:r("p-4 rounded-lg border",c==="dark"?"bg-gradient-to-br from-blue-900/20 to-purple-900/20 border-blue-500/30":"bg-gradient-to-br from-blue-50 to-purple-50 border-blue-200",l),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:r("w-4 h-4",o(n.risk_level))}),e.jsx("h4",{className:r("font-medium text-sm",d.text.primary),children:"MAC Validation"})]}),e.jsxs("div",{className:r("px-2 py-1 rounded-full text-xs font-semibold",u(n.risk_level),o(n.risk_level)),children:[n.risk_score,"% Risk"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("div",{className:r("p-2 rounded-lg",c==="dark"?"bg-white/10":"bg-white/80"),children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[e.jsx(S,{className:r("w-3 h-3",n.coverage_status==="covered"?"text-green-500":n.coverage_status==="conditional"?"text-yellow-500":"text-red-500")}),e.jsx("span",{className:r("text-xs font-medium",d.text.secondary),children:"Coverage"})]}),e.jsx("p",{className:r("text-xs font-semibold capitalize",d.text.primary),children:n.coverage_status.replace("_"," ")})]}),e.jsxs("div",{className:r("p-2 rounded-lg",c==="dark"?"bg-white/10":"bg-white/80"),children:[e.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[e.jsx(oe,{className:"w-3 h-3 text-green-500"}),e.jsx("span",{className:r("text-xs font-medium",d.text.secondary),children:"Approval"})]}),e.jsxs("p",{className:r("text-xs font-semibold",d.text.primary),children:[n.financial_impact.approval_confidence,"%"]})]})]}),e.jsxs("div",{className:r("p-2 rounded-lg mb-2",c==="dark"?"bg-white/5":"bg-gray-50"),children:[e.jsx("p",{className:r("text-xs",d.text.secondary),children:"MAC Contractor"}),e.jsxs("p",{className:r("text-xs font-medium",d.text.primary),children:[n.contractor.name," (",n.contractor.jurisdiction,")"]})]}),n.lcd_compliance.status!=="compliant"&&e.jsxs("div",{className:r("p-3 rounded-lg mb-3",c==="dark"?"bg-yellow-500/10":"bg-yellow-50"),children:[e.jsx("p",{className:r("text-xs font-medium mb-2","text-yellow-600"),children:"LCD Compliance Issues"}),(w=n.lcd_compliance.missing_criteria)==null?void 0:w.map((x,m)=>e.jsxs("p",{className:r("text-xs",d.text.secondary),children:["• ",x]},m))]}),n.denial_prediction.top_risk_factors.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:r("text-xs font-medium mb-2",d.text.secondary),children:"Top Risk Factors"}),e.jsx("div",{className:"space-y-1",children:n.denial_prediction.top_risk_factors.slice(0,2).map((x,m)=>e.jsxs("div",{className:r("p-2 rounded text-xs",c==="dark"?"bg-white/5":"bg-gray-50"),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:d.text.primary,children:x.factor}),e.jsx("span",{className:r("text-xs px-2 py-0.5 rounded",x.impact==="high"?"bg-red-500/20 text-red-500":x.impact==="medium"?"bg-yellow-500/20 text-yellow-500":"bg-green-500/20 text-green-500"),children:x.impact})]}),x.mitigation&&e.jsxs("p",{className:r("mt-1 text-xs",d.text.secondary),children:["💡 ",x.mitigation]})]},m))})]}),e.jsx("div",{className:r("p-2 rounded-lg",c==="dark"?"bg-white/5":"bg-gray-50"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:r("text-xs",d.text.secondary),children:"Potential Denial"}),e.jsxs("p",{className:r("text-sm font-semibold","text-red-500"),children:["$",n.financial_impact.potential_denial_amount.toLocaleString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:r("text-xs",d.text.secondary),children:"Est. Reimbursement"}),e.jsxs("p",{className:r("text-sm font-semibold","text-green-500"),children:["$",n.financial_impact.estimated_reimbursement.toLocaleString()]})]})]})}),n.recommendations.length>0&&e.jsxs("div",{className:r("mt-3 p-3 rounded-lg",((_=n.recommendations[0])==null?void 0:_.priority)==="critical"?c==="dark"?"bg-red-500/20":"bg-red-50":c==="dark"?"bg-blue-500/20":"bg-blue-50"),children:[e.jsx("p",{className:r("text-xs font-medium mb-1",d.text.primary),children:"Recommended Action"}),e.jsx("p",{className:r("text-xs",d.text.primary),children:(N=n.recommendations[0])==null?void 0:N.action})]})]})}const ze=({episode:a,onRefresh:l,viewMode:n="compact",showMacValidation:b=!0})=>{var _,N,x;const[g,p]=f.useState(!1);let s="dark",i=$.dark;try{s=L().theme,i=$[s]}catch{}const d=(()=>{if(a.action_required)return"action-required";if(a.ivr_status==="expired")return"expired";if(a.expiration_date)try{const m=new Date(a.expiration_date),v=new Date;if(!(isNaN(m.getTime())||isNaN(v.getTime()))){const y=Math.ceil((m.getTime()-v.getTime())/864e5);if(y<=7&&y>0)return"expiring-soon"}}catch{console.warn("Invalid expiration date:",a.expiration_date)}return a.status==="completed"?"completed":a.status==="ready_for_review"?"pending":(a.ivr_status==="verified","active")})(),o={"action-required":{color:s==="dark"?"text-red-400":"text-red-600",bg:s==="dark"?"bg-red-500/20":"bg-red-100",border:s==="dark"?"border-red-500/30":"border-red-300",icon:z,label:"Action Required",pulse:!0},expired:{color:s==="dark"?"text-red-400":"text-red-600",bg:s==="dark"?"bg-red-500/20":"bg-red-100",border:s==="dark"?"border-red-500/30":"border-red-300",icon:O,label:"Expired",pulse:!1},"expiring-soon":{color:s==="dark"?"text-yellow-400":"text-yellow-600",bg:s==="dark"?"bg-yellow-500/20":"bg-yellow-100",border:s==="dark"?"border-yellow-500/30":"border-yellow-300",icon:q,label:"Expiring Soon",pulse:!0},active:{color:s==="dark"?"text-green-400":"text-green-600",bg:s==="dark"?"bg-green-500/20":"bg-green-100",border:s==="dark"?"border-green-500/30":"border-green-300",icon:D,label:"Active",pulse:!1},pending:{color:s==="dark"?"text-blue-400":"text-blue-600",bg:s==="dark"?"bg-blue-500/20":"bg-blue-100",border:s==="dark"?"border-blue-500/30":"border-blue-300",icon:V,label:"Processing",pulse:!1},inactive:{color:s==="dark"?"text-gray-400":"text-gray-600",bg:s==="dark"?"bg-gray-500/20":"bg-gray-100",border:s==="dark"?"border-gray-500/30":"border-gray-300",icon:O,label:"Inactive",pulse:!1},completed:{color:s==="dark"?"text-green-400":"text-green-600",bg:s==="dark"?"bg-green-500/20":"bg-green-100",border:s==="dark"?"border-green-500/30":"border-green-300",icon:D,label:"Completed",pulse:!1}}[d],u=o.icon,S=(()=>{try{if(!a.created_at)return 0;const m=new Date(a.created_at),v=new Date;if(isNaN(m.getTime())||isNaN(v.getTime()))return 0;const y=v.getTime()-m.getTime(),M=Math.ceil(y/(1e3*60*60*24));return M>0?M:0}catch{return console.warn("Invalid created_at date:",a.created_at),0}})(),w=()=>{j.visit(`/admin/episodes/${a.id}`)};return e.jsxs("div",{className:r("group relative rounded-xl transition-all duration-300",s==="dark"?i.glass.card:"bg-white shadow-sm","border",o.border,"hover:shadow-lg hover:scale-[1.01]",n==="expanded"&&"col-span-full",g&&"z-[100]"),children:[o.pulse&&e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("div",{className:r("w-2 h-2 rounded-full animate-ping",o.bg)})}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:r("w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold text-lg","bg-gradient-to-br from-[#1925c3] to-[#c71719]"),children:a.manufacturer.logo?e.jsx("img",{src:a.manufacturer.logo,alt:a.manufacturer.name,className:"w-8 h-8 object-contain"}):a.manufacturer.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:r("font-semibold text-lg",i.text.primary),children:a.patient_display_id}),e.jsx("p",{className:r("text-sm",i.text.secondary),children:a.manufacturer.name})]})]}),e.jsxs("div",{className:r("flex items-center space-x-2 px-3 py-1.5 rounded-full",o.bg,o.color),children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:o.label})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:r("p-3 rounded-lg",s==="dark"?"bg-white/5":"bg-gray-50"),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(T,{className:r("w-4 h-4",i.text.secondary)}),e.jsx("span",{className:r("text-xs",i.text.secondary),children:"Orders"})]}),e.jsx("p",{className:r("text-lg font-semibold",i.text.primary),children:a.orders_count||0})]}),e.jsxs("div",{className:r("p-3 rounded-lg",s==="dark"?"bg-white/5":"bg-gray-50"),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(X,{className:r("w-4 h-4",i.text.secondary)}),e.jsx("span",{className:r("text-xs",i.text.secondary),children:"Value"})]}),e.jsx("p",{className:r("text-lg font-semibold",i.text.primary),children:Oe(a.total_order_value||0)})]}),e.jsxs("div",{className:r("p-3 rounded-lg",s==="dark"?"bg-white/5":"bg-gray-50"),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx(H,{className:r("w-4 h-4",i.text.secondary)}),e.jsx("span",{className:r("text-xs",i.text.secondary),children:"Days Active"})]}),e.jsx("p",{className:r("text-lg font-semibold",i.text.primary),children:S})]})]}),b&&e.jsxs("div",{className:r("mt-3 p-2 rounded-lg flex items-center justify-between",s==="dark"?"bg-blue-500/10":"bg-blue-50"),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:r("w-4 h-4",s==="dark"?"text-blue-400":"text-blue-600")}),e.jsx("span",{className:r("text-xs font-medium",i.text.secondary),children:"MAC Validation Status"})]}),e.jsx("span",{className:r("text-xs",i.text.secondary),children:"Click to expand for details"})]}),e.jsx(qe,{episodeId:a.id,status:d,onViewDetails:w,onRefresh:l}),g&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/20 z-40",onClick:()=>p(!1)}),e.jsx("div",{className:r("absolute top-full left-0 right-0 z-50 mt-2","rounded-xl shadow-xl border backdrop-blur-md",s==="dark"?"bg-gray-900/95 border-gray-700":"bg-white/95 border-gray-200"),children:e.jsxs("div",{className:"p-4 space-y-3 max-h-[70vh] overflow-y-auto",children:[b&&e.jsx(Ue,{episodeId:a.id,orders:a.orders,facilityState:(x=(N=(_=a.orders)==null?void 0:_[0])==null?void 0:N.facility)==null?void 0:x.state,className:"mb-3"}),e.jsx(Be,{episode:a,theme:s})]})})]}),e.jsxs("button",{onClick:()=>p(!g),className:r("mt-3 w-full py-2 flex items-center justify-center space-x-1 rounded-lg transition-colors",s==="dark"?"hover:bg-white/5":"hover:bg-gray-50",i.text.secondary),children:[e.jsx("span",{className:"text-sm",children:g?"Hide Details":b?"Show MAC Validation & Timeline":"Show Timeline"}),g?e.jsx(xe,{className:"w-4 h-4"}):e.jsx(me,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:r("absolute inset-0 bg-gradient-to-t opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",s==="dark"?"from-blue-500/10 to-transparent":"from-blue-50/50 to-transparent")})]})};he.register(ue,be,fe,ye,je,ve,we,Ne,ke,_e);function Ss({episodes:a=[],stats:l={total_episodes:0,pending_review:0,ivr_expiring_soon:0,total_value:0,episodes_this_week:0,completion_rate:0},aiInsights:n=[],recentActivity:b=[],performanceData:g={labels:[],episodesCompleted:[],averageProcessingTime:[]}}){let p="dark",s=$.dark;try{p=L().theme,s=$[p]}catch{}const[i,c]=f.useState(!1),[d,k]=f.useState(!0),[o,u]=f.useState("episodes"),[C,S]=f.useState("cards"),[w,_]=f.useState(""),[N,x]=f.useState("all"),[m,v]=f.useState(!1),y=f.useRef(null);f.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const t=window.webkitSpeechRecognition||window.SpeechRecognition;y.current=new t,y.current.continuous=!1,y.current.interimResults=!1,y.current.lang="en-US",y.current.onresult=h=>{const F=h.results[0][0].transcript.toLowerCase();M(F),v(!1)},y.current.onerror=()=>{v(!1)}}},[]);const M=t=>{t.includes("show episodes")||t.includes("view episodes")?(u("episodes"),A("Showing episodes view")):t.includes("review ivr")||t.includes("pending review")?(j.visit(route("admin.episodes.pending-review")),A("Opening pending IVR reviews")):t.includes("analytics")||t.includes("show analytics")?(u("analytics"),A("Showing analytics dashboard")):t.includes("workflow")||t.includes("show workflow")?(u("workflow"),A("Showing workflow view")):(t.includes("refresh")||t.includes("reload"))&&(j.reload(),A("Refreshing dashboard data"))},A=t=>{if("speechSynthesis"in window&&i){const h=new SpeechSynthesisUtterance(t);h.rate=1,h.pitch=1,window.speechSynthesis.speak(h)}},J=()=>{y.current&&(m?(y.current.stop(),v(!1)):(y.current.start(),v(!0),A("Listening for commands")))};f.useEffect(()=>{const t=setInterval(()=>{j.reload({only:["recentActivity","stats"]})},3e4);return()=>clearInterval(t)},[]);const P=a.filter(t=>{const h=w===""||t.patient_display_id.toLowerCase().includes(w.toLowerCase())||t.orders.some(Z=>Z.order_number.toLowerCase().includes(w.toLowerCase())),F=N==="all"||t.manufacturer.name===N;return h&&F}),K={labels:g.labels,datasets:[{label:"Episodes Completed",data:g.episodesCompleted,borderColor:p==="dark"?"rgb(59, 130, 246)":"rgb(37, 99, 235)",backgroundColor:p==="dark"?"rgba(59, 130, 246, 0.1)":"rgba(37, 99, 235, 0.1)",tension:.4,fill:!0}]},Y={labels:["Pending Review","IVR Sent","Verified","In Progress","Completed"],datasets:[{data:[a.filter(t=>t.status==="ready_for_review").length,a.filter(t=>t.status==="ivr_sent").length,a.filter(t=>t.status==="ivr_verified").length,a.filter(t=>t.status==="sent_to_manufacturer").length,a.filter(t=>t.status==="completed").length],backgroundColor:["#F59E0B","#3B82F6","#10B981","#8B5CF6","#6B7280"],borderWidth:0}]},W={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:p==="dark"?"#9CA3AF":"#6B7280"}},y:{grid:{color:p==="dark"?"rgba(75, 85, 99, 0.2)":"rgba(229, 231, 235, 0.5)"},ticks:{color:p==="dark"?"#9CA3AF":"#6B7280"}}}};return e.jsxs(re,{children:[e.jsx(se,{title:"Enhanced Order Center Dashboard | MSC Healthcare"}),e.jsxs("div",{className:`min-h-screen ${p==="dark"?"bg-gray-900":"bg-gray-50"} p-6`,children:[e.jsx("div",{className:`${s.glass.card} ${s.glass.border} p-6 mb-6`,children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"mb-4 lg:mb-0",children:[e.jsx("h1",{className:`text-2xl font-bold ${s.text.primary}`,children:"Order Management Center"}),e.jsx("p",{className:`${s.text.secondary} mt-1`,children:"AI-powered episode tracking and workflow automation"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("button",{onClick:()=>c(!i),className:`${s.button.secondary} px-4 py-2 flex items-center space-x-2`,children:[i?e.jsx($e,{className:"w-4 h-4"}):e.jsx(Fe,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:["Voice: ",i?"On":"Off"]})]}),i&&e.jsxs("button",{onClick:J,className:`${m?s.button.danger:s.button.primary} px-4 py-2 flex items-center space-x-2`,children:[m?e.jsx(Ie,{className:"w-4 h-4"}):e.jsx(Te,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:m?"Listening...":"Start Voice"})]}),e.jsxs("div",{className:`${s.glass.card} ${s.glass.border} p-1 flex`,children:[e.jsx("button",{onClick:()=>u("episodes"),className:`px-3 py-1.5 text-sm rounded transition-colors ${o==="episodes"?`${s.button.primary}`:`${s.button.ghost}`}`,children:"Episodes"}),e.jsx("button",{onClick:()=>u("analytics"),className:`px-3 py-1.5 text-sm rounded transition-colors ${o==="analytics"?`${s.button.primary}`:`${s.button.ghost}`}`,children:"Analytics"}),e.jsx("button",{onClick:()=>u("workflow"),className:`px-3 py-1.5 text-sm rounded transition-colors ${o==="workflow"?`${s.button.primary}`:`${s.button.ghost}`}`,children:"Workflow"})]}),o==="episodes"&&e.jsxs("div",{className:`${s.glass.card} ${s.glass.border} p-1 flex`,children:[e.jsx("button",{onClick:()=>S("cards"),className:`p-2 rounded transition-colors ${C==="cards"?`${s.button.primary}`:`${s.button.ghost}`}`,title:"Card view",children:e.jsx(Le,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>S("list"),className:`p-2 rounded transition-colors ${C==="list"?`${s.button.primary}`:`${s.button.ghost}`}`,title:"List view",children:e.jsx(Pe,{className:"w-4 h-4"})})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:`${s.glass.card} ${s.glass.border} p-4 hover:shadow-lg transition-all`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${s.text.secondary}`,children:"Episodes"}),e.jsx("p",{className:`text-xl font-bold ${s.text.primary}`,children:l.total_episodes}),e.jsxs("p",{className:"text-xs text-green-500 mt-1",children:["+",l.episodes_this_week," this week"]})]}),e.jsx(Se,{className:"w-5 h-5 text-blue-500"})]})}),e.jsx("div",{className:`${s.glass.card} ${s.glass.border} p-4 hover:shadow-lg transition-all`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${s.text.secondary}`,children:"Pending"}),e.jsx("p",{className:`text-xl font-bold ${l.pending_review>0?"text-yellow-600":s.text.primary}`,children:l.pending_review}),e.jsx("p",{className:`text-xs ${l.pending_review>0?"text-yellow-500":"text-green-500"} mt-1`,children:l.pending_review>0?"Action needed":"All clear"})]}),e.jsx(V,{className:"w-5 h-5 text-yellow-500"})]})}),e.jsx("div",{className:`${s.glass.card} ${s.glass.border} p-4 hover:shadow-lg transition-all`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${s.text.secondary}`,children:"Expiring"}),e.jsx("p",{className:`text-xl font-bold ${l.ivr_expiring_soon>0?"text-orange-600":s.text.primary}`,children:l.ivr_expiring_soon}),e.jsx("p",{className:`text-xs ${l.ivr_expiring_soon>0?"text-orange-500":"text-green-500"} mt-1`,children:l.ivr_expiring_soon>0?"≤30 days":"None"})]}),e.jsx(q,{className:"w-5 h-5 text-orange-500"})]})}),e.jsx("div",{className:`${s.glass.card} ${s.glass.border} p-4 hover:shadow-lg transition-all`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-xs ${s.text.secondary}`,children:"Value"}),e.jsxs("p",{className:`text-xl font-bold ${s.text.primary}`,children:["$",(l.total_value||0).toLocaleString(void 0,{maximumFractionDigits:0})]}),e.jsx("p",{className:"text-xs text-green-500 mt-1",children:"Total pipeline"})]}),e.jsx(X,{className:"w-5 h-5 text-green-500"})]})})]}),o==="episodes"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`${s.glass.card} ${s.glass.border} p-4 mb-6`,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ae,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 ${s.text.muted}`}),e.jsx("input",{type:"text",placeholder:"Search episodes, orders, or patient IDs...",value:w,onChange:t=>_(t.target.value),className:`w-full pl-10 pr-4 py-2 ${s.glass.border} rounded-lg`})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:N,onChange:t=>x(t.target.value),className:`px-4 py-2 ${s.glass.border} rounded-lg`,"aria-label":"Filter by manufacturer",children:[e.jsx("option",{value:"all",children:"All Manufacturers"}),Array.from(new Set(a.map(t=>t.manufacturer.name))).map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("button",{className:`${s.button.secondary} px-4 py-2 flex items-center space-x-2`,children:[e.jsx(De,{className:"w-4 h-4"}),e.jsx("span",{children:"More Filters"})]})]})]})}),C==="cards"?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6",children:P.map(t=>e.jsx("div",{className:"relative pb-4",children:e.jsx(ze,{episode:{...t,orders:t.orders.map(h=>({id:h.id,order_number:h.order_number,order_status:h.status,expected_service_date:new Date().toISOString().split("T")[0],submitted_at:new Date().toISOString(),provider:h.provider}))},onRefresh:()=>j.reload(),viewMode:"compact"})},t.id))}):e.jsx("div",{className:`${s.glass.card} ${s.glass.border} overflow-hidden`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:`${p==="dark"?"bg-gray-800/50":"bg-gray-50"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${s.text.secondary} uppercase tracking-wider`,children:"Episode"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${s.text.secondary} uppercase tracking-wider`,children:"Status"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${s.text.secondary} uppercase tracking-wider`,children:"Manufacturer"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${s.text.secondary} uppercase tracking-wider`,children:"Orders"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${s.text.secondary} uppercase tracking-wider`,children:"Value"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium ${s.text.secondary} uppercase tracking-wider`,children:"Latest Order"}),e.jsx("th",{className:`px-6 py-3 text-right text-xs font-medium ${s.text.secondary} uppercase tracking-wider`,children:"Actions"})]})}),e.jsx("tbody",{className:`divide-y ${p==="dark"?"divide-gray-700":"divide-gray-200"}`,children:P.map(t=>e.jsxs("tr",{className:`${s.glass.hover} hover:shadow-sm transition-all cursor-pointer`,onClick:()=>j.visit(route("admin.episodes.show",t.id)),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-gradient-to-br from-blue-500/20 to-purple-500/20 rounded-lg flex items-center justify-center",children:e.jsx(Ee,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:`text-sm font-medium ${s.text.primary}`,children:t.patient_display_id}),t.action_required&&e.jsxs("span",{className:"text-xs text-orange-500 flex items-center mt-1",children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),"Action Required"]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="ready_for_review"?"bg-yellow-100 text-yellow-800":t.status==="ivr_sent"?"bg-blue-100 text-blue-800":t.status==="ivr_verified"?"bg-green-100 text-green-800":t.status==="sent_to_manufacturer"?"bg-purple-100 text-purple-800":(t.status==="completed","bg-gray-100 text-gray-800")}`,children:t.status.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase())})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Me,{className:`w-4 h-4 ${s.text.muted} mr-2`}),e.jsx("span",{className:`text-sm ${s.text.primary}`,children:t.manufacturer.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`text-sm ${s.text.primary}`,children:t.orders_count||t.orders.length})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:["$",(t.total_order_value||0).toLocaleString()]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`text-sm ${s.text.secondary}`,children:t.latest_order_date?new Date(t.latest_order_date).toLocaleDateString():"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("button",{onClick:h=>{h.stopPropagation(),j.visit(route("admin.episodes.show",t.id))},className:`${s.button.ghost} inline-flex items-center px-3 py-1`,children:[e.jsx(R,{className:"w-4 h-4 mr-1"}),"View"]})})]},t.id))})]})})}),P.length===0&&e.jsxs("div",{className:`${s.glass.card} ${s.glass.border} p-12 text-center`,children:[e.jsx(T,{className:`w-12 h-12 ${s.text.muted} mx-auto mb-4`}),e.jsx("p",{className:`${s.text.secondary}`,children:"No episodes found matching your criteria"})]})]}),o==="analytics"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:`${s.glass.card} ${s.glass.border} p-6`,children:[e.jsx("h3",{className:`text-lg font-semibold ${s.text.primary} mb-4`,children:"Weekly Performance"}),e.jsx("div",{className:"h-64",children:e.jsx(pe,{data:K,options:W})})]}),e.jsxs("div",{className:`${s.glass.card} ${s.glass.border} p-6`,children:[e.jsx("h3",{className:`text-lg font-semibold ${s.text.primary} mb-4`,children:"Episode Status Distribution"}),e.jsx("div",{className:"h-64",children:e.jsx(ge,{data:Y,options:{...W,plugins:{legend:{display:!0,position:"bottom",labels:{color:p==="dark"?"#9CA3AF":"#6B7280"}}}}})})]}),e.jsxs("div",{className:`${s.glass.card} ${s.glass.border} p-6 lg:col-span-2`,children:[e.jsx("h3",{className:`text-lg font-semibold ${s.text.primary} mb-4`,children:"Recent Activity"}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:b.map(t=>e.jsxs("div",{className:`flex items-start space-x-3 p-3 ${s.glass.hover} rounded-lg`,children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(Re,{className:"w-4 h-4 text-blue-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm ${s.text.primary}`,children:t.description}),e.jsxs("p",{className:`text-xs ${s.text.muted} mt-1`,children:[t.user," • ",new Date(t.timestamp).toLocaleString()]})]})]},t.id))})]})]}),o==="workflow"&&e.jsxs("div",{className:`${s.glass.card} ${s.glass.border} p-8`,children:[e.jsx("h3",{className:`text-lg font-semibold ${s.text.primary} mb-6 text-center`,children:"Episode Workflow Overview"}),e.jsx("div",{className:"flex items-center justify-between max-w-4xl mx-auto",children:[{label:"Provider Submits",icon:U,count:a.filter(t=>t.status==="ready_for_review").length},{label:"Admin Reviews",icon:R,count:l.pending_review},{label:"IVR Sent",icon:I,count:a.filter(t=>t.status==="ivr_sent").length},{label:"Manufacturer Process",icon:T,count:a.filter(t=>t.status==="sent_to_manufacturer").length},{label:"Shipped",icon:G,count:a.filter(t=>t.status==="tracking_added").length},{label:"Completed",icon:D,count:a.filter(t=>t.status==="completed").length}].map((t,h)=>e.jsxs(te.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`p-4 rounded-full ${t.count>0?"bg-blue-500/20":"bg-gray-500/20"}`,children:e.jsx(t.icon,{className:`w-6 h-6 ${t.count>0?"text-blue-500":"text-gray-500"}`})}),e.jsx("p",{className:`text-sm font-medium ${s.text.primary} mt-2`,children:t.label}),e.jsxs("p",{className:`text-xs ${s.text.secondary} mt-1`,children:[t.count," episodes"]})]}),h<5&&e.jsx(Ve,{className:`w-6 h-6 ${s.text.muted}`})]},t.label))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-8",children:[e.jsxs("button",{onClick:()=>j.visit(route("admin.episodes.pending-review")),className:`${s.button.secondary} p-4 flex flex-col items-center space-y-2`,children:[e.jsx(R,{className:"w-6 h-6"}),e.jsx("span",{children:"Review Pending IVRs"})]}),e.jsxs("button",{onClick:()=>j.visit(route("admin.episodes.expiring")),className:`${s.button.secondary} p-4 flex flex-col items-center space-y-2`,children:[e.jsx(q,{className:"w-6 h-6"}),e.jsx("span",{children:"Expiring IVRs"})]}),e.jsxs("button",{onClick:()=>j.visit(route("admin.episodes.tracking")),className:`${s.button.secondary} p-4 flex flex-col items-center space-y-2`,children:[e.jsx(G,{className:"w-6 h-6"}),e.jsx("span",{children:"Update Tracking"})]})]})]}),i&&e.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:e.jsxs("div",{className:`${s.glass.card} ${s.glass.border} p-4 max-w-xs`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ce,{className:"w-4 h-4 text-blue-500"}),e.jsx("p",{className:`text-sm font-medium ${s.text.primary}`,children:"Voice Commands"})]}),e.jsxs("ul",{className:`text-xs ${s.text.secondary} space-y-1`,children:[e.jsx("li",{children:'• "Show episodes" - View episodes'}),e.jsx("li",{children:'• "Review IVR" - Open pending reviews'}),e.jsx("li",{children:'• "Show analytics" - View analytics'}),e.jsx("li",{children:'• "Show workflow" - View workflow'}),e.jsx("li",{children:'• "Refresh" - Reload data'})]})]})})]})]})}export{Ss as default};
