import{r as c,j as e}from"./app-b7vnQlZc.js";import{b as P,h as k}from"./api-Ct1kbUGY.js";import{I as E}from"./info-Bc-ZYgAB.js";import{P as I}from"./plus-D89T3Ycf.js";import{D as O}from"./dollar-sign-D-Bel8W2.js";import{C as R}from"./circle-check-big-CbaywUwj.js";import"./createLucideIcon-BGsZVnCF.js";const G=({formData:t,updateFormData:o})=>{const[l,d]=c.useState([]),[m,u]=c.useState(!1),[n,x]=c.useState([]),[T,S]=c.useState(null),h=async()=>{try{u(!0),S(null);const s=await P("/api/v1/clinical-opportunities/scan",{clinical_data:t.clinical_data,wound_type:t.wound_type,patient_data:t.patient_api_input,selected_products:t.selected_products}),i=await k(s);i.success?d(i.data.opportunities||[]):d(p())}catch(s){console.error("Clinical opportunities scan error:",s),d(p())}finally{u(!1)}},p=()=>{var i,a,r,g,b,f,j,v,_,N,y,w,q;const s=[];return t.wound_type==="diabetic_foot_ulcer"&&(s.push({id:"offloading_dme",service_name:"Offloading DME",hcpcs_code:"L4631",description:"Toe filler, foam or silicone gel, each",clinical_rationale:"Patient has diabetic foot ulcer requiring pressure redistribution for optimal healing.",estimated_reimbursement:125,frequency:"As needed",requirements:["DFU diagnosis","Pressure point identification","Provider prescription"],selected:!1}),((a=(i=t.clinical_data)==null?void 0:i.lab_results)==null?void 0:a.hba1c)>7&&s.push({id:"diabetes_education",service_name:"Diabetes Self-Management Training",hcpcs_code:"G0108",description:"Diabetes outpatient self-management training services",clinical_rationale:"HbA1c > 7% indicates need for enhanced diabetes management education.",estimated_reimbursement:85,frequency:"Initial + follow-up",requirements:["Diabetes diagnosis","Provider referral","Individual or group setting"],selected:!1})),(((g=(r=t.clinical_data)==null?void 0:r.vascular_evaluation)==null?void 0:g.abi_right)<.9||((f=(b=t.clinical_data)==null?void 0:b.vascular_evaluation)==null?void 0:f.abi_left)<.9)&&s.push({id:"vascular_study",service_name:"Arterial Duplex Study",hcpcs_code:"93922",description:"Limited bilateral noninvasive physiologic studies of upper or lower extremity arteries",clinical_rationale:"ABI < 0.9 indicates peripheral arterial disease requiring further vascular assessment.",estimated_reimbursement:245,frequency:"As clinically indicated",requirements:["Abnormal ABI","Vascular symptoms","Provider order"],selected:!1}),((_=(v=(j=t.clinical_data)==null?void 0:j.wound_details)==null?void 0:v.infection_signs)==null?void 0:_.length)>0&&s.push({id:"wound_culture",service_name:"Wound Culture",hcpcs_code:"87070",description:"Culture, bacterial; any source except blood, anaerobic",clinical_rationale:"Signs of infection present requiring culture to guide antibiotic therapy.",estimated_reimbursement:35,frequency:"As needed",requirements:["Signs of infection","Sterile collection technique","Provider order"],selected:!1}),(((y=(N=t.clinical_data)==null?void 0:N.wound_details)==null?void 0:y.tissue_type)==="slough"||((q=(w=t.clinical_data)==null?void 0:w.wound_details)==null?void 0:q.tissue_type)==="eschar")&&s.push({id:"debridement",service_name:"Wound Debridement",hcpcs_code:"11042",description:"Debridement, subcutaneous tissue; first 20 sq cm or less",clinical_rationale:"Non-viable tissue present requiring debridement for optimal wound healing.",estimated_reimbursement:180,frequency:"As needed",requirements:["Non-viable tissue","Appropriate setting","Provider qualification"],selected:!1}),s};c.useEffect(()=>{t.clinical_data&&Object.keys(t.clinical_data).length>0&&h()},[]);const C=s=>{const i=n.includes(s)?n.filter(r=>r!==s):[...n,s];x(i);const a=l.filter(r=>i.includes(r.id));o({clinical_opportunities:a})},A=l.filter(s=>n.includes(s.id)).reduce((s,i)=>s+i.estimated_reimbursement,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-4",children:"Clinical Opportunities"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Review additional billable services identified based on your clinical assessment. These opportunities can improve patient outcomes while maximizing appropriate reimbursement."})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(E,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"Clinical Opportunity Engine"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Our AI analyzes your clinical documentation to identify evidence-based additional services that may benefit the patient and are supported by the clinical findings."})]})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Identified Opportunities"}),e.jsx("button",{onClick:h,disabled:m,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Rescan Opportunities"]})})]}),l.length>0?e.jsx("div",{className:"space-y-4",children:l.map(s=>e.jsx("div",{className:`border rounded-lg p-4 transition-colors ${n.includes(s.id)?"border-green-300 bg-green-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:n.includes(s.id),onChange:()=>C(s.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:s.service_name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.hcpcs_code," â€¢ ",s.frequency]})]})]}),e.jsx("p",{className:"text-sm text-gray-700 mt-2 ml-7",children:s.description}),e.jsxs("div",{className:"mt-3 ml-7",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-900 mb-1",children:"Clinical Rationale:"}),e.jsx("p",{className:"text-xs text-gray-600",children:s.clinical_rationale})]}),e.jsxs("div",{className:"mt-3 ml-7",children:[e.jsx("h5",{className:"text-xs font-medium text-gray-900 mb-1",children:"Requirements:"}),e.jsx("ul",{className:"text-xs text-gray-600 list-disc list-inside",children:s.requirements.map((i,a)=>e.jsx("li",{children:i},a))})]}),s.contraindications&&s.contraindications.length>0&&e.jsxs("div",{className:"mt-2 ml-7",children:[e.jsx("h5",{className:"text-xs font-medium text-red-900 mb-1",children:"Contraindications:"}),e.jsx("ul",{className:"text-xs text-red-600 list-disc list-inside",children:s.contraindications.map((i,a)=>e.jsx("li",{children:i},a))})]})]}),e.jsxs("div",{className:"ml-4 text-right",children:[e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:s.estimated_reimbursement.toFixed(2)})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Est. reimbursement"})]})]})},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(R,{className:"h-12 w-12 mx-auto"})}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"No Additional Opportunities Identified"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Based on the current clinical assessment, no additional billable services were identified. This may change as you complete more of the clinical documentation."})]}),n.length>0&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-green-900",children:["Selected Opportunities (",n.length,")"]}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"These services will be added to your order for consideration."})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(O,{className:"h-5 w-5"}),e.jsx("span",{className:"text-lg font-semibold",children:A.toFixed(2)})]}),e.jsx("p",{className:"text-xs text-green-600",children:"Total estimated value"})]})]})}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx("button",{onClick:()=>{x([]),o({clinical_opportunities:[]})},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear All Selections"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[n.length," of ",l.length," opportunities selected"]})]})]})};export{G as default};
