import{r as g,j as e}from"./app-CkbwHOkf.js";import{C as $}from"./circle-alert-D5RtSiPV.js";import{L as A}from"./loader-circle-CzGXBM_P.js";import{C as E}from"./check-DXIgFk-v.js";import"./createLucideIcon-HYdXrwBu.js";const a=({title:s,children:r})=>e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-3",children:s}),e.jsx("div",{className:"space-y-4",children:r})]}),i=({label:s,value:r})=>r==null||r===""?null:e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:s}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:typeof r=="string"||typeof r=="number"?r:e.jsx(e.Fragment,{children:r})})]}),I=({formData:s,updateFormData:r,onSubmit:y})=>{var x,u,p,h,j;const[d,c]=g.useState(!1),[o,m]=g.useState(null),v=async()=>{c(!0),m(null);try{await y()}catch(t){console.error("Submission failed in ReviewSubmitStep:",t),m(t.message||"Failed to submit order. Please try again.")}finally{c(!1)}},N=()=>!s.selected_products||s.selected_products.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No products selected."}):e.jsx("ul",{className:"divide-y divide-gray-200",children:s.selected_products.map((t,n)=>e.jsx("li",{className:"py-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name||`Product ID: ${t.product_id}`}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.size?`Size: ${t.size} â€¢ `:"","Quantity: ",t.quantity]})]}),t.q_code&&e.jsx("span",{className:"ml-4 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:t.q_code})]})},t.product_id||n))}),_=()=>!s.clinical_data||Object.keys(s.clinical_data).length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No clinical assessment data provided."}):e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("pre",{children:JSON.stringify(s.clinical_data,null,2)})}),f=()=>{if(!s.mac_validation_results)return e.jsx("p",{className:"text-sm text-gray-500",children:"MAC validation not yet performed or results unavailable."});const{status:t,score:n,issues:l}=s.mac_validation_results;return e.jsxs("div",{children:[e.jsx(i,{label:"Status",value:t}),e.jsx(i,{label:"Compliance Score",value:n!==void 0?`${n}%`:"N/A"}),l&&l.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Issues:"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:l.map((b,C)=>e.jsx("li",{className:`text-sm ${b.type==="error"?"text-red-600":"text-yellow-600"}`,children:b.message},C))})]})]})},S=()=>{if(!s.eligibility_results)return e.jsx("p",{className:"text-sm text-gray-500",children:"Eligibility check not yet performed or results unavailable."});const{status:t,prior_authorization_required:n,benefits:l}=s.eligibility_results;return e.jsxs("div",{children:[e.jsx(i,{label:"Status",value:t}),e.jsx(i,{label:"Prior Authorization Required",value:n?"Yes":"No"}),l&&e.jsxs(e.Fragment,{children:[e.jsx(i,{label:"Copay",value:l.copay!==void 0?`$${l.copay}`:"N/A"}),e.jsx(i,{label:"Deductible",value:l.deductible!==void 0?`$${l.deductible}`:"N/A"})]})]})},w=()=>!s.clinical_opportunities||s.clinical_opportunities.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No clinical opportunities selected."}):e.jsx("ul",{className:"divide-y divide-gray-200",children:s.clinical_opportunities.map((t,n)=>{var l;return e.jsxs("li",{className:"py-3",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[t.service_name," (",t.hcpcs_code,")"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Est. Reimbursement: $",(l=t.estimated_reimbursement)==null?void 0:l.toFixed(2)]})]},t.id||n)})});return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white shadow-xl sm:rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-xl font-semibold leading-7 text-gray-900 mb-6",children:"Review and Submit Order"}),e.jsx(a,{title:"Patient & Order Details",children:e.jsxs("div",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2",children:[e.jsx(i,{label:"Patient Name",value:`${((x=s.patient_api_input)==null?void 0:x.first_name)||""} ${((u=s.patient_api_input)==null?void 0:u.last_name)||""}`}),e.jsx(i,{label:"Date of Birth",value:(p=s.patient_api_input)==null?void 0:p.dob}),e.jsx(i,{label:"Member ID",value:(h=s.patient_api_input)==null?void 0:h.member_id}),e.jsx(i,{label:"Gender",value:(j=s.patient_api_input)==null?void 0:j.gender}),e.jsx(i,{label:"Facility",value:s.facility_id?`ID: ${s.facility_id}`:"Not Selected"})," ",e.jsx(i,{label:"Expected Service Date",value:s.expected_service_date}),e.jsx(i,{label:"Payer Name",value:s.payer_name}),e.jsx(i,{label:"Wound Type",value:s.wound_type})]})}),e.jsx(a,{title:"Clinical Assessment Summary",children:_()}),e.jsx(a,{title:"Selected Products",children:N()}),e.jsx(a,{title:"MAC Validation",children:f()}),e.jsx(a,{title:"Eligibility Check",children:S()}),e.jsx(a,{title:"Selected Clinical Opportunities",children:w()}),e.jsx(a,{title:"Provider Notes",children:e.jsx("textarea",{id:"provider_notes",name:"provider_notes",rows:4,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Add any relevant notes for this order...",value:s.provider_notes||"",onChange:t=>r({provider_notes:t.target.value})})}),o&&e.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx($,{className:"h-5 w-5 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Submission Error"}),e.jsx("p",{className:"mt-1 text-sm text-red-700",children:o})]})]})}),e.jsx("div",{className:"mt-8 pt-5 border-t border-gray-200 flex justify-end",children:e.jsx("button",{type:"button",onClick:v,disabled:d,className:"inline-flex items-center justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50",children:d?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"animate-spin -ml-1 mr-3 h-5 w-5"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"-ml-1 mr-2 h-5 w-5"}),"Confirm and Submit Order"]})})})]})})})};export{I as default};
