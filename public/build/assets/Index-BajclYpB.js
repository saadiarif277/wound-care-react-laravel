import{r as c,G as O,j as e,S as B}from"./app-taSqzBVs.js";import{M as G}from"./MainLayout-Dw1zk4VW.js";import{A as U}from"./react-select-async.esm-CH9fime6.js";import{_ as W,l as q,m as X,d as Y}from"./index-BQkVVL-M.js";import{a as g}from"./api-D-Fi0ivM.js";import"./x-tQL0mm7-.js";import"./createLucideIcon-CJpMkWaB.js";import"./triangle-alert-BOyfSih_.js";import"./check-B1Sfkp9P.js";const de=()=>{var E,P;const[o,y]=c.useState(1),[i,f]=c.useState(null),[j,b]=c.useState(!1),[m,x]=c.useState([{code:"",type:"hcpcs"}]),[A,u]=c.useState(!1),[h,v]=c.useState(null),[D,N]=c.useState(null),[_,p]=c.useState({}),[w,C]=c.useState(!1),[S,I]=c.useState([]),{data:a,setData:d,post:J,processing:K,errors:Q,reset:$}=O({patient:{first_name:"",last_name:"",date_of_birth:"",gender:"male",member_id:""},payer:{name:"",id:"",insurance_type:""},service_date:"",service_codes:m}),F=async s=>{try{return s.length<2?[]:(await g.providers.search(s)).map(l=>{var n;return{value:l.id,label:`${l.name} - ${((n=l.facility)==null?void 0:n.name)||"Unknown Facility"}`,payer_id:l.primary_payer_id||"",payer_name:l.primary_payer_name||"",npi:l.npi||""}})}catch(t){return console.error("Error loading provider options:",t),[]}};c.useEffect(()=>{(async()=>{try{const t=await g.eligibility.getHistory();I(t)}catch(t){console.error("Error loading eligibility history:",t)}})()},[]);const R=s=>{N(s),s&&d("payer",{name:s.payer_name,id:s.payer_id,insurance_type:"commercial"})},V=()=>{const s=[...m,{code:"",type:"hcpcs"}];x(s),d("service_codes",s)},M=s=>{const t=m.filter((l,n)=>n!==s);x(t),d("service_codes",t)},k=(s,t,l)=>{const n=[...m];n[s]={...n[s],[t]:l},x(n),d("service_codes",n)},z=async()=>{b(!0),p({});try{const s=L();if(!s.isValid){p(s.errors),b(!1);return}const t=await g.eligibility.checkEligibility(a);f(t),y(2)}catch(s){console.error("Eligibility check failed:",s),p({patient:{first_name:[s instanceof Error?s.message:"Eligibility check failed"]}})}finally{b(!1)}},L=()=>{const s={};let t=!0;return a.patient.first_name.trim()||(s.patient={...s.patient,first_name:["First name is required"]},t=!1),a.patient.last_name.trim()||(s.patient={...s.patient,last_name:["Last name is required"]},t=!1),a.patient.date_of_birth||(s.patient={...s.patient,date_of_birth:["Date of birth is required"]},t=!1),a.patient.member_id.trim()||(s.patient={...s.patient,member_id:["Member ID is required"]},t=!1),a.payer.name.trim()||(s.payer={...s.payer,name:["Payer name is required"]},t=!1),a.service_date||(s.service_date=["Service date is required"],t=!1),m.filter(n=>n.code.trim()).length===0&&(s.service_codes=["At least one service code is required"],t=!1),{isValid:t,errors:s}},H=async()=>{if(i){C(!0);try{v({request_id:"PA-"+Date.now(),status:"submitted",estimated_processing_time:"3-5 business days"}),u(!1)}catch(s){console.error("Prior auth request failed:",s)}finally{C(!1)}}},T=()=>{y(1),f(null),v(null),u(!1),N(null),x([{code:"",type:"hcpcs"}]),p({}),$()},r=(s,t)=>{var l,n;return t?(n=(l=_[s])==null?void 0:l[t])==null?void 0:n[0]:_[s]};return e.jsxs(G,{children:[e.jsx(B,{title:"Eligibility Verification"}),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Eligibility Verification"}),e.jsx("p",{className:"text-gray-600",children:"Verify patient insurance coverage and benefits"})]}),o>1&&e.jsx("button",{onClick:T,className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600",children:"New Verification"})]}),e.jsxs("div",{className:"flex items-center space-x-4 bg-white p-4 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:`flex items-center ${o>=1?"text-blue-600":"text-gray-400"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${o>=1?"bg-blue-600 text-white":"bg-gray-200"}`,children:"1"}),e.jsx("span",{className:"ml-2 font-medium",children:"Patient Info"})]}),e.jsx("div",{className:"w-8 h-0.5 bg-gray-300"}),e.jsxs("div",{className:`flex items-center ${o>=2?"text-blue-600":"text-gray-400"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${o>=2?"bg-blue-600 text-white":"bg-gray-200"}`,children:"2"}),e.jsx("span",{className:"ml-2 font-medium",children:"Results"})]})]}),o===1&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-6",children:"Patient & Insurance Information"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Provider/Facility"}),e.jsx(U,{loadOptions:F,onChange:R,value:D,placeholder:"Search for provider or facility...",className:"react-select-container",classNamePrefix:"react-select",isClearable:!0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This will auto-populate payer information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{type:"text",value:a.patient.first_name,onChange:s=>d("patient",{...a.patient,first_name:s.target.value}),className:`w-full px-3 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ${r("patient","first_name")?"border-red-500":"border-gray-300"}`,placeholder:"Patient's first name"}),r("patient","first_name")&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r("patient","first_name")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{type:"text",value:a.patient.last_name,onChange:s=>d("patient",{...a.patient,last_name:s.target.value}),className:`w-full px-3 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ${r("patient","last_name")?"border-red-500":"border-gray-300"}`,placeholder:"Patient's last name"}),r("patient","last_name")&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r("patient","last_name")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth *"}),e.jsx("input",{type:"date",value:a.patient.date_of_birth,onChange:s=>d("patient",{...a.patient,date_of_birth:s.target.value}),className:`w-full px-3 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ${r("patient","date_of_birth")?"border-red-500":"border-gray-300"}`}),r("patient","date_of_birth")&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r("patient","date_of_birth")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),e.jsxs("select",{value:a.patient.gender,onChange:s=>d("patient",{...a.patient,gender:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Member ID *"}),e.jsx("input",{type:"text",value:a.patient.member_id,onChange:s=>d("patient",{...a.patient,member_id:s.target.value}),className:`w-full px-3 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ${r("patient","member_id")?"border-red-500":"border-gray-300"}`,placeholder:"Insurance member ID"}),r("patient","member_id")&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r("patient","member_id")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Service Date *"}),e.jsx("input",{type:"date",value:a.service_date,onChange:s=>d("service_date",s.target.value),className:`w-full px-3 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ${r("service_date")?"border-red-500":"border-gray-300"}`}),r("service_date")&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:(E=r("service_date"))==null?void 0:E[0]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-md font-semibold mb-4",children:"Insurance/Payer Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payer Name *"}),e.jsx("input",{type:"text",value:a.payer.name,onChange:s=>d("payer",{...a.payer,name:s.target.value}),className:`w-full px-3 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 ${r("payer","name")?"border-red-500":"border-gray-300"}`,placeholder:"e.g., Aetna, BCBS, Medicare"}),r("payer","name")&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r("payer","name")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payer ID"}),e.jsx("input",{type:"text",value:a.payer.id,onChange:s=>d("payer",{...a.payer,id:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Payer identifier"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Insurance Type"}),e.jsxs("select",{value:a.payer.insurance_type,onChange:s=>d("payer",{...a.payer,insurance_type:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"commercial",children:"Commercial"}),e.jsx("option",{value:"medicare",children:"Medicare"}),e.jsx("option",{value:"medicaid",children:"Medicaid"}),e.jsx("option",{value:"medicare_advantage",children:"Medicare Advantage"}),e.jsx("option",{value:"other",children:"Other"})]})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-md font-semibold",children:"Service Codes"}),e.jsx("button",{type:"button",onClick:V,className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700",children:"Add Code"})]}),m.map((s,t)=>e.jsxs("div",{className:"flex gap-4 mb-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:s.code,onChange:l=>k(t,"code",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Service code"})}),e.jsx("div",{className:"w-32",children:e.jsxs("select",{value:s.type,onChange:l=>k(t,"type",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"hcpcs",children:"HCPCS"}),e.jsx("option",{value:"cpt",children:"CPT"}),e.jsx("option",{value:"icd10",children:"ICD-10"})]})}),m.length>1&&e.jsx("button",{type:"button",onClick:()=>M(t),className:"bg-red-500 text-white px-3 py-2 rounded hover:bg-red-600",children:"Remove"})]},t)),r("service_codes")&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:(P=r("service_codes"))==null?void 0:P[0]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:z,disabled:j,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:j?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"animate-spin mr-2"}),"Verifying..."]}):"Check Eligibility"})})]})]}),o===2&&i&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-center",children:[i.eligible?e.jsx(q,{className:"h-6 w-6 text-green-500 mr-3"}):e.jsx(X,{className:"h-6 w-6 text-red-500 mr-3"}),e.jsxs("h2",{className:"text-lg font-semibold",children:["Eligibility Status: ",i.eligible?"Eligible":"Not Eligible"]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Coverage Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:i.coverage_details.active?"text-green-600":"text-red-600",children:i.coverage_details.active?"Active":"Inactive"})]}),i.coverage_details.copay&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Copay:"}),e.jsxs("span",{children:["$",i.coverage_details.copay]})]}),i.coverage_details.deductible&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Deductible:"}),e.jsxs("span",{children:["$",i.coverage_details.deductible]})]}),i.effective_date&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Effective Date:"}),e.jsx("span",{children:new Date(i.effective_date).toLocaleDateString()})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Authorization"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Prior Auth Required:"}),e.jsx("span",{className:i.prior_auth_required?"text-yellow-600":"text-green-600",children:i.prior_auth_required?"Yes":"No"})]}),i.limitations&&i.limitations.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Limitations:"}),e.jsx("ul",{className:"list-disc list-inside mt-1",children:i.limitations.map((s,t)=>e.jsx("li",{className:"text-gray-700",children:s},t))})]})]})]})]}),i.prior_auth_required&&!h&&e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-5 w-5 text-yellow-600 mr-2"}),e.jsx("p",{className:"text-yellow-800",children:"Prior authorization is required for this service. Would you like to submit a request?"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("button",{onClick:()=>u(!0),className:"bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700",children:"Request Prior Authorization"})})]}),h&&e.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsx("p",{className:"text-green-800",children:"Prior authorization request submitted successfully."})]}),e.jsxs("div",{className:"mt-2 text-sm text-green-700",children:[e.jsxs("p",{children:["Request ID: ",h.request_id]}),e.jsxs("p",{children:["Estimated processing time: ",h.estimated_processing_time]})]})]})]})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Request Prior Authorization"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"This will submit a prior authorization request to the payer. The request typically takes 3-5 business days to process."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>u(!1),className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{onClick:H,disabled:w,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:w?"Submitting...":"Submit Request"})]})]})})]}),S.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Recent Eligibility Checks"})}),e.jsx("div",{className:"divide-y",children:S.slice(0,5).map((s,t)=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.patient_name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.payer_name}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleString()})]}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.eligible?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.eligible?"Eligible":"Not Eligible"})]})},t))})]})]})]})};export{de as default};
