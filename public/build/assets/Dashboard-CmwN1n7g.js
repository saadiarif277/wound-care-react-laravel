import{u as E,r as x,j as e,S as f}from"./app-CkbwHOkf.js";import{M as w}from"./MainLayout-DIjIBnGe.js";import{c as s,t as O}from"./glass-theme-CCnqi7lL.js";import{M as u}from"./MetricCard-D38A2XjP.js";import{a as p}from"./api-CXAezOed.js";import{d as k,m as D,B as S,a as L,z as R,a3 as C,q as U,x as B,e as V,f as q}from"./index-R2fUhcwH.js";import"./x-CCCTsVjU.js";import"./createLucideIcon-HYdXrwBu.js";import"./triangle-alert-D2zL4pqG.js";import"./check-DXIgFk-v.js";function te({user:z,auth:P}){const{theme:n}=E(),a=O[n],[T,g]=x.useState(!0),[m,y]=x.useState("overview"),[l,A]=x.useState(null),[b,F]=x.useState([]),[c,$]=x.useState(null),[o,_]=x.useState(null),[i,j]=x.useState({dateRange:{start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},statusFilter:[]}),N=async()=>{g(!0);try{const[t,r,I,M]=await Promise.all([p.salesReps.getCommissionSummary({date_from:i.dateRange.start,date_to:i.dateRange.end}),p.salesReps.getCommissionDetails({date_from:i.dateRange.start,date_to:i.dateRange.end,per_page:10}),p.salesReps.getDelayedPayments({threshold_days:60}),p.salesReps.getCommissionAnalytics({period:"monthly",date_from:i.dateRange.start,date_to:i.dateRange.end})]);A(t),F(r.data),$(I),_(M.data)}catch(t){console.error("Error fetching dashboard data:",t)}finally{g(!1)}};x.useEffect(()=>{N()},[i.dateRange]);const d=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),h=t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),v=t=>{const r="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(t.toLowerCase()){case"paid":return`${r} bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300`;case"pending":return`${r} bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300`;case"approved":return`${r} bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300`;case"disputed":return`${r} bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300`;default:return`${r} bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300`}};return T?e.jsxs(w,{children:[e.jsx(f,{title:"Sales Rep Dashboard"}),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"animate-spin h-8 w-8 mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:s("text-lg",a.text.secondary),children:"Loading your commission dashboard..."})]})})]}):e.jsxs(w,{children:[e.jsx(f,{title:"Sales Rep Dashboard"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:s("text-3xl font-bold",a.text.primary),children:"Commission Dashboard"}),e.jsxs("p",{className:s("text-sm",a.text.secondary),children:["Welcome back, ",P.user.first_name,"! Track your commissions and performance."]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{className:s("w-4 h-4",a.text.secondary)}),e.jsx("input",{type:"date",value:i.dateRange.start,onChange:t=>j(r=>({...r,dateRange:{...r.dateRange,start:t.target.value}})),className:s("px-3 py-2 text-sm rounded-lg border",n==="dark"?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-gray-900")}),e.jsx("span",{className:s("text-sm",a.text.secondary),children:"to"}),e.jsx("input",{type:"date",value:i.dateRange.end,onChange:t=>j(r=>({...r,dateRange:{...r.dateRange,end:t.target.value}})),className:s("px-3 py-2 text-sm rounded-lg border",n==="dark"?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-gray-900")})]}),e.jsxs("button",{onClick:N,className:s("flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all","bg-blue-600 hover:bg-blue-700 text-white"),children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"Refresh"})]})]})]}),l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(u,{title:"Total Paid",value:d(l.totals.paid),icon:e.jsx(S,{}),status:"success",subtitle:`${l.byStatus.paid.count} payments`}),e.jsx(u,{title:"Pending Payments",value:d(l.totals.pending),icon:e.jsx(L,{}),status:"warning",subtitle:`${l.byStatus.pending.count} pending`}),e.jsx(u,{title:"Processing",value:d(l.totals.processing),icon:e.jsx(R,{}),status:"info",subtitle:`${l.byStatus.processing.count} in progress`}),e.jsx(u,{title:"Avg Payout Time",value:`${l.averagePayoutDays} days`,icon:e.jsx(D,{}),status:"default",subtitle:l.nextPayoutDate?`Next: ${h(l.nextPayoutDate)}`:"No upcoming payouts"})]}),c&&c.summary.totalDelayed>0&&e.jsx("div",{className:s("rounded-2xl p-6 border-2","bg-red-500/10 border-red-500/20 backdrop-blur-xl"),children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(C,{className:"w-6 h-6 text-red-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-900 dark:text-red-100",children:"Delayed Payments Alert"}),e.jsxs("p",{className:"text-sm text-red-700 dark:text-red-200 mt-1",children:["You have ",c.summary.totalDelayed," payments delayed by more than 60 days, totaling ",d(c.summary.totalAmount),"."]}),e.jsxs("button",{onClick:()=>y("delayed"),className:"inline-flex items-center mt-3 text-sm font-medium text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:["View delayed payments",e.jsx(U,{className:"w-4 h-4 ml-1"})]})]})]})}),e.jsxs("div",{className:s("rounded-2xl backdrop-blur-xl border-2",n==="dark"?"bg-white/[0.08] border-white/10":"bg-white/90 border-gray-200/50"),children:[e.jsx("div",{className:"border-b border-gray-200/20",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:[{id:"overview",label:"Overview",icon:R},{id:"details",label:"Commission Details",icon:S},{id:"delayed",label:"Delayed Payments",icon:C},{id:"analytics",label:"Analytics",icon:B}].map(t=>{const r=t.icon;return e.jsxs("button",{onClick:()=>y(t.id),className:s("py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 transition-colors",m===t.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:[e.jsx(r,{className:"w-4 h-4"}),e.jsx("span",{children:t.label})]},t.id)})})}),e.jsxs("div",{className:"p-6",children:[m==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:s("text-xl font-semibold",a.text.primary),children:"Recent Commission Activity"}),e.jsx("div",{className:"space-y-4",children:b.slice(0,5).map(t=>e.jsx("div",{className:s("p-4 rounded-xl border transition-all hover:shadow-lg",n==="dark"?"bg-white/5 border-white/10 hover:bg-white/10":"bg-white border-gray-200 hover:shadow-md"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h4",{className:s("font-medium",a.text.primary),children:t.orderId}),e.jsx("span",{className:v(t.status),children:t.status})]}),e.jsxs("p",{className:s("text-sm mt-1",a.text.secondary),children:[t.providerName," â€¢ ",t.product.name]}),e.jsx("p",{className:s("text-xs mt-1",a.text.tertiary),children:h(t.dateOfService)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:s("font-semibold",a.text.primary),children:d(t.commissionAmount)}),t.split&&e.jsxs("p",{className:s("text-xs",a.text.secondary),children:["Split: ",t.split.subRepPercentage,"%"]})]})]})},t.id))}),e.jsx("button",{onClick:()=>y("details"),className:s("w-full p-3 rounded-lg border-2 border-dashed font-medium transition-all","border-gray-300 text-gray-600 hover:border-blue-500 hover:text-blue-600","dark:border-gray-600 dark:text-gray-400 dark:hover:border-blue-400 dark:hover:text-blue-400"),children:"View all commission details"})]}),m==="details"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:s("text-xl font-semibold",a.text.primary),children:"Commission Details"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{className:s("flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium","bg-blue-600 hover:bg-blue-700 text-white"),children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{children:"Export"})]})})]}),e.jsx("div",{className:"space-y-4",children:b.map(t=>e.jsx("div",{className:s("p-6 rounded-xl border",n==="dark"?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:s("text-xs font-medium uppercase tracking-wider",a.text.tertiary),children:"Order & Provider"}),e.jsx("p",{className:s("font-medium mt-1",a.text.primary),children:t.orderId}),e.jsx("p",{className:s("text-sm",a.text.secondary),children:t.providerName}),e.jsx("p",{className:s("text-xs",a.text.tertiary),children:t.facilityName})]}),e.jsxs("div",{children:[e.jsx("p",{className:s("text-xs font-medium uppercase tracking-wider",a.text.tertiary),children:"Product & Service"}),e.jsx("p",{className:s("font-medium mt-1",a.text.primary),children:t.product.name}),e.jsx("p",{className:s("text-sm",a.text.secondary),children:t.product.manufacturer}),e.jsxs("p",{className:s("text-xs",a.text.tertiary),children:["Service: ",h(t.dateOfService)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:s("text-xs font-medium uppercase tracking-wider",a.text.tertiary),children:"Commission"}),e.jsx("p",{className:s("font-semibold text-lg mt-1",a.text.primary),children:d(t.commissionAmount)}),t.split&&e.jsxs("p",{className:s("text-sm",a.text.secondary),children:["Split: ",t.split.subRepPercentage,"% of ",d(t.split.repAmount+t.split.subRepAmount)]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:v(t.status),children:t.status}),t.paymentDate&&e.jsxs("p",{className:s("text-xs mt-1",a.text.tertiary),children:["Paid: ",h(t.paymentDate)]})]}),e.jsx("button",{className:s("p-2 rounded-lg transition-colors","text-gray-400 hover:text-gray-600 hover:bg-gray-100","dark:hover:text-gray-300 dark:hover:bg-white/10"),children:e.jsx(q,{className:"w-4 h-4"})})]})]})},t.id))})]}),m==="delayed"&&c&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:s("text-xl font-semibold",a.text.primary),children:["Delayed Payments (",c.summary.totalDelayed,")"]}),e.jsx("div",{className:s("px-4 py-2 rounded-lg","bg-red-100 dark:bg-red-900/30"),children:e.jsxs("p",{className:s("text-sm font-medium","text-red-800 dark:text-red-200"),children:["Total: ",d(c.summary.totalAmount)]})})]}),e.jsx("div",{className:"space-y-4",children:c.data.map((t,r)=>e.jsx("div",{className:s("p-6 rounded-xl border-2","border-red-200 bg-red-50 dark:border-red-800/50 dark:bg-red-900/20"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:s("font-medium",a.text.primary),children:t.orderId}),e.jsxs("p",{className:s("text-sm",a.text.secondary),children:[t.provider," â€¢ ",t.facility]}),e.jsxs("p",{className:s("text-xs mt-1","text-red-600 dark:text-red-400"),children:[t.daysDelayed," days overdue â€¢ ",t.reason]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:s("font-semibold text-lg",a.text.primary),children:d(t.amount)}),e.jsxs("p",{className:s("text-xs",a.text.tertiary),children:["Due: ",h(t.originalDueDate)]})]})]})},r))})]}),m==="analytics"&&o&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:s("text-xl font-semibold",a.text.primary),children:"Performance Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:s("p-6 rounded-xl border",n==="dark"?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:[e.jsx("h4",{className:s("font-medium mb-4",a.text.primary),children:"Monthly Targets"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:s("text-sm",a.text.secondary),children:"Target"}),e.jsx("span",{className:s("font-medium",a.text.primary),children:d(o.monthlyTargets.currentMonthTarget)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:s("text-sm",a.text.secondary),children:"Actual"}),e.jsx("span",{className:s("font-medium",a.text.primary),children:d(o.monthlyTargets.currentMonthActual)})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 dark:bg-gray-700",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${Math.min(o.monthlyTargets.achievementPercentage,100)}%`}})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:s("text-lg font-bold",a.text.primary),children:[o.monthlyTargets.achievementPercentage.toFixed(1),"%"]}),e.jsx("span",{className:s("text-sm ml-1",a.text.secondary),children:"achievement"})]})]})]}),e.jsxs("div",{className:s("p-6 rounded-xl border",n==="dark"?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:[e.jsx("h4",{className:s("font-medium mb-4",a.text.primary),children:"Top Providers"}),e.jsx("div",{className:"space-y-3",children:o.topProviders.slice(0,5).map((t,r)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:s("text-sm font-medium",a.text.primary),children:["Provider #",t.providerId]}),e.jsxs("p",{className:s("text-xs",a.text.tertiary),children:[t.orderCount," orders"]})]}),e.jsx("span",{className:s("font-medium",a.text.primary),children:d(t.totalCommission)})]},r))})]})]})]})]})]})]})]})}export{te as default};
