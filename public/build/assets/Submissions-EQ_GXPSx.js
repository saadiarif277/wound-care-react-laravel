import{r,j as e,S as c}from"./app-CkbwHOkf.js";import{M as i}from"./MainLayout-DIjIBnGe.js";import{F as n,a as f,b as w,c as v,e as L,f as A}from"./index-R2fUhcwH.js";import{a as O}from"./api-CXAezOed.js";import"./glass-theme-CCnqi7lL.js";import"./x-CCCTsVjU.js";import"./createLucideIcon-HYdXrwBu.js";import"./triangle-alert-D2zL4pqG.js";import"./check-DXIgFk-v.js";function K({auth:R}){const[x,b]=r.useState([]),[S,o]=r.useState(!0),[m,h]=r.useState(null),[l,_]=r.useState({totalSubmissions:0,pendingSignatures:0,completedToday:0,overdue:0}),d=async()=>{o(!0),h(null);try{const a=(await O.get("/api/docuseal/submissions")).data.map(s=>{var u,p,j,N,y;return{id:s.id,order_number:((u=s.order)==null?void 0:u.order_number)||"Unknown Order",document_type:s.document_type,status:s.status,created_at:s.created_at,completed_at:s.completed_at,signer_name:((j=(p=s.order)==null?void 0:p.provider)==null?void 0:j.name)||"Unknown Signer",signer_email:((y=(N=s.order)==null?void 0:N.provider)==null?void 0:y.email)||"unknown@email.com",signing_url:s.signing_url,download_url:s.download_url}});b(a);const F=a.length,E=a.filter(s=>s.status==="pending").length,M=new Date().toDateString(),T=a.filter(s=>s.status==="completed"&&s.completed_at&&new Date(s.completed_at).toDateString()===M).length,$=a.filter(s=>s.status==="overdue").length;_({totalSubmissions:F,pendingSignatures:E,completedToday:T,overdue:$})}catch(t){h(t instanceof Error?t.message:"Failed to fetch submissions"),console.error("Error fetching Docuseal submissions:",t)}finally{o(!1)}};r.useEffect(()=>{d()},[]);const k=t=>{switch(t){case"completed":return e.jsx(w,{className:"w-5 h-5 text-green-500"});case"pending":return e.jsx(f,{className:"w-5 h-5 text-yellow-500"});case"overdue":return e.jsx(v,{className:"w-5 h-5 text-red-500"});default:return e.jsx(n,{className:"w-5 h-5 text-gray-500"})}},D=t=>{const a="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(t){case"completed":return`${a} bg-green-100 text-green-800`;case"pending":return`${a} bg-yellow-100 text-yellow-800`;case"overdue":return`${a} bg-red-100 text-red-800`;case"expired":return`${a} bg-gray-100 text-gray-800`;case"cancelled":return`${a} bg-red-100 text-red-800`;default:return`${a} bg-gray-100 text-gray-800`}},C=async t=>{try{window.open(`/api/docuseal/submissions/${t}/download`,"_blank")}catch(a){console.error("Error downloading document:",a),alert("Failed to download document. Please try again.")}},g=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return S?e.jsxs(i,{children:[e.jsx(c,{title:"Document Management"}),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading document submissions..."})]})})]}):m?e.jsxs(i,{children:[e.jsx(c,{title:"Document Management"}),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-lg mb-4",children:"Error loading submissions"}),e.jsx("div",{className:"text-gray-600 mb-4",children:m}),e.jsx("button",{onClick:d,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Try Again"})]})})]}):e.jsxs(i,{children:[e.jsx(c,{title:"Document Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Document Management"}),e.jsx("p",{className:"text-gray-500",children:"Manage and track document signatures for orders"})]}),e.jsxs("button",{onClick:d,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 flex items-center gap-2",children:[e.jsx(n,{className:"w-4 h-4"}),"Refresh"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(n,{className:"h-8 w-8 text-blue-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Submissions"}),e.jsx("dd",{className:"text-2xl font-semibold text-gray-900",children:l.totalSubmissions})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(f,{className:"h-8 w-8 text-yellow-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending Signatures"}),e.jsx("dd",{className:"text-2xl font-semibold text-gray-900",children:l.pendingSignatures})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(w,{className:"h-8 w-8 text-green-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Completed Today"}),e.jsx("dd",{className:"text-2xl font-semibold text-gray-900",children:l.completedToday})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(v,{className:"h-8 w-8 text-red-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Overdue"}),e.jsx("dd",{className:"text-2xl font-semibold text-gray-900",children:l.overdue})]})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Document Submissions"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Latest document signing requests and their status"})]}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order / Document"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Signer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Completed"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[k(t.status),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.order_number}),e.jsx("div",{className:"text-sm text-gray-500",children:t.document_type})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.signer_name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.signer_email})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:D(t.status),children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g(t.created_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.completed_at?g(t.completed_at):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[t.status==="completed"&&t.download_url&&e.jsxs("button",{onClick:()=>C(t.id),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[e.jsx(L,{className:"w-4 h-4 mr-1"}),"Download"]}),t.signing_url&&t.status==="pending"&&e.jsxs("a",{href:t.signing_url,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:text-green-900 flex items-center",children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"Sign"]})]})})]},t.id))})]})}),x.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(n,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"No document submissions found"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Document submissions will appear here when orders are processed."})]})]})]})]})]})}export{K as default};
