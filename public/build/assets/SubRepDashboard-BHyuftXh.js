import{u as O,r as x,j as e,S as D}from"./app-CkbwHOkf.js";import{M as F}from"./MainLayout-DIjIBnGe.js";import{c as s,t as B}from"./glass-theme-CCnqi7lL.js";import{M as o}from"./MetricCard-D38A2XjP.js";import{a as T}from"./api-CXAezOed.js";import{d as E,m as G,k as z,a4 as m,B as J,x as W,z as q,at as H}from"./index-R2fUhcwH.js";import"./x-CCCTsVjU.js";import"./createLucideIcon-HYdXrwBu.js";import"./triangle-alert-D2zL4pqG.js";import"./check-DXIgFk-v.js";function le({user:I,auth:U}){var g,j,y,f,N,w,v,k,S,C,P,R;const{theme:d}=O(),t=B[d],[_,p]=x.useState(!0),[r,A]=x.useState(null),[l,L]=x.useState(null),[h,M]=x.useState([]),[c,u]=x.useState({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),b=async()=>{p(!0);try{const[a,i]=await Promise.all([T.salesReps.getCommissionSummary({date_from:c.start,date_to:c.end}),T.salesReps.getCommissionDetails({date_from:c.start,date_to:c.end,per_page:5})]);A(a),M(i.data||[]),L({name:"Sarah Johnson",territory:"Northeast Region",splitPercentage:50})}catch(a){console.error("Error fetching sub-rep dashboard data:",a)}finally{p(!1)}};x.useEffect(()=>{b()},[c]);const n=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),Y=a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),$=a=>{const i="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";switch(a.toLowerCase()){case"paid":return`${i} bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300`;case"pending":return`${i} bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300`;case"approved":return`${i} bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300`;default:return`${i} bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300`}};return _?e.jsxs(F,{children:[e.jsx(D,{title:"Sub-Rep Dashboard"}),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(E,{className:"animate-spin h-8 w-8 mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:s("text-lg",t.text.secondary),children:"Loading your dashboard..."})]})})]}):e.jsxs(F,{children:[e.jsx(D,{title:"Sub-Rep Dashboard"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:s("text-3xl font-bold",t.text.primary),children:"Sub-Rep Dashboard"}),e.jsxs("p",{className:s("text-sm",t.text.secondary),children:["Welcome back, ",U.user.first_name,"! Track your commission splits and performance."]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:s("w-4 h-4",t.text.secondary)}),e.jsx("input",{type:"date",value:c.start,onChange:a=>u(i=>({...i,start:a.target.value})),className:s("px-3 py-2 text-sm rounded-lg border",d==="dark"?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-gray-900")}),e.jsx("span",{className:s("text-sm",t.text.secondary),children:"to"}),e.jsx("input",{type:"date",value:c.end,onChange:a=>u(i=>({...i,end:a.target.value})),className:s("px-3 py-2 text-sm rounded-lg border",d==="dark"?"bg-white/10 border-white/20 text-white":"bg-white border-gray-300 text-gray-900")})]}),e.jsxs("button",{onClick:b,className:"flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:"Refresh"})]})]})]}),l&&e.jsx("div",{className:s("rounded-2xl p-6 border-2 backdrop-blur-xl",d==="dark"?"bg-blue-500/10 border-blue-500/20":"bg-blue-50 border-blue-200"),children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(z,{className:"w-6 h-6 text-white"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:s("text-lg font-semibold",t.text.primary),children:"Parent Representative"}),e.jsxs("p",{className:s("text-sm mt-1",t.text.secondary),children:[l.name," • ",l.territory]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{className:s("text-sm font-medium",t.text.primary),children:["Your Split: ",l.splitPercentage,"%"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{className:s("text-sm",t.text.secondary),children:["Parent Split: ",100-l.splitPercentage,"%"]})]})]})]})]})}),r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(o,{title:"My Commission Share",value:n(((g=r.totals)==null?void 0:g.paid)||0),icon:e.jsx(J,{}),status:"success",subtitle:"From split arrangements"}),e.jsx(o,{title:"Parent Rep Earnings",value:n((((j=r.totals)==null?void 0:j.paid)||0)*(100-((l==null?void 0:l.splitPercentage)||50))/100),icon:e.jsx(W,{}),status:"info",subtitle:"Their portion of splits"}),e.jsx(o,{title:"Total Generated",value:n((((y=r.totals)==null?void 0:y.paid)||0)*2),icon:e.jsx(q,{}),status:"default",subtitle:"Combined commission value"}),e.jsx(o,{title:"Commission Rate",value:`${(l==null?void 0:l.splitPercentage)||50}%`,icon:e.jsx(m,{}),status:"warning",subtitle:"Your split percentage"})]}),e.jsxs("div",{className:s("rounded-2xl backdrop-blur-xl border-2",d==="dark"?"bg-white/[0.08] border-white/10":"bg-white/90 border-gray-200/50"),children:[e.jsxs("div",{className:"p-6 border-b border-gray-200/20",children:[e.jsx("h3",{className:s("text-xl font-semibold",t.text.primary),children:"Recent Commission Activity"}),e.jsx("p",{className:s("text-sm mt-1",t.text.secondary),children:"Your share of commission splits from orders"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:h.length>0?h.map(a=>{var i;return e.jsx("div",{className:s("p-4 rounded-xl border transition-all hover:shadow-lg",d==="dark"?"bg-white/5 border-white/10 hover:bg-white/10":"bg-white border-gray-200 hover:shadow-md"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h4",{className:s("font-medium",t.text.primary),children:a.orderId||a.id}),e.jsx("span",{className:$(a.status),children:a.status}),a.split&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",children:["Split: ",a.split.subRepPercentage,"%"]})]}),e.jsxs("p",{className:s("text-sm mt-1",t.text.secondary),children:[a.providerName||"Unknown Provider"," • ",((i=a.product)==null?void 0:i.name)||"Product"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("p",{className:s("text-xs",t.text.tertiary),children:["Service: ",a.dateOfService?Y(a.dateOfService):"No date"]}),a.split&&e.jsxs("p",{className:s("text-xs",t.text.tertiary),children:["Total Commission: ",n((a.split.repAmount||0)+(a.split.subRepAmount||0))]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:s("font-semibold text-lg",t.text.primary),children:n(a.commissionAmount||0)}),e.jsx("p",{className:s("text-xs",t.text.secondary),children:"Your Share"}),a.split&&e.jsxs("p",{className:s("text-xs",t.text.tertiary),children:["Parent: ",n(a.split.repAmount||0)]})]})]})},a.id)}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(H,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:s("text-lg",t.text.secondary),children:"No commission activity yet"}),e.jsx("p",{className:s("text-sm",t.text.tertiary),children:"Commission splits will appear here as orders are processed"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:s("p-6 rounded-xl border",d==="dark"?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:[e.jsx("h4",{className:s("font-medium mb-4",t.text.primary),children:"Split Performance"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:s("text-sm",t.text.secondary),children:"Your Earnings"}),e.jsx("span",{className:s("font-medium",t.text.primary),children:n(((f=r==null?void 0:r.totals)==null?void 0:f.paid)||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:s("text-sm",t.text.secondary),children:"Parent Rep Earnings"}),e.jsx("span",{className:s("font-medium",t.text.primary),children:n((((N=r==null?void 0:r.totals)==null?void 0:N.paid)||0)*(100-((l==null?void 0:l.splitPercentage)||50))/100)})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:s("text-sm font-medium",t.text.primary),children:"Total Generated"}),e.jsx("span",{className:s("font-bold text-lg",t.text.primary),children:n((((w=r==null?void 0:r.totals)==null?void 0:w.paid)||0)*2)})]})})]})]}),e.jsxs("div",{className:s("p-6 rounded-xl border",d==="dark"?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:[e.jsx("h4",{className:s("font-medium mb-4",t.text.primary),children:"Commission Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:s("text-sm",t.text.secondary),children:"Paid Commissions"}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",children:((k=(v=r==null?void 0:r.byStatus)==null?void 0:v.paid)==null?void 0:k.count)||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:s("text-sm",t.text.secondary),children:"Pending Payments"}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300",children:((C=(S=r==null?void 0:r.byStatus)==null?void 0:S.pending)==null?void 0:C.count)||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:s("text-sm",t.text.secondary),children:"Processing"}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",children:((R=(P=r==null?void 0:r.byStatus)==null?void 0:P.processing)==null?void 0:R.count)||0})]})]})]})]})]})]})}export{le as default};
