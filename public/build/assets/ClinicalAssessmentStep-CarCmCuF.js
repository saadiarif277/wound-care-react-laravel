import{r as p,j as e}from"./app-BIIu6Vfg.js";import I from"./WoundCareAssessmentForm-PKUwrrtM.js";import T from"./PulmonaryWoundAssessmentForm-DhabWbOw.js";import E from"./VascularAssessmentForm-h8fLrhy8.js";import{b as P,h as q}from"./api-DeF3cPfH.js";import{I as N}from"./info-BXTOTKbd.js";import{C as O}from"./circle-alert-B0UQsGk9.js";import{C as R}from"./chevron-right-jA_0CRkX.js";import{L as V}from"./loader-circle-BAVJtHey.js";import"./upload-DiaHG5g8.js";import"./createLucideIcon-BEFA6UwU.js";const c={DIAGNOSIS:"ssp_checklist_diagnosis",LAB_RESULTS:"ssp_checklist_lab_results",WOUND_DESCRIPTION:"ssp_checklist_wound",CIRCULATION:"ssp_checklist_circulation",CONSERVATIVE_TREATMENT:"ssp_checklist_conservative"},J=({formData:i,updateFormData:h,userSpecialty:y="wound_care_specialty"})=>{const r=y==="pulmonology"?"pulmonary_wound":y==="vascular_surgery"||i.wound_type==="arterial_ulcer"?"vascular":"wound_care",b=()=>r==="wound_care"?c.DIAGNOSIS:r==="pulmonary_wound"?"pulmonary_history":c.DIAGNOSIS,[n,g]=p.useState(b()),[m,v]=p.useState({}),[S,_]=p.useState(!1);p.useEffect(()=>{g(b())},[r]);const f=(()=>{switch(r){case"wound_care":return[{id:c.DIAGNOSIS,label:"Diagnosis (SSP)",required:!0},{id:c.LAB_RESULTS,label:"Lab Results (SSP)",required:!0},{id:c.WOUND_DESCRIPTION,label:"Wound Description (SSP)",required:!0},{id:c.CIRCULATION,label:"Circulation (SSP)",required:!0},{id:c.CONSERVATIVE_TREATMENT,label:"Conservative Measures (SSP)",required:!0}];case"pulmonary_wound":return[{id:"pulmonary_history",label:"Pulmonary History",required:!0},{id:"wound_details",label:"Wound Assessment (Pulm)",required:!0},{id:"tissue_oxygenation",label:"Tissue Oxygenation",required:!0},{id:"conservative_care",label:"Conservative Care (Pulm)",required:!0},{id:"coordinated_care",label:"Coordinated Care Planning",required:!1}];case"vascular":return[{id:"wound_details",label:"Wound Assessment (Vasc)",required:!0},{id:"vascular_evaluation",label:"Vascular Studies",required:!0},{id:"conservative_care",label:"Conservative Care (Vasc)",required:!0},{id:"lab_results",label:"Laboratory Values (Vasc)",required:!1}];default:return[]}})(),w=async s=>{_(!0);try{let t={};const a=String(s);r==="wound_care"?t=i.clinical_data||{}:t=i[`legacy_${s}`]||{};const o=await P("/api/v1/validation-builder/validate-section",{section:a,data:t,wound_type:i.wound_type,assessment_type:r}),d=await q(o);d.errors?v(u=>({...u,[a]:d.errors})):v(u=>{const l={...u};return delete l[a],l})}catch(t){console.error("Validation error:",t)}finally{_(!1)}},C=(s,t)=>{h({clinical_data:{...i.clinical_data||{},[s]:t}})},j=s=>{if(r==="wound_care"){const t=s,a=i.clinical_data&&t in i.clinical_data?i.clinical_data[t]:null;if(typeof a!="object"||a===null)return 0;const o=Object.keys(a);if(o.length===0)return 0;let d=0;for(const u of o){const l=a[u];let x=!0;(l===null||l===""||l===void 0)&&(x=!1),Array.isArray(l)&&l.length===0&&(x=!1),typeof l=="object"&&!Array.isArray(l)&&l!==null&&Object.keys(l).length===0&&(x=!1),x&&d++}return Math.round(d/o.length*100)}return 0},A=()=>{if(r==="wound_care")return e.jsx(I,{formData:i.clinical_data||{},activeSection:n,handleChange:C,validationErrors:m,parentWoundType:i.wound_type});if(r==="pulmonary_wound"||r==="vascular"){const s=i[`legacy_${n}`]||{},t=r==="pulmonary_wound"?T:E;return e.jsx(t,{formData:s,updateClinicalData:a=>h({[`legacy_${n}`]:a}),activeSection:n,validationErrors:m[n]?{[n]:m[n]}:{}})}return e.jsx("div",{children:"Select an assessment type or section."})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-4",children:"Clinical Assessment"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Complete the clinical assessment based on your specialty and the patient's wound type. Required sections must be completed before proceeding."})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(N,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-blue-900",children:[r==="pulmonary_wound"&&"Pulmonary & Wound Care Assessment",r==="vascular"&&"Vascular Surgery Assessment",r==="wound_care"&&"Skin Substitute Pre-Application Checklist"]}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"This assessment has been selected based on your specialty and the patient's condition."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("nav",{className:"space-y-1",children:f.map(s=>{var o;const t=j(s.id),a=((o=m[s.id])==null?void 0:o.length)>0;return e.jsx("button",{onClick:()=>{g(s.id),w(s.id)},className:`w-full text-left px-3 py-2 rounded-md transition-colors ${n===s.id?"bg-blue-50 text-blue-700 border-l-4 border-blue-700":"text-gray-600 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium",children:s.label}),s.required&&e.jsx("span",{className:"text-xs text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[a&&e.jsx(O,{className:"h-4 w-4 text-red-500"}),t>0&&e.jsxs("span",{className:`text-xs ${t===100?"text-green-600":"text-gray-500"}`,children:[t,"%"]}),e.jsx(R,{className:`h-4 w-4 ${n===s.id?"text-blue-700":"text-gray-400"}`})]})]})},s.id)})}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Overall Progress"}),e.jsx("div",{className:"space-y-2",children:f.map(s=>{const t=j(s.id);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:s.label}),e.jsxs("span",{children:[t,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${t===100?"bg-green-600":"bg-blue-600"}`,style:{width:`${t}%`}})})]},s.id)})})]})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 relative",children:[S&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-10 rounded-lg",children:e.jsx(V,{className:"h-8 w-8 text-blue-600 animate-spin"})}),A()]})})]}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(N,{className:"h-5 w-5 text-yellow-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-900",children:"MSC Assist Available"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Need help? MSC Assist can provide real-time guidance for completing the clinical assessment based on your wound type and payer requirements."})]})]})})]})};export{J as default};
