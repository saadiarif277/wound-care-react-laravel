import{u as D,X as V,r as j,j as e}from"./app-CkbwHOkf.js";import{c as I,ad as O,k as J,E as q,F as $,v as G,S as C,a3 as E,s as X,B as K,ae as W,a as L,p as Q,q as Y,b as Z}from"./index-R2fUhcwH.js";import{t as R}from"./glass-theme-CCnqi7lL.js";import{c as t}from"./utils-J8bI0sT-.js";import{c as S}from"./index-JQJDRhvj.js";import"./clsx-B-dksMZM.js";const f=(r,o)=>{const c=o.filter(u=>!u.split(".").reduce((s,h)=>s==null?void 0:s[h],r));return c.length===0?{icon:"complete",color:"green",message:"Complete"}:c.length<=2?{icon:"warning",color:"yellow",message:`Missing: ${c.join(", ")}`}:{icon:"error",color:"red",message:`${c.length} fields missing`}};function de({orderId:r,isPreSubmission:o=!0,onEdit:c,onSubmit:u}){var A;const{theme:v="dark"}=D(),s=R[v],{auth:h}=V().props,l=((A=h==null?void 0:h.user)==null?void 0:A.role)||"provider",[a,U]=j.useState(null),[_,F]=j.useState(!0),[m,B]=j.useState(new Set(["patient","clinical","products"])),[M,N]=j.useState(!1),[y,b]=j.useState(""),[w,P]=j.useState(!1);j.useEffect(()=>{k()},[r]);const k=async()=>{try{F(!0);const n=await(await fetch(`/api/v1/orders/${r}/review`)).json();U(n)}catch(i){console.error("Error loading order data:",i),S.error("Failed to load order details")}finally{F(!1)}},x=i=>{const n=new Set(m);n.has(i)?n.delete(i):n.add(i),B(n)},H=async()=>{if(y.trim()){P(!0);try{await fetch(`/api/v1/orders/${r}/notes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({note:y})}),await new Promise(i=>setTimeout(i,1e3)),S.success("Order submitted successfully with note!"),b(""),N(!1),k()}catch(i){console.error("Submission error:",i),S.error("Failed to submit order. Please try again.")}finally{P(!1)}}},T=()=>{if(!a)return!1;const i=!!(a.patient.demographics.firstName&&a.patient.demographics.lastName&&a.patient.demographics.dateOfBirth&&a.patient.insurance.primary.policyNumber),n=!!(a.clinical.wound.type&&a.clinical.wound.size&&a.clinical.diagnoses.primary.code),d=a.products.length>0,g=a.forms.ivr.status==="complete";return i&&n&&d&&g};return _?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a?e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:t("p-6 rounded-lg flex justify-between items-start",s.glass.card),children:[e.jsxs("div",{children:[e.jsxs("h1",{className:t("text-2xl font-bold",s.text.primary),children:["Order Review - #",a.orderId]}),e.jsxs("p",{className:t("text-sm mt-1",s.text.secondary),children:["Status: ",e.jsx("span",{className:"font-medium capitalize",children:a.status.replace("_"," ")})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:o&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>N(!0),className:t("px-4 py-2 rounded-lg flex items-center space-x-2",s.glass.frost,"hover:bg-white/10 transition-colors"),children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Note"})]}),e.jsx("button",{onClick:()=>N(!0),disabled:!T(),className:t("px-6 py-2 rounded-lg font-medium transition-all",T()?`${s.button.primary.base} ${s.button.primary.hover}`:"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Submit Order"})]})})]}),e.jsx(p,{title:"Patient & Insurance",icon:e.jsx(J,{}),status:f(a.patient,["demographics.firstName","demographics.lastName","demographics.dateOfBirth","insurance.primary.policyNumber"]),expanded:m.has("patient"),onToggle:()=>x("patient"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:t("font-medium mb-3",s.text.primary),children:"Patient Information"}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Name:"}),e.jsxs("dd",{className:s.text.primary,children:[a.patient.demographics.firstName," ",a.patient.demographics.middleName," ",a.patient.demographics.lastName," ",a.patient.demographics.suffix]})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"DOB:"}),e.jsx("dd",{className:s.text.primary,children:a.patient.demographics.dateOfBirth})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Gender:"}),e.jsx("dd",{className:s.text.primary,children:a.patient.demographics.gender})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Phone:"}),e.jsxs("dd",{className:s.text.primary,children:[a.patient.demographics.phone,a.patient.demographics.phoneType&&` (${a.patient.demographics.phoneType})`]})]}),a.patient.demographics.email&&e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Email:"}),e.jsx("dd",{className:s.text.primary,children:a.patient.demographics.email})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Address:"}),e.jsxs("dd",{className:s.text.primary,children:[a.patient.demographics.address.line1,a.patient.demographics.address.line2&&e.jsxs(e.Fragment,{children:[", ",a.patient.demographics.address.line2]}),e.jsx("br",{}),a.patient.demographics.address.city,", ",a.patient.demographics.address.state," ",a.patient.demographics.address.zip]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:t("font-medium mb-3",s.text.primary),children:"Insurance Coverage"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:t("text-sm font-medium mb-2",s.text.secondary),children:"Primary Insurance"}),e.jsxs("dl",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-32",s.text.secondary),children:"Payer:"}),e.jsx("dd",{className:s.text.primary,children:a.patient.insurance.primary.payerName})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-32",s.text.secondary),children:"Plan:"}),e.jsx("dd",{className:s.text.primary,children:a.patient.insurance.primary.planName})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-32",s.text.secondary),children:"Policy #:"}),e.jsx("dd",{className:s.text.primary,children:a.patient.insurance.primary.policyNumber})]}),a.patient.insurance.primary.groupNumber&&e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-32",s.text.secondary),children:"Group #:"}),e.jsx("dd",{className:s.text.primary,children:a.patient.insurance.primary.groupNumber})]})]}),a.patient.insurance.primary.cardImages&&e.jsxs("div",{className:"mt-2 flex space-x-2",children:[a.patient.insurance.primary.cardImages.front&&e.jsx("button",{className:t("text-xs text-blue-400 hover:text-blue-300 underline cursor-pointer",s.text.secondary),children:"View Card Front"}),a.patient.insurance.primary.cardImages.back&&e.jsx("button",{className:t("text-xs text-blue-400 hover:text-blue-300 underline cursor-pointer",s.text.secondary),children:"View Card Back"})]})]}),a.patient.insurance.secondary&&e.jsxs("div",{children:[e.jsx("h5",{className:t("text-sm font-medium mb-2",s.text.secondary),children:"Secondary Insurance"}),e.jsxs("dl",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-32",s.text.secondary),children:"Payer:"}),e.jsx("dd",{className:s.text.primary,children:a.patient.insurance.secondary.payerName})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-32",s.text.secondary),children:"Policy #:"}),e.jsx("dd",{className:s.text.primary,children:a.patient.insurance.secondary.policyNumber})]})]})]})]})]})}),(l!=="order_manager"||!o)&&e.jsx(p,{title:"Provider Information",icon:e.jsx(q,{}),status:f(a.provider,["name","npi"]),expanded:m.has("provider"),onToggle:()=>x("provider"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Name:"}),e.jsxs("dd",{className:s.text.primary,children:[a.provider.name,a.provider.credentials&&`, ${a.provider.credentials}`]})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"NPI:"}),e.jsx("dd",{className:s.text.primary,children:a.provider.npi})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Organization:"}),e.jsx("dd",{className:s.text.primary,children:a.provider.organization})]})]}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[a.provider.department&&e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Department:"}),e.jsx("dd",{className:s.text.primary,children:a.provider.department})]}),a.provider.contact.phone&&e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Phone:"}),e.jsx("dd",{className:s.text.primary,children:a.provider.contact.phone})]}),a.provider.contact.email&&e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Email:"}),e.jsx("dd",{className:s.text.primary,children:a.provider.contact.email})]})]})]})}),e.jsx(p,{title:"Clinical Information",icon:e.jsx(G,{}),status:f(a.clinical,["wound.type","wound.size","wound.location","diagnoses.primary.code"]),expanded:m.has("clinical"),onToggle:()=>x("clinical"),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:t("font-medium mb-3",s.text.primary),children:"Wound Assessment"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Type:"}),e.jsx("dd",{className:s.text.primary,children:a.clinical.wound.type})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Location:"}),e.jsx("dd",{className:s.text.primary,children:a.clinical.wound.location})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Size:"}),e.jsxs("dd",{className:s.text.primary,children:[a.clinical.wound.size.length," × ",a.clinical.wound.size.width," × ",a.clinical.wound.size.depth," cm"]})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Duration:"}),e.jsx("dd",{className:s.text.primary,children:a.clinical.wound.duration})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:t("text-sm font-medium mb-2",s.text.secondary),children:"Treatment History"}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-40",s.text.secondary),children:"Prior Applications:"}),e.jsx("dd",{className:s.text.primary,children:a.clinical.treatmentHistory.priorApplications})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-40",s.text.secondary),children:"Anticipated Applications:"}),e.jsx("dd",{className:s.text.primary,children:a.clinical.treatmentHistory.anticipatedApplications})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-40",s.text.secondary),children:"Conservative Care:"}),e.jsxs("dd",{className:s.text.primary,children:[a.clinical.treatmentHistory.conservativeCare.duration,e.jsx("br",{}),e.jsx("span",{className:"text-xs",children:a.clinical.treatmentHistory.conservativeCare.types.join(", ")})]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:t("font-medium mb-3",s.text.primary),children:"Diagnoses"}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("dt",{className:t("font-medium mb-1",s.text.secondary),children:"Primary ICD-10:"}),e.jsxs("dd",{className:s.text.primary,children:[a.clinical.diagnoses.primary.code," - ",a.clinical.diagnoses.primary.description]})]}),a.clinical.diagnoses.secondary.length>0&&e.jsxs("div",{children:[e.jsx("dt",{className:t("font-medium mb-1",s.text.secondary),children:"Secondary ICD-10s:"}),e.jsx("dd",{className:s.text.primary,children:a.clinical.diagnoses.secondary.map((i,n)=>e.jsxs("div",{className:"ml-4",children:[i.code," - ",i.description]},n))})]})]})]}),a.clinical.clinicalJustification&&e.jsxs("div",{children:[e.jsx("h4",{className:t("font-medium mb-2",s.text.primary),children:"Clinical Justification"}),e.jsx("p",{className:t("text-sm",s.text.secondary),children:a.clinical.clinicalJustification})]}),a.clinical.documents.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:t("font-medium mb-3",s.text.primary),children:"Supporting Documentation"}),e.jsx("div",{className:"space-y-2",children:a.clinical.documents.map(i=>e.jsx("div",{className:t("flex items-center justify-between p-3 rounded-lg",s.glass.frost),children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx($,{className:t("w-5 h-5",s.text.secondary)}),e.jsxs("div",{children:[e.jsx("p",{className:t("text-sm font-medium",s.text.primary),children:i.name}),e.jsxs("p",{className:t("text-xs",s.text.secondary),children:[i.type," • ",(i.size/1024/1024).toFixed(2)," MB • Uploaded ",new Date(i.uploadDate).toLocaleDateString()]})]})]})},i.id))})]})]})}),e.jsx(p,{title:"Product Selection",icon:e.jsx(X,{}),status:f({products:a.products},["products"]),expanded:m.has("products"),onToggle:()=>x("products"),children:e.jsx("div",{className:"space-y-4",children:a.products.map((i,n)=>e.jsx("div",{className:t("p-4 rounded-lg",s.glass.frost),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:t("font-medium",s.text.primary),children:i.name}),e.jsxs("p",{className:t("text-sm mt-1",s.text.secondary),children:[i.manufacturer," • SKU: ",i.sku]}),e.jsx("div",{className:"mt-3 space-y-1",children:i.sizes.map((d,g)=>e.jsxs("div",{className:t("text-sm",s.text.secondary),children:[e.jsxs("span",{className:"font-medium",children:["Size ",d.size,":"]})," ",d.quantity," units",l!=="order_manager"&&d.totalPrice&&e.jsxs("span",{className:"ml-2",children:["• $",d.totalPrice.toFixed(2)]})]},g))})]}),i.coverageAlerts&&i.coverageAlerts.length>0&&e.jsx("div",{className:"ml-4 space-y-2",children:i.coverageAlerts.map((d,g)=>e.jsxs("div",{className:t("flex items-start space-x-2 text-sm p-2 rounded",d.type==="error"&&"bg-red-500/20 text-red-400",d.type==="warning"&&"bg-yellow-500/20 text-yellow-400",d.type==="info"&&"bg-blue-500/20 text-blue-400"),children:[d.type==="error"&&e.jsx(C,{className:"w-4 h-4 mt-0.5"}),d.type==="warning"&&e.jsx(E,{className:"w-4 h-4 mt-0.5"}),d.type==="info"&&e.jsx(I,{className:"w-4 h-4 mt-0.5"}),e.jsx("span",{children:d.message})]},g))})]})},n))})}),l!=="order_manager"&&a.pricing&&e.jsx(p,{title:"Pricing Details",icon:e.jsx(K,{}),status:{icon:"complete",color:"green",message:"Complete"},expanded:m.has("pricing"),onToggle:()=>x("pricing"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("dl",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:t("font-medium",s.text.secondary),children:"ASP Total:"}),e.jsxs("dd",{className:t("font-medium",s.text.primary),children:["$",a.pricing.aspTotal.toFixed(2)]})]}),a.pricing.discount&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{className:t("font-medium",s.text.secondary),children:"Discount:"}),e.jsxs("dd",{className:t("font-medium text-green-500"),children:["-$",a.pricing.discount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-3",children:[e.jsx("dt",{className:t("font-medium",s.text.primary),children:"Net Price:"}),e.jsxs("dd",{className:t("font-bold text-lg",s.text.primary),children:["$",a.pricing.netPrice.toFixed(2)]})]})]}),a.pricing.patientResponsibility!==void 0&&e.jsxs("div",{className:t("p-4 rounded-lg",s.glass.frost),children:[e.jsx("h5",{className:t("text-sm font-medium mb-2",s.text.secondary),children:"Patient Responsibility"}),e.jsxs("p",{className:t("text-2xl font-bold",s.text.primary),children:["$",a.pricing.patientResponsibility.toFixed(2)]}),e.jsx("p",{className:t("text-xs mt-1",s.text.tertiary),children:"Estimated based on coverage"})]})]})}),e.jsx(p,{title:"Forms Status",icon:e.jsx($,{}),status:f(a.forms,["ivr"]),expanded:m.has("forms"),onToggle:()=>x("forms"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:t("p-4 rounded-lg",s.glass.frost),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:t("font-medium",s.text.primary),children:"IVR Form"}),e.jsx(z,{status:a.forms.ivr.status})]}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[a.forms.ivr.completionDate&&e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Completed:"}),e.jsx("dd",{className:s.text.primary,children:new Date(a.forms.ivr.completionDate).toLocaleDateString()})]}),a.forms.ivr.expirationDate&&e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Expires:"}),e.jsx("dd",{className:s.text.primary,children:new Date(a.forms.ivr.expirationDate).toLocaleDateString()})]})]}),e.jsx("div",{className:"mt-4 flex space-x-2",children:a.forms.ivr.documentUrl&&e.jsx("a",{href:a.forms.ivr.documentUrl,target:"_blank",rel:"noopener noreferrer",className:t("px-4 py-2 rounded text-sm flex items-center space-x-1",s.glass.frost,"hover:bg-white/10"),children:e.jsx("span",{children:"View PDF"})})})]}),e.jsxs("div",{className:t("p-4 rounded-lg",s.glass.frost),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:t("font-medium",s.text.primary),children:"Order Form"}),e.jsx(z,{status:a.forms.order.status})]}),e.jsx("dl",{className:"space-y-2 text-sm",children:a.forms.order.completionDate&&e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-24",s.text.secondary),children:"Signed:"}),e.jsx("dd",{className:s.text.primary,children:new Date(a.forms.order.completionDate).toLocaleDateString()})]})}),e.jsx("div",{className:"mt-4 flex space-x-2",children:a.forms.order.documentUrl&&e.jsx("a",{href:a.forms.order.documentUrl,target:"_blank",rel:"noopener noreferrer",className:t("px-4 py-2 rounded text-sm flex items-center space-x-1",s.glass.frost,"hover:bg-white/10"),children:e.jsx("span",{children:"View PDF"})})})]})]})}),e.jsx(p,{title:"Shipping Information",icon:e.jsx(W,{}),status:{icon:"complete",color:"green",message:"Complete"},expanded:m.has("shipping"),onToggle:()=>x("shipping"),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:t("text-sm font-medium mb-2",s.text.secondary),children:"Delivery Address"}),a.shipping.sameAsPatient?e.jsx("p",{className:t("text-sm",s.text.primary),children:"Same as patient address"}):a.shipping.address?e.jsxs("address",{className:t("text-sm not-italic",s.text.primary),children:[a.shipping.address.line1,a.shipping.address.line2&&e.jsxs(e.Fragment,{children:[", ",a.shipping.address.line2]}),e.jsx("br",{}),a.shipping.address.city,", ",a.shipping.address.state," ",a.shipping.address.zip]}):null]}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-32",s.text.secondary),children:"Expected Date:"}),e.jsx("dd",{className:s.text.primary,children:new Date(a.shipping.expectedDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-32",s.text.secondary),children:"Shipping Method:"}),e.jsx("dd",{className:s.text.primary,children:a.shipping.method})]}),a.shipping.trackingNumber&&e.jsxs("div",{className:"flex",children:[e.jsx("dt",{className:t("font-medium w-32",s.text.secondary),children:"Tracking #:"}),e.jsx("dd",{className:t(s.text.primary,"text-blue-400 hover:text-blue-300 underline cursor-pointer"),children:a.shipping.trackingNumber})]})]}),a.shipping.specialInstructions&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h4",{className:t("text-sm font-medium mb-2",s.text.secondary),children:"Special Instructions"}),e.jsx("p",{className:t("text-sm",s.text.primary),children:a.shipping.specialInstructions})]})]})}),a.notes&&a.notes.length>0&&e.jsx(p,{title:"Internal Notes",icon:e.jsx(O,{}),expanded:m.has("notes"),onToggle:()=>x("notes"),children:e.jsx("div",{className:"space-y-3",children:a.notes.map(i=>e.jsxs("div",{className:t("p-3 rounded-lg",s.glass.frost),children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("p",{className:t("text-sm font-medium",s.text.primary),children:i.user}),e.jsx("time",{className:t("text-xs",s.text.secondary),children:new Date(i.timestamp).toLocaleString()})]}),e.jsx("p",{className:t("text-sm",s.text.secondary),children:i.note})]},i.id))})}),l==="admin"&&a.audit&&e.jsx(p,{title:"Audit Log",icon:e.jsx(L,{}),expanded:m.has("audit"),onToggle:()=>x("audit"),children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:t("border-b",`border-${s.glass.border}`),children:[e.jsx("th",{className:t("text-left py-2 px-3",s.text.secondary),children:"Timestamp"}),e.jsx("th",{className:t("text-left py-2 px-3",s.text.secondary),children:"User"}),e.jsx("th",{className:t("text-left py-2 px-3",s.text.secondary),children:"Action"}),e.jsx("th",{className:t("text-left py-2 px-3",s.text.secondary),children:"Details"})]})}),e.jsx("tbody",{children:a.audit.map((i,n)=>e.jsxs("tr",{className:t("border-b",`border-${s.glass.border}`),children:[e.jsx("td",{className:t("py-2 px-3",s.text.primary),children:new Date(i.timestamp).toLocaleString()}),e.jsx("td",{className:t("py-2 px-3",s.text.primary),children:i.user}),e.jsx("td",{className:t("py-2 px-3",s.text.primary),children:i.action}),e.jsx("td",{className:t("py-2 px-3",s.text.secondary),children:i.details||"-"})]},n))})]})})}),M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:t("bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",s.glass.card),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:t("text-lg font-semibold",s.text.primary),children:"Add Admin Note & Submit Order"}),e.jsx("button",{onClick:()=>{N(!1),b("")},className:t("p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",s.text.secondary),children:e.jsx(C,{className:"w-5 h-5"})})]}),e.jsx("p",{className:t("text-sm mb-4",s.text.secondary),children:"Please add an admin note before submitting the order:"}),e.jsx("textarea",{value:y,onChange:i=>b(i.target.value),placeholder:"Enter your admin note here...",className:t("w-full h-32 p-3 rounded-lg resize-none mb-4",s.input.base,s.input.focus)}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{N(!1),b("")},className:t("px-4 py-2 rounded-lg",s.button.secondary.base,s.button.secondary.hover),disabled:w,children:"Cancel"}),e.jsx("button",{onClick:H,disabled:!y.trim()||w,className:t("px-4 py-2 rounded-lg font-medium",y.trim()&&!w?`${s.button.primary.base} ${s.button.primary.hover}`:"bg-gray-300 text-gray-500 cursor-not-allowed"),children:w?"Submitting...":"Submit Order with Note"})]})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(I,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:s.text.secondary,children:"Order not found"})]})}function p({title:r,icon:o,status:c,expanded:u,onToggle:v,children:s}){const{theme:h="dark"}=D(),l=R[h];return e.jsxs("div",{className:t("rounded-lg overflow-hidden",l.glass.card),children:[e.jsxs("div",{className:t("px-6 py-4 flex items-center justify-between cursor-pointer","hover:bg-white/5 transition-colors"),onClick:v,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:t("text-xl",l.text.secondary),children:o}),e.jsx("h3",{className:t("text-lg font-semibold",l.text.primary),children:r}),c&&e.jsx(ee,{status:c})]}),e.jsx("div",{className:"flex items-center space-x-3",children:u?e.jsx(Q,{className:t("w-5 h-5",l.text.secondary)}):e.jsx(Y,{className:t("w-5 h-5",l.text.secondary)})})]}),u&&e.jsx("div",{className:t("px-6 pb-6 border-t",`border-${l.glass.border}`),children:e.jsx("div",{className:"mt-4",children:s})})]})}function ee({status:r}){const o={complete:e.jsx(Z,{className:"w-5 h-5"}),warning:e.jsx(E,{className:"w-5 h-5"}),error:e.jsx(C,{className:"w-5 h-5"}),pending:e.jsx(L,{className:"w-5 h-5"})},c={green:"text-green-500",yellow:"text-yellow-500",red:"text-red-500",gray:"text-gray-500"};return e.jsxs("div",{className:t("flex items-center space-x-2",c[r.color]),children:[o[r.icon],e.jsx("span",{className:"text-sm",children:r.message})]})}function z({status:r}){const{theme:o="dark"}=D(),c=()=>{switch(r){case"complete":return"bg-green-500/20 text-green-400";case"in_progress":return"bg-yellow-500/20 text-yellow-400";case"expired":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}};return e.jsx("span",{className:t("px-2 py-1 rounded text-xs font-medium",c()),children:r.replace("_"," ").charAt(0).toUpperCase()+r.slice(1).replace("_"," ")})}export{de as default};
