import{j as t,S as K,r as m,A as u,c as p}from"./app-CkbwHOkf.js";import{M as z}from"./MainLayout-DIjIBnGe.js";import W from"./PatientInsuranceSection-CLeU8OWm.js";import X from"./ProductSection-Puw9Ku87.js";import{I as Z}from"./IVRDocumentSection-r0KY9anU.js";import ee from"./ClinicalSection-BP4srsuD.js";import te from"./ProviderSection-c5hESdVb.js";import se from"./AdditionalDocumentsSection-BKwFPMC0.js";import ie from"./ManufacturerSubmissionModal-739mrq2p.js";import{A as ae}from"./arrow-left-CnUTEFlg.js";import"./glass-theme-CCnqi7lL.js";import"./x-CCCTsVjU.js";import"./createLucideIcon-HYdXrwBu.js";import"./triangle-alert-D2zL4pqG.js";import"./check-DXIgFk-v.js";import"./index-R2fUhcwH.js";import"./SectionCard-DXpRq2Tu.js";import"./card-I35nyvuT.js";import"./utils-J8bI0sT-.js";import"./clsx-B-dksMZM.js";import"./collapsible-BfCXG3XD.js";import"./index-DdQWWdLt.js";import"./index-DW48STyt.js";import"./index-CD7V_8Mq.js";import"./index-De90F09_.js";import"./index-BsB1_LdS.js";import"./index-COQ4n3Z8.js";import"./index-BrKfa2YN.js";import"./index-CHViK9kl.js";import"./index-CHrZSOeV.js";import"./chevron-up-CAFyUi5R.js";import"./chevron-down-BQSbFUOw.js";import"./InfoRow-Cw2QKNb8.js";import"./user-CeKBNj6z.js";import"./calendar-CU3MSIjO.js";import"./phone-Cep3yv4K.js";import"./mail-BWwpRcgy.js";import"./map-pin-DGRcBcWO.js";import"./credit-card-DRvf_b2i.js";import"./package-C3D73aJ6.js";import"./truck-Bx0mry60.js";import"./Button-BFsoRR4y.js";import"./StatusUpdateModal-CDBCQPSg.js";import"./clock-BCNbb55_.js";import"./circle-alert-D5RtSiPV.js";import"./circle-check-big-BZwOB0cM.js";import"./loader-circle-CzGXBM_P.js";import"./eye-2c1yoxJs.js";import"./download-Dw1sq69C.js";import"./file-text-3MfHY30h.js";import"./Button-2TyLRw72.js";import"./index-Dp3B9jqt.js";import"./DocusealEmbed-DHc16Xlt.js";import"./index.esm-DpsOu67m.js";import"./card-mI4OQcp1.js";import"./index-DNM8Gtkt.js";import"./api-CXAezOed.js";import"./chevron-right-BB6IVksD.js";import"./upload-D34_G3qK.js";import"./trash-2-N2vmfG2C.js";import"./send-Cwgt1rCK.js";import"./heart-DxydAzba.js";import"./shield-DtxW4kzs.js";import"./file-BrP07e8W.js";const ht=({order:e,can_update_status:ne,can_view_ivr:re,userRole:l="Admin",roleRestrictions:ce,navigationRoute:d})=>{var f,x,g,h,b,y,v,j,N,S,w,D,O,I,A,k,F,T,P,R,C,M,U,$,B,L,V,E;if(console.log("OrderDetails Debug:",{order:e,hasPatient:!!e.patient,patientName:(f=e.patient)==null?void 0:f.name,hasInsurance:!!e.insurance,hasClinical:!!e.clinical,hasProduct:!!e.product,orderKeys:Object.keys(e),patientKeys:e.patient?Object.keys(e.patient):null,insuranceKeys:e.insurance?Object.keys(e.insurance):null,clinicalKeys:e.clinical?Object.keys(e.clinical):null,productKeys:e.product?Object.keys(e.product):null}),!e.patient||!e.insurance||!e.clinical||!e.product)return t.jsxs(z,{children:[t.jsx(K,{title:"Order Details - Error"}),t.jsx("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:t.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Error Loading Order Details"}),t.jsx("p",{className:"text-red-700",children:"The order data could not be loaded. Please try refreshing the page or contact support."}),e.error_message&&t.jsxs("div",{className:"mt-2 text-red-700",children:[t.jsx("strong",{children:"Backend Error:"})," ",e.error_message]}),t.jsxs("div",{className:"mt-4 p-4 bg-gray-100 rounded text-sm",children:[t.jsx("p",{className:"font-semibold",children:"Debug Information:"}),t.jsxs("p",{children:["Order ID: ",e.id]}),t.jsxs("p",{children:["Order Number: ",e.order_number]}),t.jsxs("p",{children:["Has Patient: ",e.patient?"Yes":"No"]}),t.jsxs("p",{children:["Has Insurance: ",e.insurance?"Yes":"No"]}),t.jsxs("p",{children:["Has Clinical: ",e.clinical?"Yes":"No"]}),t.jsxs("p",{children:["Has Product: ",e.product?"Yes":"No"]}),t.jsxs("p",{children:["Order Keys: ",Object.keys(e).join(", ")]})]}),t.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Refresh Page"})]})})]});const[r,H]=m.useState({patient:!0,product:!0,ivrDocument:!0,clinical:!0,provider:!0,documents:!0}),[Y,_]=m.useState(!1),[n,a]=m.useState(null),q=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",c=s=>{H(i=>({...i,[s]:!i[s]}))},G=async s=>{try{const i=await p.post(`/admin/orders/${e.id}/change-status`,{status:s.status,status_type:"ivr",notes:s.comments,rejection_reason:s.rejectionReason,send_notification:s.sendNotification});if(i.status===200)a({type:"success",message:"IVR status updated successfully!"}),setTimeout(()=>{window.location.reload()},1e3);else{const o=i.data;a({type:"error",message:o.error||"Failed to update IVR status"})}}catch{a({type:"error",message:"Failed to update IVR status. Please try again."})}setTimeout(()=>a(null),5e3)},J=async s=>{try{const i=await p.post(`/admin/orders/${e.id}/change-status`,{status:s.status,status_type:"order",notes:s.comments,rejection_reason:s.rejectionReason,cancellation_reason:s.cancellationReason,send_notification:s.sendNotification,carrier:s.carrier,tracking_number:s.trackingNumber});if(i.status===200)a({type:"success",message:"Order form status updated successfully!"}),setTimeout(()=>{window.location.reload()},1e3);else{const o=i.data;a({type:"error",message:o.error||"Failed to update order form status"})}}catch{a({type:"error",message:"Failed to update order form status. Please try again."})}setTimeout(()=>a(null),5e3)},Q=async s=>{try{const i=await p.post(`/admin/orders/${e.id}/change-status`,{status:"submitted_to_manufacturer",status_type:"order",notes:s.specialInstructions,send_notification:s.sendNotification,carrier:s.carrier,tracking_number:s.trackingNumber,shipping_info:{carrier:s.carrier,tracking_number:s.trackingNumber,shipping_address:s.shippingAddress,shipping_contact:s.shippingContact,shipping_phone:s.shippingPhone,shipping_email:s.shippingEmail,special_instructions:s.specialInstructions}});if(i.status===200)a({type:"success",message:"Order submitted to manufacturer successfully!"}),setTimeout(()=>{window.location.reload()},1e3);else{const o=i.data;a({type:"error",message:o.error||"Failed to submit to manufacturer"})}}catch{a({type:"error",message:"Failed to submit to manufacturer. Please try again."})}setTimeout(()=>a(null),5e3)};return t.jsxs(z,{children:[t.jsx(K,{title:`Order Details - ${e.order_number}`}),t.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[t.jsx("button",{onClick:()=>{d?u.get(route(d)):l==="Admin"?u.get(route("admin.orders.index")):u.get(route("dashboard"))},className:"p-2 rounded-lg bg-gray-200 hover:bg-gray-300",children:t.jsx(ae,{className:"h-4 w-4"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[t.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Order Details"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1 ${e.ivr_status==="verified"?"text-green-600 bg-green-100":e.ivr_status==="sent"?"text-blue-600 bg-blue-100":e.ivr_status==="rejected"?"text-red-600 bg-red-100":"text-yellow-600 bg-yellow-100"}`,children:["IVR: ",e.ivr_status||"Pending"]}),t.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1 ${e.order_form_status==="confirmed_by_manufacturer"?"text-green-600 bg-green-100":e.order_form_status==="submitted_to_manufacturer"?"text-blue-600 bg-blue-100":e.order_form_status==="rejected"?"text-red-600 bg-red-100":"text-yellow-600 bg-yellow-100"}`,children:["Order: ",e.order_form_status||"Pending"]})]})]}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[t.jsxs("span",{children:["Order #",e.order_number]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:["Created ",q(e.created_at)]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:["By ",e.provider_name]})]})]})]}),t.jsx(W,{orderData:{orderNumber:e.order_number,createdDate:e.created_at,createdBy:e.provider_name,patient:{...e.patient,dob:((x=e.patient)==null?void 0:x.dob)||"N/A",gender:((g=e.patient)==null?void 0:g.gender)||"N/A",phone:((h=e.patient)==null?void 0:h.phone)||"N/A",address:((b=e.patient)==null?void 0:b.address)||"N/A",insurance:{primary:((v=(y=e.insurance)==null?void 0:y.primary)==null?void 0:v.name)||"N/A",secondary:((N=(j=e.insurance)==null?void 0:j.secondary)==null?void 0:N.name)||"N/A"}},insurance:{primary:((w=(S=e.insurance)==null?void 0:S.primary)==null?void 0:w.name)||"N/A",secondary:((O=(D=e.insurance)==null?void 0:D.secondary)==null?void 0:O.name)||"N/A",primaryPlanType:(A=(I=e.insurance)==null?void 0:I.primary)==null?void 0:A.planType,secondaryPlanType:(F=(k=e.insurance)==null?void 0:k.secondary)==null?void 0:F.planType},product:e.product,forms:{ivrStatus:e.ivr_status,orderFormStatus:e.order_form_status},clinical:e.clinical,provider:e.provider,submission:{documents:e.documents}},isOpen:r.patient,onToggle:()=>c("patient")}),t.jsx(X,{orderData:{orderNumber:e.order_number,createdDate:e.created_at,createdBy:e.provider_name,patient:e.patient,product:{...e.product,shippingInfo:{speed:((P=(T=e.product)==null?void 0:T.shippingInfo)==null?void 0:P.speed)||"standard",address:((R=e.facility)==null?void 0:R.address)||"N/A"}},orderPreferences:{expectedServiceDate:e.expected_service_date,shippingSpeed:(M=(C=e.product)==null?void 0:C.shippingInfo)==null?void 0:M.speed,placeOfService:e.place_of_service_display,deliveryInstructions:($=(U=e.product)==null?void 0:U.shippingInfo)==null?void 0:$.instructions},forms:{ivrStatus:e.ivr_status,orderFormStatus:e.order_form_status},clinical:e.clinical,provider:e.provider,submission:{documents:e.documents},total_amount:e.total_order_value},userRole:l,isOpen:r.product,onToggle:()=>c("product")}),t.jsx(Z,{ivrData:{status:e.ivr_status||"N/A",sentDate:e.created_at,resultsReceivedDate:"",verifiedDate:"",notes:"",resultsFileUrl:"",files:e.documents||[],ivrDocumentUrl:e.ivr_document_url,docusealSubmissionId:e.docuseal_submission_id,alteredIvrFile:e.altered_ivr_file_path?{name:e.altered_ivr_file_name||"Uploaded IVR File",url:e.altered_ivr_file_url||"",uploadedAt:e.altered_ivr_uploaded_at||"",uploadedBy:e.altered_ivr_uploaded_by_name||"Admin"}:void 0},orderFormData:{status:e.order_form_status||"N/A",submissionDate:e.created_at,reviewDate:"",approvalDate:"",notes:"",fileUrl:"",files:e.documents||[],carrier:e.carrier||"",trackingNumber:e.tracking_number||"",shippingInfo:e.shipping_info||{},alteredOrderFormFile:e.altered_order_form_file_path?{name:e.altered_order_form_file_name||"Uploaded Order Form File",url:e.altered_order_form_file_url||"",uploadedAt:e.altered_order_form_uploaded_at||"",uploadedBy:e.altered_order_form_uploaded_by_name||"Admin"}:void 0},orderId:e.id,onUpdateIVRStatus:G,onUploadIVRResults:()=>{},onUpdateOrderFormStatus:J,onManufacturerSubmission:()=>_(!0),isOpen:r.ivrDocument,onToggle:()=>c("ivrDocument"),userRole:l,orderData:{order_number:e.order_number,manufacturer_name:e.manufacturer_name,manufacturer_id:(B=e.product)==null?void 0:B.manufacturerId,patient_name:e.patient_name,patient_email:(L=e.patient)==null?void 0:L.email,integration_email:"integration@mscwoundcare.com",episode_id:e.episode_id?parseInt(e.episode_id):void 0}}),t.jsx(ee,{orderData:{orderNumber:e.order_number,createdDate:e.created_at,createdBy:e.provider_name,patient:e.patient,product:e.product,forms:{ivrStatus:e.ivr_status,orderFormStatus:e.order_form_status},clinical:{...e.clinical,location:((V=e.clinical)==null?void 0:V.woundLocation)||"N/A",cptCodes:"N/A",placeOfService:e.place_of_service_display||"N/A",serviceDate:e.expected_service_date,failedConservativeTreatment:((E=e.clinical)==null?void 0:E.failedConservativeTreatment)||!1},provider:e.provider,submission:{documents:e.documents}},isOpen:r.clinical,onToggle:()=>c("clinical")}),t.jsx(te,{orderData:{orderNumber:e.order_number,createdDate:e.created_at,createdBy:e.provider_name,patient:e.patient,product:e.product,forms:{ivrStatus:e.ivr_status,orderFormStatus:e.order_form_status},clinical:e.clinical,provider:e.provider,facility:e.facility,submission:{documents:e.documents}},isOpen:r.provider,onToggle:()=>c("provider")}),t.jsx(se,{documents:e.documents||[],isOpen:r.documents,onToggle:()=>c("documents")}),t.jsx(ie,{isOpen:Y,onClose:()=>_(!1),onConfirm:Q,orderId:e.id.toString(),orderNumber:e.order_number,manufacturerName:e.manufacturer_name}),n&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:t.jsxs("div",{className:`max-w-md w-full mx-4 p-6 rounded-lg shadow-xl ${n.type==="success"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${n.type==="success"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`,children:n.type==="success"?t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:`text-lg font-semibold ${n.type==="success"?"text-green-800":"text-red-800"}`,children:n.type==="success"?"Success!":"Error!"}),t.jsx("p",{className:`text-sm ${n.type==="success"?"text-green-700":"text-red-700"}`,children:n.message})]})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx("button",{onClick:()=>a(null),className:`px-4 py-2 rounded-md text-sm font-medium ${n.type==="success"?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700"}`,children:"OK"})})]})})]})]})};export{ht as default};
