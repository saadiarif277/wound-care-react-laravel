import{r as N,j as e,S as w,x as b,A as a}from"./app-taSqzBVs.js";import{M as v}from"./MainLayout-Dw1zk4VW.js";import{P as _}from"./ProductSelector-BEVwGyjl.js";import{A as C}from"./arrow-left-BSwrl-I8.js";import{S as P}from"./send-IIfrl1Bx.js";import{C as S}from"./check-B1Sfkp9P.js";import{X as k}from"./x-tQL0mm7-.js";import{U as A}from"./user-B0WZowAG.js";import{c as R}from"./createLucideIcon-CJpMkWaB.js";import{S as F}from"./shield-XPCAJ_io.js";import{C as c}from"./circle-check-big-DWcFwiCQ.js";import{C as l}from"./circle-alert-bbAHQg3k.js";import{C as d}from"./clock-DGAz1RbJ.js";import{T as I}from"./triangle-alert-BOyfSih_.js";import{P as $}from"./package-D_7tl1nz.js";import{B as z}from"./building-D2y99HfC.js";import{F as T}from"./file-text-C8Kw-BdM.js";import"./index-BQkVVL-M.js";import"./PricingDisplay-DjaHDh0i.js";import"./filter-rlwyksCG.js";import"./search-C3KyOaD2.js";import"./info-iZYwc2zJ.js";import"./shopping-cart-DHQkLuvm.js";import"./plus-DnTY2fSz.js";import"./trending-up-D-MxD9_4.js";import"./tag-DLVHPd2q.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=R("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]),ne=({request:s,roleRestrictions:i})=>{var n,m,x;const[o,h]=N.useState(((n=s.products)==null?void 0:n.map(t=>({product_id:t.id,quantity:t.quantity,size:t.size})))||[]),p=t=>{switch(t){case"draft":return"bg-gray-100 text-gray-800";case"submitted":return"bg-blue-100 text-blue-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"processing":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},g=t=>{switch(t){case"approved":return e.jsx(c,{className:"w-4 h-4"});case"processing":return e.jsx(d,{className:"w-4 h-4"});case"rejected":return e.jsx(l,{className:"w-4 h-4"});default:return e.jsx(T,{className:"w-4 h-4"})}},r=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),u=t=>{h(t),console.log("Products updated:",t)},j=()=>{confirm("Are you sure you want to submit this request for review?")&&a.post(`/product-requests/${s.id}/submit`,{},{onSuccess:()=>{a.visit("/product-requests")}})},y=()=>{confirm("Are you sure you want to approve this request?")&&a.post(`/product-requests/${s.id}/approve`,{notify_provider:!0},{onSuccess:()=>{a.reload()}})},f=()=>{confirm("Are you sure you want to reject this request?")&&a.post(`/product-requests/${s.id}/reject`,{reason:"Request does not meet clinical criteria",category:"clinical",notify_provider:!0},{onSuccess:()=>{a.reload()}})};return e.jsxs(v,{children:[e.jsx(w,{title:`Product Request ${s.request_number}`}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${p(s.order_status)}`,children:[g(s.order_status),e.jsx("span",{className:"ml-1 capitalize",children:s.order_status})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Step ",s.step,": ",s.step_description]})]})}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(b,{href:"/product-requests",className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(C,{className:"w-4 h-4 mr-1"}),"Back to Product Requests"]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[s.order_status==="draft"&&e.jsxs("button",{onClick:j,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Submit for Review"]}),i.can_approve_requests&&s.order_status==="submitted"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:y,className:"inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Approve"]}),e.jsxs("button",{onClick:f,className:"inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Reject"]})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.request_number}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Created on ",s.created_at]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(A,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Patient Information"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Patient ID"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.patient_display})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Wound Type"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.wound_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Expected Service Date"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.expected_service_date})]})]})]}),s.clinical_summary&&e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(E,{className:"w-5 h-5 text-indigo-600 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Clinical Assessment"})]}),e.jsxs("div",{className:"space-y-4",children:[s.clinical_summary.wound_characteristics&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Wound Characteristics"}),e.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:e.jsx("pre",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:JSON.stringify(s.clinical_summary.wound_characteristics,null,2)})})]}),s.clinical_summary.conservative_care_provided&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Conservative Care"}),e.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:e.jsx("pre",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:JSON.stringify(s.clinical_summary.conservative_care_provided,null,2)})})]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(F,{className:"w-5 h-5 text-purple-600 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Validation & Eligibility"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"MAC Validation"}),e.jsxs("div",{className:"flex items-center mt-1",children:[s.mac_validation_status==="passed"?e.jsx(c,{className:"w-4 h-4 text-green-500 mr-1"}):s.mac_validation_status==="failed"?e.jsx(l,{className:"w-4 h-4 text-red-500 mr-1"}):e.jsx(d,{className:"w-4 h-4 text-gray-400 mr-1"}),e.jsx("span",{className:`text-sm ${s.mac_validation_status==="passed"?"text-green-600":s.mac_validation_status==="failed"?"text-red-600":"text-gray-600"}`,children:s.mac_validation_status||"Pending"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Eligibility Status"}),e.jsxs("div",{className:"flex items-center mt-1",children:[s.eligibility_status==="eligible"?e.jsx(c,{className:"w-4 h-4 text-green-500 mr-1"}):s.eligibility_status==="ineligible"?e.jsx(l,{className:"w-4 h-4 text-red-500 mr-1"}):e.jsx(d,{className:"w-4 h-4 text-gray-400 mr-1"}),e.jsx("span",{className:`text-sm ${s.eligibility_status==="eligible"?"text-green-600":s.eligibility_status==="ineligible"?"text-red-600":"text-gray-600"}`,children:s.eligibility_status||"Pending"})]})]}),s.pre_auth_required&&e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-center text-sm text-amber-600 bg-amber-50 p-2 rounded-md",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Prior Authorization Required"]})})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-5 h-5 text-indigo-600 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Current Products"})]}),s.total_amount&&e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["Total: ",r(s.total_amount)]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Q-Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Size"}),i.can_view_financials&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(m=s.products)==null?void 0:m.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.name}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["Q",t.q_code]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.quantity}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.size?`${t.size} cmÂ²`:"-"}),i.can_view_financials&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r(t.unit_price)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:r(t.total_price)})]})]},t.id))})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(z,{className:"w-5 h-5 text-green-600 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Facility & Payer"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Facility"}),e.jsx("p",{className:"text-sm text-gray-900",children:((x=s.facility)==null?void 0:x.name)||"No facility"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Payer"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.payer_name})]})]})]}),s.order_status==="draft"&&e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"AI-Powered Product Recommendations"}),e.jsx(_,{selectedProducts:o,onProductsChange:u,recommendationContext:s.wound_type,productRequestId:s.id,roleRestrictions:i,showCart:!0,title:"Clinical Product Recommendations",description:"AI-enhanced recommendations tailored to this patient's specific clinical needs"})]})]})]})]})})]})};export{ne as default};
