import{r as l,j as e}from"./app-BIIu6Vfg.js";const h=({onConnectionChange:t})=>{const[s,c]=l.useState(null),[o,a]=l.useState(!0),[d,n]=l.useState(!1),m=async()=>{try{a(!0);const r=await fetch("/api/ecw/status",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(r.ok){const i=await r.json();c(i),t==null||t(i.connected)}else c({connected:!1,error:"Failed to check status"}),t==null||t(!1)}catch(r){console.error("Failed to check eCW connection status:",r),c({connected:!1,error:"Connection check failed"}),t==null||t(!1)}finally{a(!1)}},x=async()=>{try{n(!0);const r=await fetch("/api/ecw/test",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(r.ok){const i=await r.json();c(i),t==null||t(i.connected)}}catch(r){console.error("Failed to test eCW connection:",r)}finally{n(!1)}},u=async()=>{if(confirm("Are you sure you want to disconnect from eClinicalWorks?"))try{(await fetch("/api/ecw/disconnect",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"})).ok&&(c({connected:!1}),t==null||t(!1))}catch(r){console.error("Failed to disconnect from eCW:",r)}};return l.useEffect(()=>{m()},[]),o?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-gray-600",children:"Checking eClinicalWorks connection..."})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"eClinicalWorks Integration"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s!=null&&s.connected?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:`text-sm font-medium ${s!=null&&s.connected?"text-green-600":"text-red-600"}`,children:s!=null&&s.connected?"Connected":"Disconnected"})]})]}),s!=null&&s.connected?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-green-800",children:"Successfully connected to eClinicalWorks"}),e.jsx("div",{className:"mt-2 text-sm text-green-700",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:["Environment: ",e.jsx("span",{className:"font-medium",children:s.environment})]}),s.scope&&e.jsxs("li",{children:["Permissions: ",e.jsx("span",{className:"font-medium",children:s.scope})]}),e.jsxs("li",{children:["Status: ",e.jsx("span",{className:"font-medium",children:"Active"})]})]})})]})})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:x,disabled:d,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600 mr-2"}),"Testing..."]}):"Test Connection"}),e.jsx("button",{onClick:u,className:"inline-flex items-center px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Disconnect"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Connect to eClinicalWorks"}),e.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[e.jsx("p",{children:"Connect your account to access patient data from eClinicalWorks EHR system."}),(s==null?void 0:s.error)&&e.jsxs("p",{className:"mt-1 text-red-600",children:["Error: ",s.error]})]})]})})}),e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"What you'll get access to:"}),e.jsxs("ul",{className:"mt-2 text-sm text-blue-700 list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Patient demographics and contact information"}),e.jsx("li",{children:"Medical observations and vital signs"}),e.jsx("li",{children:"Clinical documents and notes"}),e.jsx("li",{children:"FHIR-compliant data exchange"})]})]})}),e.jsxs("a",{href:"/api/ecw/auth",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx("svg",{className:"-ml-1 mr-3 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Connect to eClinicalWorks"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("p",{children:"This will redirect you to eClinicalWorks for secure authentication."}),e.jsx("p",{children:"Your credentials are never stored by our application."})]})]})]})};export{h as E};
