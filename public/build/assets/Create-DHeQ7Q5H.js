import{u as I,j as e,X as $,r as w,S as z,A as R}from"./app-CkbwHOkf.js";import{M as q}from"./MainLayout-DIjIBnGe.js";import J from"./ProductSelectionStep-CSDSwwch.js";import X from"./ClinicalAssessmentStep-DGzyZXBX.js";import Y from"./ValidationEligibilityStep-B8xGN4lB.js";import Z from"./ClinicalOpportunitiesStep-DXUQLwoz.js";import K from"./PatientInformationStep-Dsu9dNsi.js";import{t as v,c as s}from"./glass-theme-CCnqi7lL.js";import{G as M}from"./GlassCard-BHIy-LS3.js";import{B as y}from"./Button-BFsoRR4y.js";import{H as Q}from"./Heading-YIpyfRLf.js";import{C as T}from"./check-DXIgFk-v.js";import{A as ee}from"./arrow-left-CnUTEFlg.js";import{A as te}from"./arrow-right-vtpcnF9X.js";import"./x-CCCTsVjU.js";import"./createLucideIcon-HYdXrwBu.js";import"./triangle-alert-D2zL4pqG.js";import"./index-R2fUhcwH.js";import"./PricingDisplay-ByqrDOhf.js";import"./filter-CvtIixAT.js";import"./search-B4qCXP-m.js";import"./sparkles-BQwFiKbn.js";import"./clock-BCNbb55_.js";import"./circle-alert-D5RtSiPV.js";import"./info-BO4HO_Ur.js";import"./circle-check-big-BZwOB0cM.js";import"./shopping-cart-m-uzUl6t.js";import"./package-C3D73aJ6.js";import"./plus-BtW8yxxf.js";import"./trending-up-Cr1DgAyN.js";import"./tag-CJrfyk9z.js";import"./building-DoOXZ5F-.js";import"./WoundCareAssessmentForm-CJyRdDq3.js";import"./upload-D34_G3qK.js";import"./PulmonaryWoundAssessmentForm-C-o7iXfo.js";import"./stethoscope-DH_Dpbte.js";import"./heart-DxydAzba.js";import"./VascularAssessmentForm-42UehH3-.js";import"./activity-Dw7iipAt.js";import"./api-CXAezOed.js";import"./chevron-right-BB6IVksD.js";import"./loader-circle-CzGXBM_P.js";import"./index-JQJDRhvj.js";import"./file-text-3MfHY30h.js";import"./shield-DtxW4kzs.js";import"./dollar-sign-BlJ6QvEN.js";import"./GoogleAddressAutocompleteWithFallback-BRtGVwRb.js";import"./map-pin-DGRcBcWO.js";import"./clsx-B-dksMZM.js";const se=({formData:x,onSubmit:d,isSubmitting:f=!1,errors:m={}})=>{let g="dark",b=v.dark;try{g=I().theme,b=v[g]}catch{}return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:s("p-6 rounded-lg",b.glass.card),children:[e.jsx("h3",{className:s("text-lg font-medium mb-4",b.text.primary),children:"Review and Submit"}),e.jsxs("div",{className:s("text-sm",b.text.secondary),children:[e.jsx("p",{className:"mb-4",children:"Please review your product request details before submitting."}),x&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Patient:"})," ",x.patient_name||"Not specified"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Product:"})," ",x.product_name||"Not specified"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Facility:"})," ",x.facility_name||"Not specified"]})]}),Object.keys(m).length>0&&e.jsxs("div",{className:s("mt-4 p-4 rounded border",g==="dark"?"bg-red-900/20 border-red-800":"bg-red-50 border-red-200"),children:[e.jsx("h4",{className:s("font-medium mb-2",g==="dark"?"text-red-300":"text-red-800"),children:"Please fix the following errors:"}),e.jsx("ul",{className:s("text-sm space-y-1",g==="dark"?"text-red-400":"text-red-700"),children:Object.entries(m).map(([h,i])=>e.jsxs("li",{children:["• ",i]},h))})]})]}),d&&e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:d,disabled:f,className:s("px-6 py-3 rounded-lg font-medium transition-all",f?"opacity-50 cursor-not-allowed":"hover:shadow-lg","bg-gradient-to-r from-green-500 to-green-600 text-white"),children:f?"Submitting...":"Submit Product Request"})})]})})},re={patientName:"",dateOfBirth:"",dateOfProcedure:"",hasDiabetes:!1,hasVenousStasisUlcer:!1,hasPressureUlcer:!1,location:"",ulcerLocation:"",depth:"partial-thickness",ulcerDuration:"",length:0,width:0,woundDepth:0,hasInfection:!1,hasNecroticTissue:!1,hasCharcotDeformity:!1,hasMalignancy:!1,hasTriphasicWaveforms:!1,debridementPerformed:!1,moistDressingsApplied:!1,nonWeightBearing:!1,pressureReducingFootwear:!1,standardCompression:!1,currentHbot:!1,smokingStatus:"non-smoker",receivingRadiationOrChemo:!1,takingImmuneModulators:!1,hasAutoimmuneDiagnosis:!1},Qe=({woundTypes:x,facilities:d,userFacilityId:f,userSpecialty:m="wound_care_specialty",prefillData:g})=>{var F,A,O;const{props:b}=$(),h=b.userRole||"provider";let i="dark",o=v.dark;try{i=I().theme,o=v[i]}catch{}if(h!=="provider"&&h!=="office_manager")return e.jsx(q,{title:"Access Denied",children:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(M,{variant:"error",className:"max-w-md",children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("h1",{className:s("text-2xl font-bold mb-4",i==="dark"?"text-red-400":"text-red-600"),children:"Access Denied"}),e.jsx("p",{className:o.text.secondary,children:"You do not have permission to create a product request."})]})})})});const[n,N]=w.useState(1),[r,k]=w.useState({patient_api_input:{first_name:"",last_name:"",dob:""},facility_id:Number(f)||((F=d[0])!=null&&F.id?Number(d[0].id):1),place_of_service:"",medicare_part_b_authorized:!1,expected_service_date:"",payer_name:"",payer_id:"",second_payer:"",shipping_speed:"",wound_type:"",clinical_data:re,selected_products:[]}),[C,S]=w.useState({totalFields:0,completedFields:0,fieldCompletion:{}}),p=[{id:1,name:"Patient Information",description:"Capture patient demographics and payer information"},{id:2,name:"Clinical Assessment",description:"Document wound-specific clinical data with dynamic forms"},{id:3,name:"Product Selection",description:"Intelligent product recommendations based on clinical context"},{id:4,name:"Validation & Eligibility",description:"Real-time MAC validation and insurance eligibility checking"},{id:5,name:"Clinical Opportunities",description:"Identify additional billable services using COE"},{id:6,name:"Review & Submit",description:"Final review with comprehensive summary"}],E=()=>{n<p.length&&N(n+1)},U=()=>{n>1&&N(n-1)},V=t=>{const a=B(m),l={};let u=0;return a.forEach(c=>{const j=W(t,c);l[c]=j,j&&u++}),{totalFields:a.length,completedFields:u,fieldCompletion:l}},B=t=>{const a=["ulcerLocation","ulcerDuration","depth"],l={wound_care_specialty:["length","width"],vascular_surgery:["length","width","hasTriphasicWaveforms"],pulmonology:["length","width","hasDiabetes"]};return[...a,...l[t]||[]]},W=(t,a)=>{switch(a){case"length":case"width":return typeof t[a]=="number"&&t[a]>0;case"hasTriphasicWaveforms":case"hasDiabetes":return t[a]!==void 0;default:return!!t[a]}},_=t=>{k(a=>{const l={...a,...t};if(t.clinical_data){const u=V({...a.clinical_data,...t.clinical_data});l.clinical_assessment_progress=u,S(u)}return l})},P=async()=>{try{const t={...r.patient_api_input},{clinical_assessment_progress:a,...l}=r,u=await R.post("/product-requests",{...l,patient_api_input:t,order_status:"submitted",submit_immediately:!0},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{R.visit("/product-requests",{replace:!0})},onError:c=>{if(console.error("❌ Error creating and submitting product request:",c),c&&typeof c=="object"){const j=Object.values(c).flat();alert(`Validation errors: ${j.join(", ")}`)}else alert("An error occurred while submitting the form. Please try again.")}})}catch(t){console.error("❌ An unexpected error occurred during form submission:",t),alert("An unexpected error occurred. Please try again or contact support.")}},D=t=>{switch(t){case 1:return!!(r.patient_api_input.first_name&&r.patient_api_input.last_name&&r.patient_api_input.dob&&r.patient_api_input.member_id&&r.place_of_service&&r.expected_service_date&&r.payer_name&&r.shipping_speed&&r.wound_type);case 2:if(!r.clinical_data)return!0;const a=r.clinical_assessment_progress||C;return a.completedFields===a.totalFields;case 3:return r.selected_products.length>0;case 4:return r.mac_validation_status,!0;case 5:return!0;case 6:return!0;default:return!1}},L=({progress:t})=>{const a=t.totalFields>0?Math.round(t.completedFields/t.totalFields*100):0;return e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:s("flex justify-between text-sm",o.text.secondary),children:[e.jsx("span",{children:"Clinical Assessment Progress"}),e.jsxs("span",{children:[a,"% Complete"]})]}),e.jsx("div",{className:s("w-full rounded-full h-2",i==="dark"?"bg-white/10":"bg-gray-200"),children:e.jsx("div",{className:s("h-2 rounded-full transition-all duration-300",i==="dark"?"bg-gradient-to-r from-emerald-500 to-teal-600":"bg-gradient-to-r from-emerald-600 to-teal-700"),style:{width:`${a}%`}})}),e.jsx("div",{className:s("grid grid-cols-2 gap-2 text-xs",o.text.secondary),children:Object.entries(t.fieldCompletion).map(([l,u])=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:s("w-2 h-2 rounded-full mr-2",u?i==="dark"?"bg-emerald-400":"bg-emerald-700":i==="dark"?"bg-white/20":"bg-gray-300")}),l.replace(/([A-Z])/g," $1").replace(/^./,c=>c.toUpperCase())]},l))})]})},G=()=>{switch(n){case 1:return e.jsx(K,{formData:r,updateFormData:_,woundTypes:x,facilities:d});case 2:return e.jsxs("div",{className:"space-y-6",children:[e.jsx(X,{formData:r,updateFormData:_,userSpecialty:m}),r.clinical_data&&e.jsx(L,{progress:r.clinical_assessment_progress||C})]});case 3:return e.jsx(J,{formData:r,updateFormData:_,userRole:h});case 4:return e.jsx(Y,{formData:r,updateFormData:_,userSpecialty:m});case 5:return e.jsx(Z,{formData:r,updateFormData:_});case 6:return e.jsx(se,{formData:r,onSubmit:P});default:return null}},H=()=>{var a;const t={patient_api_input:{first_name:"John",last_name:"Smith",dob:"1980-01-01",gender:"male",member_id:"M123456789"},facility_id:Number(f)||((a=d[0])!=null&&a.id?Number(d[0].id):1),place_of_service:"11",medicare_part_b_authorized:!1,expected_service_date:new Date(Date.now()+6048e5).toISOString().split("T")[0]||"",payer_name:"Test Insurance",payer_id:"INS123456",second_payer:"",shipping_speed:"",wound_type:"DFU",clinical_data:{patientName:"John Smith",dateOfBirth:"1980-01-01",dateOfProcedure:new Date(Date.now()+6048e5).toISOString().split("T")[0],hasDiabetes:!0,diabetesType:"2",hasVenousStasisUlcer:!1,hasPressureUlcer:!1,location:"Left Foot",ulcerLocation:"Plantar surface",depth:"partial-thickness",ulcerDuration:"30 days",length:4,width:4,woundDepth:2,hasInfection:!1,hasNecroticTissue:!1,hasCharcotDeformity:!1,hasMalignancy:!1,hasTriphasicWaveforms:!1,debridementPerformed:!1,moistDressingsApplied:!1,nonWeightBearing:!1,pressureReducingFootwear:!1,standardCompression:!1,currentHbot:!1,smokingStatus:"non-smoker",receivingRadiationOrChemo:!1,takingImmuneModulators:!1,hasAutoimmuneDiagnosis:!1},selected_products:[],mac_validation_results:{status:"approved",message:"Validation completed successfully",details:{coverage:"Covered",authorization_required:!1,estimated_coverage:"100%"}},mac_validation_status:"valid",eligibility_results:{status:"eligible",message:"Patient is eligible for coverage",details:{deductible_met:!0,out_of_pocket_met:!1,remaining_benefits:"Unlimited"}},eligibility_status:"valid",clinical_opportunities:[{id:1,code:"G0283",description:"Electrical stimulation for wound healing",status:"available",estimated_reimbursement:150},{id:2,code:"G0295",description:"Electromagnetic therapy for wound healing",status:"available",estimated_reimbursement:200}],provider_notes:"Patient has good wound healing progress. Will continue current treatment plan."};k(t),S({totalFields:Object.keys(t.clinical_data||{}).length,completedFields:Object.keys(t.clinical_data||{}).length,fieldCompletion:Object.fromEntries(Object.keys(t.clinical_data||{}).map(l=>[l,!0]))})};return e.jsxs(q,{title:"New Product Request",children:[e.jsx(z,{title:"Create Product Request"}),e.jsx("div",{className:"min-h-screen px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto py-4 sm:py-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-8",children:[e.jsx(Q,{level:1,className:"bg-gradient-to-r from-[#1925c3] to-[#c71719] bg-clip-text text-transparent",children:"New Product Request"}),e.jsx("p",{className:s("mt-1 sm:mt-2 text-sm",o.text.secondary),children:"Follow the 6-step MSC-MVP workflow to create a new product request with intelligent validation."}),m&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:s("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",i==="dark"?"bg-blue-500/20 text-blue-300":"bg-blue-100 text-blue-800"),children:[m.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())," Specialty"]})})]}),e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsx(y,{variant:"primary",onClick:H,className:s("inline-flex items-center shadow-sm",i==="dark"?"bg-blue-600 hover:bg-blue-700 text-white border border-blue-500":"bg-blue-600 hover:bg-blue-700 text-black border border-blue-700 shadow-lg"),children:"Fill Test Data"})}),e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsxs("div",{className:"block sm:hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:s("text-sm font-medium",o.text.primary),children:["Step ",n," of ",p.length]}),e.jsxs("span",{className:s("text-sm",o.text.secondary),children:[Math.round(n/p.length*100),"%"]})]}),e.jsx("div",{className:s("w-full rounded-full h-2",i==="dark"?"bg-white/10":"bg-gray-200"),children:e.jsx("div",{className:s("h-2 rounded-full transition-all duration-300",i==="dark"?"bg-gradient-to-r from-blue-500 to-purple-600":"bg-gradient-to-r from-blue-600 to-purple-700"),style:{width:`${n/p.length*100}%`}})}),e.jsx("div",{className:s("mt-2 text-sm font-medium",o.text.primary),children:(A=p[n-1])==null?void 0:A.name}),e.jsx("div",{className:s("text-xs",o.text.secondary),children:(O=p[n-1])==null?void 0:O.description})]}),e.jsx("nav",{"aria-label":"Progress",className:"hidden sm:block",children:e.jsx("ol",{className:"space-y-4 md:flex md:space-y-0 md:space-x-4 lg:space-x-8 overflow-x-auto",children:p.map(t=>e.jsx("li",{className:"md:flex-1 min-w-0",children:e.jsxs("div",{className:s("group pl-4 py-2 flex flex-col border-l-4 md:pl-0 md:pt-4 md:pb-0 md:border-l-0 md:border-t-4 transition-colors",t.id<n?i==="dark"?"border-emerald-400":"border-emerald-600":t.id===n?i==="dark"?"border-blue-400":"border-blue-600":i==="dark"?"border-white/20":"border-gray-300",i==="dark"?"hover:border-white/30":"hover:border-gray-400"),children:[e.jsxs("span",{className:s("text-xs font-semibold tracking-wide uppercase",t.id<n?i==="dark"?"text-emerald-400":"text-emerald-700":t.id===n?i==="dark"?"text-blue-400":"text-blue-700":o.text.tertiary),children:["Step ",t.id]}),e.jsx("span",{className:s("text-sm font-medium",t.id<=n?o.text.primary:o.text.tertiary),children:t.name}),t.id<n&&e.jsx("div",{className:"mt-1 flex items-center",children:e.jsx(T,{className:s("h-4 w-4",i==="dark"?"text-emerald-400":"text-emerald-700")})})]})},t.id))})})]}),e.jsxs(M,{variant:"primary",className:"overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-6 lg:p-8",children:G()}),e.jsx("div",{className:s("border-t px-4 py-3 sm:px-6 sm:py-4",i==="dark"?"border-white/10 bg-white/5":"border-gray-200 bg-gray-50"),children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0",children:[e.jsx("div",{className:"flex space-x-3",children:n>1&&e.jsxs(y,{variant:"secondary",onClick:U,className:"flex-1 sm:flex-none inline-flex items-center justify-center",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Previous"]})}),e.jsx("div",{className:"flex space-x-3",children:n<p.length?e.jsxs(y,{variant:"primary",onClick:E,disabled:!D(n),className:"flex-1 sm:flex-none inline-flex items-center justify-center",children:["Next",e.jsx(te,{className:"h-4 w-4 ml-2"})]}):e.jsxs(y,{variant:"success",onClick:P,disabled:!D(n),className:"flex-1 sm:flex-none inline-flex items-center justify-center",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Submit Request"]})})]})})]})]})})]})};export{Qe as default};
