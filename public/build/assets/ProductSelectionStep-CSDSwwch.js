import{r as o,j as e}from"./app-CkbwHOkf.js";import{M as pe,P as Y}from"./PricingDisplay-ByqrDOhf.js";import{F as he}from"./filter-CvtIixAT.js";import{S as ge}from"./search-B4qCXP-m.js";import{S as be}from"./sparkles-BQwFiKbn.js";import{C as _e}from"./clock-BCNbb55_.js";import{C as G}from"./circle-alert-D5RtSiPV.js";import{I as L}from"./info-BO4HO_Ur.js";import{C as H}from"./circle-check-big-BZwOB0cM.js";import{X as W}from"./x-CCCTsVjU.js";import{S as je}from"./shopping-cart-m-uzUl6t.js";import{P as ye}from"./package-C3D73aJ6.js";import{P as Ne}from"./plus-BtW8yxxf.js";import{T as ve}from"./trending-up-Cr1DgAyN.js";import{T as J}from"./tag-CJrfyk9z.js";import{B as we}from"./building-DoOXZ5F-.js";import"./createLucideIcon-HYdXrwBu.js";const Se=({selectedProducts:t,onProductsChange:g,showCart:b=!0,recommendationContext:x,productRequestId:d,userRole:u="provider",roleRestrictions:f,className:S="",title:N="Product Catalog Selection",description:z="Choose products from our comprehensive catalog"})=>{const h=(()=>{if(f)return f;switch(u){case"office-manager":return{can_view_financials:!1,can_see_discounts:!1,can_see_msc_pricing:!1,can_see_order_totals:!1,pricing_access_level:"none",commission_access_level:"none"};case"msc_subrep":return{can_view_financials:!1,can_see_discounts:!1,can_see_msc_pricing:!1,can_see_order_totals:!1,pricing_access_level:"limited",commission_access_level:"none"};case"provider":return{can_view_financials:!1,can_see_discounts:!0,can_see_msc_pricing:!0,can_see_order_totals:!0,pricing_access_level:"full",commission_access_level:"none"};case"msc-rep":case"msc-admin":case"superadmin":return{can_view_financials:!0,can_see_discounts:!0,can_see_msc_pricing:!0,can_see_order_totals:!0,pricing_access_level:"full",commission_access_level:"full"};default:return{can_view_financials:!1,can_see_discounts:!1,can_see_msc_pricing:!1,can_see_order_totals:!1,pricing_access_level:"national_asp_only",commission_access_level:"none"}}})(),[y,c]=o.useState([]),[_,w]=o.useState([]),[v,A]=o.useState(""),[C,P]=o.useState(""),[k,T]=o.useState(""),[Z,ee]=o.useState(!0),[se,te]=o.useState([]),[ae,re]=o.useState([]),[U,ne]=o.useState(!1),[$,R]=o.useState([]),[M,E]=o.useState(!1),[F,Q]=o.useState(null),[le,Ce]=o.useState(!0),[i,B]=o.useState(null),[qe,D]=o.useState(!1),ie=()=>{if(t.length===0)return null;const s=t[0];return(s==null?void 0:s.product)||y.find(a=>a.id===(s==null?void 0:s.product_id))||null};o.useEffect(()=>{const s=ie();B(s),D(s!==null)},[t,y]),o.useEffect(()=>{ce()},[]),o.useEffect(()=>{d&&oe()},[d]),o.useEffect(()=>{let s=y;v&&(s=s.filter(a=>a.name.toLowerCase().includes(v.toLowerCase())||a.q_code.toLowerCase().includes(v.toLowerCase())||a.manufacturer.toLowerCase().includes(v.toLowerCase())||a.sku.toLowerCase().includes(v.toLowerCase()))),C&&(s=s.filter(a=>a.category===C)),k&&(s=s.filter(a=>a.manufacturer===k)),w(s)},[y,v,C,k]);const ce=async()=>{try{const s=u!=="provider"&&!h.pricing_access_level.includes("limited"),n=(await(await fetch(`/api/products/search${s?"?show_all=true":""}`)).json()).products||[];c(n),w(n);const l=[...new Set(n.map(j=>j.category))],m=[...new Set(n.map(j=>j.manufacturer))];te(l),re(m),console.log(`ProductSelector: Loaded ${n.length} products for ${u}`,{showAll:s,roleRestrictions:h,sampleProduct:n[0]})}catch(s){console.error("Error fetching products:",s)}finally{ee(!1)}},oe=async()=>{if(d){E(!0),Q(null);try{const a=await(await fetch(`/api/product-requests/${d}/recommendations`)).json();a.recommendations?R(a.recommendations):R([])}catch(s){console.error("Error fetching AI recommendations:",s),Q("Failed to load AI recommendations"),R([])}finally{E(!1)}}},I=(s,a=1,r)=>{var n;if(t.length>0&&((n=t[0])==null?void 0:n.product_id)!==s.id)g([{product_id:s.id,quantity:a,size:r,product:s}]);else{const l=t.findIndex(m=>m.product_id===s.id&&m.size===r);if(l>=0){const m=[...t],j=m[l];j&&(m[l]={...j,quantity:j.quantity+a},g(m))}else g([...t,{product_id:s.id,quantity:a,size:r,product:s}])}},de=(s,a=1)=>{var l;const r=y.find(m=>m.id===s.product_id);if(!r)return;const n=(l=s.suggested_size)==null?void 0:l.toString();I(r,a,n)},O=(s,a,r)=>{if(r<=0){K(s,a);return}const n=t.map(l=>l.product_id===s&&l.size===a?{...l,quantity:r}:l);g(n)},K=(s,a)=>{const r=t.filter(n=>!(n.product_id===s&&n.size===a));g(r)},me=()=>{g([]),B(null),D(!1)},xe=()=>t.reduce((s,a)=>{const r=a.product||y.find(l=>l.id===a.product_id);if(!r)return s;const n=h.can_see_msc_pricing&&r.msc_price||r.price_per_sq_cm;if(a.size){const l=parseFloat(a.size);if(!isNaN(l))return s+l*n*a.quantity}return s+n*a.quantity},0),V=()=>{if(!x)return[];const s=["Skin Substitute","Wound Care","Dressing"];return y.filter(a=>s.includes(a.category))},q=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),ue=(s,a)=>{const r=parseFloat(a);if(isNaN(r))return a;if(s.size_pricing){for(const[m,j]of Object.entries(s.size_pricing))if(j===r)return m}const n=Math.sqrt(r);return n===Math.floor(n)?`${n} x ${n} cm`:`${r} cmÂ²`};return Z?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading product catalog..."})]}):e.jsxs("div",{className:`space-y-6 ${S}`,children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:N}),e.jsxs("p",{className:"text-sm text-gray-600",children:[z," ",x&&`(Optimized for ${x})`]}),u==="provider"&&e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Showing only products you are onboarded with"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[_.length," products available"]}),e.jsxs("button",{onClick:()=>ne(!U),className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Filters"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"w-5 h-5 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search products by name, Q-code, manufacturer, or SKU...",value:v,onChange:s=>A(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),U&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{value:C,onChange:s=>P(s.target.value),className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Categories"}),se.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Manufacturer"}),e.jsxs("select",{value:k,onChange:s=>T(s.target.value),className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Manufacturers"}),ae.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})]}),d&&le&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(be,{className:"w-5 h-5 mr-2 text-purple-600"}),"AI-Powered Clinical Recommendations"]}),M&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(_e,{className:"w-4 h-4 mr-1 animate-spin"}),"Analyzing..."]})]}),F&&e.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md flex items-center",children:[e.jsx(G,{className:"w-4 h-4 mr-2 text-yellow-600"}),e.jsx("span",{className:"text-sm text-yellow-800",children:F})]}),!M&&$.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Based on clinical analysis of wound characteristics, patient factors, and evidence-based protocols."}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:$.slice(0,4).map((s,a)=>e.jsx(ze,{recommendation:s,onAdd:de,rank:a+1,roleRestrictions:h,isDisabled:i!==null&&i.id!==s.product_id},`ai-rec-${s.product_id}-${a}`))})]}),!M&&$.length===0&&!F&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx(L,{className:"w-8 h-8 mx-auto text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-600",children:"No AI recommendations available for this request."})]})]}),x&&!d&&V().length>0&&e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-md font-semibold text-green-900 mb-3 flex items-center",children:[e.jsx(L,{className:"w-5 h-5 mr-2"}),"Recommended for ",x]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:V().slice(0,6).map(s=>e.jsx(X,{product:s,onAdd:I,isRecommended:!0,roleRestrictions:h,isDisabled:i!==null&&i.id!==s.id,canAddMoreSizes:i!==null&&i.id===s.id},`rec-${s.id}`))})]}),e.jsxs("div",{className:`grid gap-6 ${b?"grid-cols-1 lg:grid-cols-3":"grid-cols-1"}`,children:[e.jsxs("div",{className:b?"lg:col-span-2":"col-span-1",children:[i?e.jsx("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"w-5 h-5 mr-2 text-blue-600"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-blue-900",children:["Selected: ",i.name]}),e.jsxs("p",{className:"text-xs text-blue-700",children:["Q",i.q_code," â¢ ",i.manufacturer]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("button",{onClick:me,className:"inline-flex items-center px-3 py-1 text-xs font-medium text-red-700 bg-red-100 rounded-md hover:bg-red-200",children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),"Change Product"]})})]})}):e.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md flex items-center",children:[e.jsx(L,{className:"w-4 h-4 mr-2 text-yellow-600"}),e.jsx("span",{className:"text-sm text-yellow-800",children:"Select one product type. You can then add multiple sizes and quantities for that product."})]}),e.jsx("div",{className:"space-y-4",children:_.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-gray-500",children:"No products found matching your criteria."}),e.jsx("button",{onClick:()=>{A(""),P(""),T("")},className:"mt-2 text-blue-600 hover:text-blue-800",children:"Clear filters"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:_.map(s=>e.jsx(X,{product:s,onAdd:I,roleRestrictions:h,isDisabled:i!==null&&i.id!==s.id,canAddMoreSizes:i!==null&&i.id===s.id,isSelected:(i==null?void 0:i.id)===s.id},s.id))})})]}),b&&e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 sticky top-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(je,{className:"w-5 h-5 mr-2"}),i?"Product Details":"Selected Product"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[t.length," ",t.length===1?"size/qty":"sizes/qtys"]})]}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ye,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"No product selected yet"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Select one product type - you can add multiple sizes and quantities"})]}):e.jsxs("div",{className:"space-y-3",children:[i&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-md mb-4",children:[e.jsx("h5",{className:"text-sm font-semibold text-blue-900 mb-1",children:i.name}),e.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[e.jsxs("p",{children:["Q",i.q_code," â¢ ",i.sku]}),e.jsx("p",{children:i.manufacturer}),e.jsx("p",{className:"text-blue-600",children:i.category})]})]}),t.map((s,a)=>{const r=s.product||y.find(fe=>fe.id===s.product_id);if(!r)return null;const n=h.can_see_msc_pricing&&r.msc_price||r.price_per_sq_cm;let l=n,m=0;s.size&&(m=parseFloat(s.size),isNaN(m)||(l=n));const j=m*l*s.quantity;return e.jsxs("div",{className:"border border-gray-200 rounded-md p-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:"flex-1",children:s.size?e.jsxs("div",{children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-900",children:["Size: ",ue(r,s.size)]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[q(l)," per unit"]})]}):e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900",children:"Standard Size"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[q(l)," per unit"]})]})}),e.jsx("button",{type:"button",onClick:()=>K(s.product_id,s.size),className:"text-red-500 hover:text-red-700","aria-label":"Remove size",title:"Remove size",children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>O(s.product_id,s.size,s.quantity-1),className:"w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50","aria-label":"Decrease quantity",title:"Decrease quantity",children:e.jsx(pe,{className:"w-3 h-3"})}),e.jsx("span",{className:"text-sm font-medium w-8 text-center",children:s.quantity}),e.jsx("button",{onClick:()=>O(s.product_id,s.size,s.quantity+1),className:"w-6 h-6 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50","aria-label":"Increase quantity",title:"Increase quantity",children:e.jsx(Ne,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:q(j)}),e.jsx("p",{className:"text-xs text-gray-500",children:m>0?`${m} cmÂ² Ã ${q(l)} Ã ${s.quantity}`:`${s.quantity} Ã ${q(l)}`})]})]})]},`${s.product_id}-${s.size||"no-size"}`)}),e.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-base font-semibold text-gray-900",children:"Total:"}),e.jsx("span",{className:"text-lg font-bold text-blue-600",children:q(xe())})]}),!h.can_see_msc_pricing&&e.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"* Pricing shown is National ASP only"})]})]})]})})]})]})},X=({product:t,onAdd:g,isRecommended:b=!1,roleRestrictions:x,isDisabled:d=!1,isSelected:u=!1})=>{const[f,S]=o.useState(""),[N,z]=o.useState(1);console.log("ProductCard rendering:",{productName:t.name,available_sizes:t.available_sizes,size_options:t.size_options,size_unit:t.size_unit,hasSizes:t.size_options&&t.size_options.length>0||t.available_sizes&&t.available_sizes.length>0});const p=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(c),h=()=>{g(t,N,f||void 0),z(1),S("")},y=()=>{const c=x.can_see_msc_pricing&&t.msc_price||t.price_per_sq_cm;if(f){const _=parseFloat(f);return isNaN(_)?c*N:_*c*N}return c*N};return e.jsxs("div",{className:`border rounded-lg p-4 hover:shadow-md transition-shadow ${u?"border-blue-500 bg-blue-50":b?"border-green-200 bg-green-50":"border-gray-200 bg-white"} ${d?"opacity-50":""}`,children:[u&&e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Currently Selected"})}),b&&!u&&e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Recommended"})}),e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-2 mb-1",children:t.name}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 mb-1",children:[e.jsx(J,{className:"w-3 h-3"}),e.jsxs("span",{children:["Q",t.q_code]}),e.jsx("span",{children:"â¢"}),e.jsx("span",{children:t.sku})]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:t.manufacturer})]})]})}),e.jsx("p",{className:"text-xs text-gray-600 mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsx(Y,{roleRestrictions:x,product:{nationalAsp:t.price_per_sq_cm,mscPrice:t.msc_price},showLabel:!0,className:"text-xs"}),x.can_view_financials&&t.commission_rate&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Commission:"}),e.jsxs("span",{className:"font-medium text-green-600",children:[t.commission_rate,"%"]})]})]}),t.size_options&&t.size_options.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Size"}),e.jsxs("select",{value:f,onChange:c=>S(c.target.value),className:"w-full text-xs border border-gray-300 rounded-md py-1 px-2 focus:ring-blue-500 focus:border-blue-500",disabled:d,children:[e.jsx("option",{value:"",children:"Select size..."}),t.size_options.map(c=>{var w;const _=((w=t.size_pricing)==null?void 0:w[c])||0;return x.can_see_msc_pricing&&t.msc_price||t.price_per_sq_cm,e.jsx("option",{value:_.toString(),children:c},c)})]})]}):t.available_sizes&&t.available_sizes.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Size"}),e.jsxs("select",{value:f,onChange:c=>S(c.target.value),className:"w-full text-xs border border-gray-300 rounded-md py-1 px-2 focus:ring-blue-500 focus:border-blue-500",disabled:d,children:[e.jsx("option",{value:"",children:"Select size..."}),t.available_sizes.map(c=>{const _=typeof c=="string"?parseFloat(c):c,w=c.toString(),v=x.can_see_msc_pricing&&t.msc_price||t.price_per_sq_cm;let A=`${_} cmÂ²`;if(t.size_pricing){for(const[C,P]of Object.entries(t.size_pricing))if(P===_){A=C;break}}return e.jsxs("option",{value:w,children:[A," - ",p(v*_)]},w)})]})]}):null,e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:N,onChange:c=>z(Math.max(1,parseInt(c.target.value)||1)),className:"w-full text-xs border border-gray-300 rounded-md py-1 px-2 focus:ring-blue-500 focus:border-blue-500",disabled:d})]}),e.jsx("div",{className:"mb-3 p-2 bg-gray-50 rounded text-center",children:e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:["Total: ",p(y())]})}),e.jsx("button",{onClick:h,disabled:(t.size_options&&t.size_options.length>0||t.available_sizes&&t.available_sizes.length>0)&&!f||d,className:"w-full text-sm font-medium py-2 px-3 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed bg-blue-600 text-white hover:bg-blue-700",children:d?"Different Product Selected":u?"Add Another Size":"Select This Product"})]})},ze=({recommendation:t,onAdd:g,rank:b,roleRestrictions:x,isDisabled:d=!1})=>{const[u,f]=o.useState(1),S=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),N=p=>p>=.8?"text-green-600 bg-green-50":p>=.6?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",z=()=>{g(t,u),f(1)};return e.jsxs("div",{className:`border border-blue-200 rounded-lg p-4 bg-white hover:shadow-md transition-all duration-200 ${d?"opacity-50":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 bg-blue-600 text-white text-xs font-bold rounded-full",children:b}),e.jsxs("div",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${N(t.confidence_score)}`,children:[Math.round(t.confidence_score*100),"% confidence"]})]}),e.jsx(ve,{className:"w-4 h-4 text-blue-600"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:t.product_name}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 mb-1",children:[e.jsx(J,{className:"w-3 h-3"}),e.jsxs("span",{children:["Q",t.q_code]}),e.jsx("span",{children:"â¢"}),e.jsx("span",{children:t.manufacturer})]}),e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:t.category})]}),e.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-md",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Clinical Rationale:"}),e.jsx("p",{className:"text-xs text-gray-600 line-clamp-3",children:t.reasoning})]}),t.key_benefits&&t.key_benefits.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Key Benefits:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.key_benefits.slice(0,3).map((p,h)=>e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-green-100 text-green-700 rounded",children:p},h))})]}),e.jsxs("div",{className:"mb-3 space-y-1",children:[e.jsx("div",{className:"text-xs",children:e.jsx(Y,{roleRestrictions:x,product:{nationalAsp:t.estimated_cost.national_asp,mscPrice:t.estimated_cost.msc_price},showLabel:!0,className:"text-xs"})}),x.can_see_discounts&&t.estimated_cost.savings&&t.estimated_cost.savings>0&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Savings vs ASP:"}),e.jsxs("span",{className:"font-medium text-green-600",children:[S(t.estimated_cost.savings),"(",t.estimated_cost.savings_percentage,"%)"]})]}),t.suggested_size&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Suggested Size:"}),e.jsxs("span",{className:"font-medium text-purple-600",children:[t.suggested_size," cmÂ²"]})]})]}),t.contraindications&&t.contraindications.length>0&&e.jsxs("div",{className:"mb-3 p-2 bg-red-50 border border-red-200 rounded",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(G,{className:"w-3 h-3 mr-1 text-red-600"}),e.jsx("h4",{className:"text-xs font-medium text-red-700",children:"Contraindications:"})]}),e.jsx("ul",{className:"text-xs text-red-600 space-y-1",children:t.contraindications.slice(0,2).map((p,h)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-1",children:"â¢"}),e.jsx("span",{children:p})]},h))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",value:u,onChange:p=>f(Math.max(1,parseInt(p.target.value)||1)),className:"w-full text-xs border border-gray-300 rounded-md py-1 px-2 focus:ring-blue-500 focus:border-blue-500",disabled:d})]}),e.jsx("button",{onClick:z,disabled:d,className:`w-full text-sm font-medium py-2 px-3 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 ${d?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700"}`,children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),d?"Different Product Selected":"Add Recommended Product"]})})]})},Ve=({formData:t,updateFormData:g,productRequestId:b,userRole:x="provider"})=>{const d=f=>{g({selected_products:f})},u=()=>{switch(x){case"provider":return{can_view_financials:!1,can_see_discounts:!0,can_see_msc_pricing:!0,can_see_order_totals:!0,pricing_access_level:"full",commission_access_level:"none"};case"office_manager":return{can_view_financials:!1,can_see_discounts:!1,can_see_msc_pricing:!1,can_see_order_totals:!1,pricing_access_level:"none",commission_access_level:"none"};case"msc-admin":case"msc-rep":case"superadmin":return{can_view_financials:!0,can_see_discounts:!0,can_see_msc_pricing:!0,can_see_order_totals:!0,pricing_access_level:"full",commission_access_level:"full"};default:return{can_view_financials:!1,can_see_discounts:!1,can_see_msc_pricing:!1,can_see_order_totals:!1,pricing_access_level:"national_asp_only",commission_access_level:"none"}}};return e.jsx(Se,{selectedProducts:t.selected_products,onProductsChange:d,recommendationContext:t.wound_type,productRequestId:b,roleRestrictions:u(),title:b?"Product Selection with AI Clinical Recommendations":"Product Selection with AI Recommendations",description:b?"AI-powered recommendations based on clinical assessment, patient factors, and evidence-based protocols":"Based on your clinical assessment, choose optimal products for the patient's needs"})};export{Ve as default};
