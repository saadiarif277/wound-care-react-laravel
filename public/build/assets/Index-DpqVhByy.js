import{r as o,j as e,S as _}from"./app-b7vnQlZc.js";import{M as F}from"./MainLayout-CSlV7Py7.js";import{F as g,a as h,J as j,j as A,B as S,e as p,f as k,d as M,c as L,G as B,h as T,i as $,a7 as P,a8 as U}from"./index-DpA9ZXCS.js";import"./x-CdJq2FK8.js";import"./createLucideIcon-BGsZVnCF.js";import"./triangle-alert-CLRk3LfA.js";import"./check-KIJGV9m7.js";function K({userRoles:E,permissions:H,users:I,roleStats:u,permissionStats:N,userDistribution:b,totalUsers:y,totalRoles:v,totalPermissions:f}){const[r,w]=o.useState("overview"),[O,C]=o.useState(null),c=s=>s.name==="super-admin"?"critical":s.name==="msc-admin"?"high":["msc-rep","provider"].includes(s.name)?"medium":"low",R=s=>{switch(s){case"critical":return"text-red-600 bg-red-50";case"high":return"text-orange-600 bg-orange-50";case"medium":return"text-yellow-600 bg-yellow-50";default:return"text-green-600 bg-green-50"}},l=({title:s,value:a,icon:t,color:i})=>e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-lg ${i}`,children:e.jsx(t,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:a})]})]})});return e.jsxs(F,{children:[e.jsx(_,{title:"RBAC Configuration"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx(g,{className:"mr-3 text-blue-600"}),"Role-Based Access Control"]}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage user roles, permissions, and access control across the platform"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(l,{title:"Total Users",value:y,icon:h,color:"bg-blue-500"}),e.jsx(l,{title:"Active Roles",value:v,icon:j,color:"bg-green-500"}),e.jsx(l,{title:"Permissions",value:f,icon:A,color:"bg-purple-500"}),e.jsx(l,{title:"Security Level",value:"High",icon:g,color:"bg-orange-500"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:S},{id:"roles",label:"Role Management",icon:h},{id:"permissions",label:"Permissions",icon:j},{id:"audit",label:"Security Audit",icon:p}].map(s=>e.jsxs("button",{onClick:()=>w(s.id),className:`flex items-center py-2 px-1 border-b-2 font-medium text-sm ${r===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(s.icon,{className:"mr-2 h-4 w-4"}),s.label]},s.id))})}),r==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Role Distribution"}),e.jsx("div",{className:"space-y-4",children:b.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-500 mr-3"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.role})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[s.count," users"]}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s.percentage,"%"]})]})]},a))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(k,{className:"mr-2"}),"Recent RBAC Changes"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-4 w-4 text-yellow-600 mr-3"}),e.jsx("span",{className:"text-sm text-gray-900",children:"Role permissions updated for MSC Admin"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"2 hours ago"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"h-4 w-4 text-green-600 mr-3"}),e.jsx("span",{className:"text-sm text-gray-900",children:"New user assigned Office Manager role"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"1 day ago"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-4 w-4 text-red-600 mr-3"}),e.jsx("span",{className:"text-sm text-gray-900",children:"User access revoked for security violation"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"3 days ago"})]})]})]})]}),r==="roles"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Role Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure roles and their permissions"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:u.map(s=>{var a,t,i,d,n,x,m;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${R(c(s))}`,children:c(s).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:s.display_name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[s.user_count," users"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Level ",s.hierarchy_level]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>C(s),className:"p-2 text-gray-400 hover:text-gray-600",children:e.jsx(T,{className:"h-4 w-4"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600",children:e.jsx($,{className:"h-4 w-4"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600",children:s.is_active?e.jsx(P,{className:"h-4 w-4 text-green-500"}):e.jsx(U,{className:"h-4 w-4 text-gray-400"})})]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${(a=s.dashboard_config)!=null&&a.financial_access?"bg-green-500":"bg-red-500"}`}),"Financial Access"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${((t=s.dashboard_config)==null?void 0:t.pricing_access)==="full"?"bg-green-500":"bg-yellow-500"}`}),"Pricing: ",((i=s.dashboard_config)==null?void 0:i.pricing_access)||"Limited"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${((n=(d=s.dashboard_config)==null?void 0:d.admin_capabilities)==null?void 0:n.length)>0?"bg-green-500":"bg-gray-400"}`}),"Admin Capabilities"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${(m=(x=s.dashboard_config)==null?void 0:x.customer_data_restrictions)!=null&&m.includes("no_phi")?"bg-red-500":"bg-green-500"}`}),"PHI Access"]})]})]},s.id)})})})]}),r==="permissions"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Permission Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View and manage system permissions"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Used by ",s.roles_count," role",s.roles_count!==1?"s":""]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.roles.slice(0,2).map((a,t)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:a},t)),s.roles.length>2&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",s.roles.length-2]})]})]})]},s.id))})})]}),r==="audit"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Security Audit Log"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Monitor RBAC changes and security events"})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(p,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Security audit logs will appear here"}),e.jsx("p",{className:"text-sm",children:"Track role changes, permission updates, and access modifications"})]})})})]})]})})]})}export{K as default};
