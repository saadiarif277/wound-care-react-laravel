import{r as d,j as g}from"./app-CkbwHOkf.js";import{M as R}from"./map-pin-DGRcBcWO.js";import{L as j}from"./loader-circle-CzGXBM_P.js";function M({onPlaceSelect:u,value:w="",onChange:c,placeholder:h="Start typing an address...",className:v="",disabled:p=!1,required:x=!1}){const a=d.useRef(null),m=d.useRef(null),[b,L]=d.useState(!1),[y,A]=d.useState(!0),[_,f]=d.useState(w),N=r=>{const e={formattedAddress:r.formatted_address||r.formattedAddress,placeId:r.place_id||r.id},l=r.address_components||r.addressComponents||[];if(l.length===0)return e;for(const t of l){const o=t.types||[],s=t.long_name||t.longText,n=t.short_name||t.shortText;o.includes("street_number")?e.streetNumber=s:o.includes("route")?e.streetName=s:o.includes("locality")?e.city=s:o.includes("administrative_area_level_1")?(e.state=s,e.stateAbbreviation=n):o.includes("postal_code")?e.zipCode=s:o.includes("country")&&(e.country=s)}return e.streetNumber&&e.streetName?e.streetAddress=`${e.streetNumber} ${e.streetName}`:e.streetName&&(e.streetAddress=e.streetName),e};d.useEffect(()=>{const r=()=>{var l,t,o,s,n,i;return(o=(t=(l=window.google)==null?void 0:l.maps)==null?void 0:t.places)!=null&&o.PlaceAutocompleteElement||(i=(n=(s=window.google)==null?void 0:s.maps)==null?void 0:n.places)!=null&&i.Autocomplete?(L(!0),A(!1),!0):!1};if(r())return;const e=setInterval(()=>{r()&&clearInterval(e)},500);return setTimeout(()=>{clearInterval(e),A(!1)},1e4),()=>clearInterval(e)},[]),d.useEffect(()=>{var r,e,l;if(!(!b||!a.current||p))try{if(m.current&&(l=(e=(r=window.google)==null?void 0:r.maps)==null?void 0:e.event)!=null&&l.clearInstanceListeners&&window.google.maps.event.clearInstanceListeners(m.current),window.google.maps.places.PlaceAutocompleteElement){const t=new window.google.maps.places.PlaceAutocompleteElement({types:["address"],componentRestrictions:{country:"us"}});t.placeholder=a.current.placeholder,t.value=_,t.disabled=p,t.required=a.current.required,t.className=a.current.className,t.addEventListener("gmp-placeselect",o=>{const s=o.place;if(s&&s.formattedAddress){const n=s.formattedAddress;if(f(n),c&&c(n),u){const i={formatted_address:s.formattedAddress,place_id:s.id,address_components:s.addressComponents||[]},G=N(i);u(i,G)}}}),a.current.parentNode&&(a.current.parentNode.replaceChild(t,a.current),a.current=t),m.current=t}else if(window.google.maps.places.Autocomplete){const t=new window.google.maps.places.Autocomplete(a.current,{types:["address"],componentRestrictions:{country:"us"},fields:["address_components","formatted_address","geometry","place_id"]});m.current=t;const o=t.addListener("place_changed",()=>{const s=t.getPlace();if(s&&s.formatted_address){const n=s.formatted_address;if(f(n),c&&c(n),u){const i=N(s);u(s,i)}}});return()=>{o&&window.google.maps.event.removeListener(o)}}}catch(t){console.error("Error initializing Google Places:",t)}},[b,p,u,c,_]),d.useEffect(()=>{f(w)},[w]);const I=r=>{const e=r.target.value;f(e),c&&c(e)},E=`
    w-full pl-10 pr-4 py-2.5 
    bg-white dark:bg-gray-800 
    border border-gray-300 dark:border-gray-600 
    rounded-lg 
    text-gray-900 dark:text-white 
    placeholder:text-gray-500 dark:placeholder:text-gray-400
    focus:ring-2 focus:ring-blue-500 focus:border-blue-500
    disabled:opacity-50 disabled:cursor-not-allowed
    ${v}
  `.trim().replace(/\s+/g," ");return g.jsxs("div",{className:"relative",children:[g.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none z-10"}),g.jsx("input",{ref:a,type:"text",value:_,onChange:I,placeholder:y?"Loading Google Maps...":h,disabled:p||y,required:x,className:E}),y&&g.jsx(j,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 animate-spin"}),!1]})}export{M as G};
